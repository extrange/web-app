{"version":3,"sources":["LoadServiceWorker.js","util/useAsyncError.js","util/util.js","ErrorBoundary.js","globals/theme.js","shared/randomBackground.js","globals/urls.js","shared/backgroundScreen.js","shared/AlertSnackbarWithDialog.js","NetworkStateSnackbar.js","util/networking.js","Login.js","util/useInput.js","shared/common.js","shared/NotificationProvider/notificationContext.js","shared/notificationMenu.js","shared/AppBarResponsive.js","modules/Lists/createTasklist.js","shared/styledListItem.js","modules/Lists/tasklist.js","modules/Lists/urls.js","modules/Lists/tasklists.js","modules/Lists/item.js","shared/MarkdownEditor/scrollPastEnd.js","shared/MarkdownEditor/MarkdownEditor.js","shared/dialogBlurResponsive.js","modules/Lists/editItem.js","shared/loading.js","modules/Lists/tasks.js","modules/Lists/Lists.js","modules/Literature/urls.js","modules/Literature/schema.js","shared/AutocompleteWithCreate.js","shared/textFieldClearable.js","shared/textFieldMultilineEllipsis.js","modules/Literature/utils.js","modules/Literature/AddBook.js","modules/Literature/BookResult.js","modules/Literature/searchBooks.js","modules/Literature/Books.js","modules/Literature/genericAddDeleteCreateDialog.js","modules/Literature/genericAddDeleteCreate.js","modules/Literature/GenreDialog.js","modules/Literature/Genres.js","modules/Literature/Literature.js","modules/HomeAutomation/urls.js","modules/HomeAutomation/HomeAutomation.js","modules/Dvr/urls.js","modules/Dvr/DVR.js","shared/textFieldClearableInfo.js","modules/OptionHedgeCalculator/TextFieldClearableInfoCurrency.js","modules/OptionHedgeCalculator/FieldUseWatch.js","modules/OptionHedgeCalculator/OptionHedgeCalculator.js","modules/OptionHedgeCalculator/textFieldRefreshLoading.js","util/passwordUtil.js","modules/PasswordTools/urls.js","modules/PasswordTools/PasswordTools.js","modules/Account/urls.js","modules/Account/TwoFactor.js","modules/Account/BrowserCard.js","browserLogos/chrome.png","browserLogos/firefox.png","browserLogos/edge.png","browserLogos/safari.png","modules/Account/Browsers.js","modules/Account/Account.js","ModuleSelect.js","modules/Mail/urls.js","modules/Mail/checkMailThrottled.js","modules/Mail/Mail.js","shared/NotificationProvider/NotificationProvider.js","RefreshSession.js","LoginCheckAndNetworkState.js","index.js"],"names":["Component","useAsyncError","setError","useState","useCallback","e","Error","sanitizeString","string","removeAccents","trim","toLowerCase","isEmpty","Boolean","formatDistanceToNowPretty","date","differenceInMinutes","Date","formatDistanceToNow","addSuffix","differenceInCalendarDays","formatDistanceToNowStrict","differenceInCalendarYears","format","isLocalhost","window","location","hostname","match","noop","arr","Uint32Array","max","hasServiceWorker","navigator","wb","Workbox","NoServiceWorker","sbOpen","setSbOpen","Snackbar","open","onClose","autoHideDuration","Alert","severity","LoadServiceWorker","intervalId","useRef","registration","text","actions","undefined","details","setDetails","reloadPage","reload","onInstalled","event","isUpdate","console","log","onControlling","onActivated","onUpdate","current","waiting","Button","variant","color","onClick","messageSW","type","clearInterval","onError","error","toString","useEffect","addEventListener","register","then","r","catch","setInterval","update","ClickAwayListenerProps","onClickAway","action","StyledDialog","muiStyled","Dialog","theme","zIndex","snackbar","ErrorBoundary","props","setDialogOpen","state","setState","dialogOpen","render","scroll","DialogTitle","DialogContent","DialogContentText","errorInfo","componentStack","DialogActions","children","this","createMuiTheme","palette","primary","main","secondary","OverlayScrollbarOptions","className","overflowBehavior","x","scrollbars","autoHide","RandomBackgroundImage","styled","div","$picIndex","getPicIndex","min","seed","Math","ceil","floor","rng","seedrandom","getRandomInt","NUM_IMAGES","RandomBackground","picIndex","setPicIndex","listener","removeEventListener","API_URL","ACCOUNT_URL","LOGIN_URL","LOGOUT_URL","RECAPTCHA_KEY_URL","BACKGROUND_COLOR","BackgroundScreen","BackgroundScreenRounded","AlertSnackbarWithDialog","snackbarText","dialogTitle","dialogContent","dialogEnabled","component","IconButton","size","fontSize","NetworkState","HTTP_ERROR","FETCH_ERROR","throwError","NetworkStateSnackbar","networkError","message","name","object","status","setNetworkError","logout","Response","includes","Networking","GET","POST","DELETE","PUT","send","url","method","headers","body","Promise","resolve","fetch","credentials","Accept","resp","ok","statusText","crudMethods","detailUrl","json","params","JSON","stringify","id","StyledForm","form","InnerContainer","StyledTextField","TextField","Spacer","StyledCircularProgress","CircularProgress","Login","setLoggedIn","recaptchaKey","loginMessage","setLoginMessage","loading","setLoading","otpRequired","setOtpRequired","initialValues","reducer","value","useReducer","values","setValue","onChange","target","bind","useInput","recaptchaRef","React","onSubmit","preventDefault","executeAsync","token","username","password","otp","save_browser","saveBrowser","otp_required","reset","Typography","gutterBottom","align","label","fullWidth","required","autoFocus","autoComplete","inputmode","pattern","FormControlLabel","control","Checkbox","checked","ref","sitekey","HideOnScroll","trigger","useScrollTrigger","threshold","Slide","direction","in","MuiStyledButton","margin","StyledButton","NotificationContext","createContext","StyledChip","Chip","StyledPopover","Popover","StyledSpan","NotificationMenu","notifications","anchorEl","setAnchorEl","context","useContext","currentTarget","Badge","badgeContent","reduce","sum","count","anchorOrigin","vertical","horizontal","length","map","Fragment","ListItem","button","ListItemText","disableTypography","source","title","content","timestamp","Divider","drawerWidth","OverlayScrollbarsWithMaxWidth","OverlayScrollbarsComponent","TransparentDrawer","Drawer","FlexContainer","TransparentAppBar","AppBar","breakpoints","up","width","marginLeft","StyledDrawerContainer","flexShrink","StyledContentContainer","ContentDiv","StyledAppNameDiv","StyledIconButton","display","AppBarResponsive","appName","titleContent","drawerOpen","setDrawerOpen","drawerContent","returnToMainApp","useTheme","mobile","useMediaQuery","down","drawer","options","List","ListItemIcon","position","elevation","Toolbar","edge","style","flex","CreateTasklist","promptCreateTasklist","StyledListItem","$hideBackground","$reserveSpace","StyledListItemSecondaryAction","ListItemSecondaryAction","Tasklist","handleDelete","primaryTypographyProps","noWrap","TASKS_API_URL","TASKLISTS_URL","getTasksUrl","tasklist","getTaskUrl","Tasklists","tasklists","listTasklists","currentListId","setAndSaveCurrentList","createTasklist","a","deleteTasklist","confirm","getTasklistUrl","listItems","prompt","disablePadding","dense","Item","deleteTask","handleEditTask","task","notes","secondaryTypographyProps","stopPropagation","updateBottomMargin","cm","padding","lineCount","scrollPastEndPadding","lineSpace","parentNode","paddingBottom","off","setSize","on","change","CodeMirror","changeEnd","line","lastLine","defineOption","val","old","Init","MarkdownEditor","defaultValue","instance","setInstance","initialValue","setInitialValue","loaded","setLoaded","refresh","mode","highlightFormatting","lineNumbers","lineWrapping","indentWithTabs","viewportMargin","Infinity","autoCloseBrackets","matchBrackets","styleSelectedText","styleActiveLine","autoRefresh","scrollPastEnd","editorDidMount","editor","data","newValue","$maxWidth","StyledOverlayScrollbarsComponent","DialogBlurResponsive","footer","maxWidth","disableScrollLock","FooterRight","Footer","SavingStates","EditItem","editingTask","createTask","updateTask","closeEdit","currentList","fullScreen","saving","setSaving","taskId","creatingTask","initialTitle","initialNotes","useForm","defaultValues","getValues","debouncedAutoSave","debounce","maxWait","handleClose","flush","autoSave","Tooltip","arrow","enterTouchDelay","interactive","created","parseJSON","updated","Zoom","multiline","newVal","StyledBackdrop","Backdrop","FlexBackgroundScreen","Loading","showSpinner","fullscreen","StyledFab","Fab","StyledDiv","add","del","Tasks","items","setEditingTask","virtuosoRef","scrollToIndex","behavior","list","decision","totalCount","itemContent","index","components","forwardRef","listRef","LIST_CURRENT_LIST","get","Lists","setCurrentListId","setTasklists","setItems","result","savedListId","localStorage","getItem","listId","find","getTasklistTitle","setItem","LIT_API","BOOKS","AUTHORS","GENRES","TYPES","SEARCH","BOOK_INFO","getBooks","addBook","updateBook","deleteBook","getAuthors","addAuthor","updateAuthor","deleteAuthor","getGenres","addGenre","updateGenre","deleteGenre","getTypes","addType","updateType","deleteType","BOOK_SCHEMA","authors","yupSchema","yup","ensure","transformToServer","transformFromServer","genres","typeError","types","description","read_next","date_read","nullable","formatISO","representation","parseISO","image_url","published","integer","transform","origVal","isNumber","google_id","goodreads_book_id","series","series_position","rating","round","my_review","BOOK_FIELDS","Object","fromEntries","keys","YUP_SCHEMA","entries","noUnknown","DEFAULT_BOOK_VALUES","k","v","AutocompleteWithCreate","createOption","getOptionLabel","getOptions","getOptionSelected","b","getValue","helperText","maxOptionsToShow","multiple","renderProps","sanitizedOptionLabels","useMemo","flow","Autocomplete","clearOnBlur","disabled","filterOptions","input","inputValue","filtered","matchSorter","push","_name","_isNew","_justAdded","slice","freeSolo","option","el","obj","renderInput","InputProps","endAdornment","renderOption","renderTags","tagValue","getTagProps","onDelete","rest","deleteIcon","TextFieldClearable","InputAdornment","cursor","$ellipsis","TextFieldMultilineEllipsis","onBlur","onFocus","focused","setFocused","focusPos","setFocusPos","inputRef","focus","setSelectionRange","selectionStart","recursiveSort","compareFn","childrenKey","mapped","sort","mapGenres","ancestors","currentEl","parent","p","unshift","getAncestors","fullName","join","FieldContainer","ButtonFlexDiv","AddBook","books","setBooks","dataTypes","setAuthors","setGenres","setTypes","bookData","setAddedSnackbar","resolver","yupResolver","handleSubmit","isDirty","formState","watch","errorSnackbar","setErrorSnackbar","saveDialog","setSaveDialog","infoDialog","setInfoDialog","sortedGenres","localeCompare","originalData","userData","isEqual","pick","transformedData","Url","handleDiscard","tabIndex","StandardField","getComponentProps","controllerProps","field","fieldState","gridArea","disableBackdropClick","onBackdropClick","autoHighlight","filterSelectedOptions","groupBy","labelPlacement","FormHelperText","MuiPickersUtilsProvider","utils","DateFns","KeyboardDatePicker","autoOk","disableFuture","placeholder","inputVariant","StyledCard","Card","StyledCardContent","CardContent","Description","$empty","$maxHeight","StyledActionArea","CardActionArea","Image","img","ImageContainer","Title","Authors","BookResult","idx","onSearchResultClick","searchLoading","from","detailView","setDetailView","maxHeight","setMaxHeight","offsetHeight","capitalize","src","alt","acc","cur","CardActions","BookResults","SearchBooks","closeSearch","handleSearch","setBookData","results","setResults","query","elements","search","startAdornment","StyledTableContainer","TableContainer","BOOK_COLUMN_STATE","DEFAULT_COLUMN_STATES","Books","searchBookOpen","setSearchBookOpen","addedSnackbar","filteredItemsLength","setFilteredItemsLength","setCount","setColumnState","column","columnState","parsedColumnState","parse","dateOptions","subWeeks","subMonths","subYears","columns","filter","searchable","customBodyRenderLite","dataIndex","customFilterListOptions","filterType","logic","filters","some","filterList","renderValue","date_added","isBefore","opt","sortDescFirst","row","Set","sortThirdClickReset","customFooter","bottomOffset","onEnter","scrollableAncestor","customSearchRender","debounceSearchRender","draggableColumns","enabled","onFilterChange","onRowClick","rowData","onRowsDelete","rowsDeleted","newTableData","all","onTableChange","tableState","displayData","onViewColumnsChange","changedColumn","pagination","responsive","setTableProps","searchPlaceholder","tableBodyMaxHeight","request","work_id","book_id","isbn","ISBN_13","ISBN_10","goodreads_work_id","mergedResult","mergeWith","objVal","srcVal","authorsToAdd","authorsToCreate","forEach","author","bookResult","assign","ThemeProvider","overrides","MUIDataTable","paper","backgroundColor","MUIDataTableHeadCell","fixedHeader","MUIDataTableSelectCell","headerCell","MuiGrid","MUIDataTableToolbar","filterPaper","FormContainer","StyledFooter","GenericAddDeleteCreateDialog","editingItem","StyledList","GenericAddDeleteCreate","getType","setEditingItem","item","onClickItem","GenreDialog","deleteDialog","setDeleteDialog","genresWithNull","parseData","disableClearable","StyledSortableTree","SortableTree","Container","NumberCircle","span","Genres","setTitleEndAdornment","treeState","setTreeState","genreInfoDialogOpen","setGenreInfoDialogOpen","_genres","getTreeDataFromGenres","genreMap","Map","root","bookCountForGenre","set","expanded","bookCount","node","disableGutters","addCount","numToAdd","DndProvider","backend","HTML5Backend","canDrop","prevParent","nextParent","getNodeKey","onMoveNode","nextParentNode","rowHeight","treeData","isVirtualized","LITERATURE_CURRENT_SUBMODULE","LITERATURE_MODULES","appDrawer","jsx","Literature","storedSubModule","sessionStorage","currentSubModule","setCurrentSubModule","titleEndAdornment","key","saveCurrentSubModule","HOME_AUTOMATION_URL","COMMANDS","gate_toggle","ac_off","ac_on_24","ac_on_25","ceiling_fan_on","ceiling_fan_off","dyson_fan_on","dyson_fan_off","StyledContainer","HomeAutomation","setSnackbar","setDisabled","command","setTimeout","FormControl","InputLabel","Select","MenuItem","DVR_URL","DVR_STREAM_URL","getOrRefreshChannel","channel","CHANNELS","VideoDiv","StyledVideo","video","DVR","setChannel","player","stream_uuid","timeout","uuid","getChannelUrl","load","shaka","polyfill","installAll","unload","destroy","switchChannel","data-shaka-player-container","data-shaka-player","videoEl","Player","isBrowserSupported","detail","ui","Overlay","getControls","autoPlay","TextFieldClearableInfo","info","CleaveTextField","htmlRef","FieldUseWatch","fieldsToWatch","fields","useWatch","FIELDS","emptyStringToUndefined","schema","portfolioValue","positive","spyPrice","hedgeRatio","delta","StyledTypography","StyledTextFieldClearableInfo","StyledTextFieldRefresh","onRefresh","tooltipText","onOpen","StyledTextFieldClearableInfoCurrency","InputLabelProps","shrink","inputComponent","inputProps","numeral","prefix","rawValueTrimPrefix","rawValue","formatNoDecimals","Intl","NumberFormat","maximumFractionDigits","formatDecimals","formatDollars","currency","currencyDisplay","OptionHedgeCalculator","spyPriceUpdated","setSpyPriceUpdated","setTooltipText","getSpyPrice","c","DIGITS_REGEX","LOWER_REGEX","UPPER_REGEX","SYMBOLS_REGEX","DIGITS","LOWER","UPPER","SYMBOLS","secureRandom","crypto","random","getRandomValues","randint","floor_min","floor_max","choice","getSecureRandom","formatNumber","maximumSignificantDigits","getEntropy","hasDigits","test","hasLowerCase","hasUpperCase","hasSymbols","totalSymbols","bitsPerChar","log2","totalEntropy","generatePassword","digits","lower","upper","symbols","charSet","generate","getSha1Hash","msgUint8","TextEncoder","encode","subtle","digest","hashBuffer","hashArray","Array","Uint8Array","padStart","toUpperCase","generateUsername","vowels","cons","num_vowels","num_cons","i","substr","PASSWORDS_API","TextFieldContainer","OptionsFormGroup","FormGroup","PasswordDetailGrid","GreenCheck","CheckIcon","GreyCross","ClearIcon","formatDecimal","PasswordTools","hashCount","setHashCount","dialogType","passwordSettings","usernameSettings","settings","setSettings","setUsername","setPassword","snackbarOpen","setSnackbarOpen","entropy","setEntropy","secondsToBruteforce","generatedPassword","seconds","checkHibp","hash","HIBP_LOOKUP","copyToClipboard","clipboard","writeText","onPasswordChange","closeSettings","Slider","step","Number","isFinite","formatDistance","TWOFACTOR_URL","BROWSERS_URL","TwoFactor","otpStats","setOtpStats","otpStatus","setOtpStatus","setOtp","secret","setSecret","getOtpStatus","href","$thisDevice","ImageDiv","SavedBrowserDiv","BrowserLogoDiv","$image","CardContainer","BrowserLogo","Chrome","Firefox","Edge","Safari","BrowserCard","browser","is_active","is_current_session","is_saved","first_login","last_activity","ip","country_code","user_agent","forgetAndLogoutBrowser","prettifiedUserAgent","uaString","ua","UAParser","browserName","device","model","os","osName","osVersion","version","isMobile","prettifyUAString","getName","overflowWrap","Grid","GridContainer","Browsers","browsers","setDevices","getBrowserDetail","getBrowsers","compareDesc","SUBMODULES","BROWSERS","TWOFACTOR","Account","submodule","setSubmodule","CURRENT_MODULE","modules","LISTS","displayName","LITERATURE","ACCOUNT","PASSWORDS","HOME_AUTOMATION","OPTION_HEDGE_CALCULATOR","ModuleSelect","currentModule","setCurrentModule","removeItem","moduleName","endIcon","MOHH_MAIL_URL","IHIS_MAIL_URL","HMAIL_URL","IHIS","checkMailThrottled","throttle","addNotification","removeNotificationBySource","trailing","Mail","notificationParams","checkMailAndSetInterval","NotificationProvider","setNotifications","nextId","now","removeNotification","Provider","RefreshSession","LoginCheckAndNetworkState","loggedIn","setRecaptchaKey","fetchRecaptchaKey","clear","ReactDOM","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.cba02892.chunk.js","sourcesContent":["import {messageSW, Workbox} from \"workbox-window\";\nimport {useEffect, useRef, useState} from 'react';\nimport {Button, Snackbar} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport {useAsyncError} from \"./util/useAsyncError\";\nimport {isLocalhost, noop} from \"./util/util\";\n\n// https://developers.google.com/web/tools/workbox/modules/workbox-window#important_service_worker_lifecycle_moments\n\nconst hasServiceWorker = () => 'serviceWorker' in navigator;\n\n// Workbox() calls navigator.serviceWorker which is undefined in Firefox private browsing.\nconst wb = hasServiceWorker() ? new Workbox('./service-worker.js') : null;\n\nconst NoServiceWorker = () => {\n    const [sbOpen, setSbOpen] = useState(true);\n\n    return <Snackbar\n        open={sbOpen}\n        onClose={() => setSbOpen(false)}\n        autoHideDuration={3000}>\n        <Alert\n            severity={'info'}\n            onClose={() => setSbOpen(false)}>\n            {'LoadServiceWorker is not supported in your browser'}\n        </Alert>\n    </Snackbar>\n};\n\nconst withBrowserCheck = Component => {\n    return hasServiceWorker()\n    ? Component\n    : NoServiceWorker;\n};\n\n\nconst ServiceWorkerMain = () => {\n\n    const intervalId = useRef();\n    const registration = useRef({});\n    const [sbOpen, setSbOpen] = useState(false);\n    const [details, setDetails] = useState({\n        text: '',\n        severity: 'info',\n        actions: undefined,\n        autoHideDuration: 3000,\n    });\n\n    const setError = useAsyncError();\n\n    const reloadPage = () => {\n        setSbOpen(false);\n        window.location.reload()\n    };\n\n    const onInstalled = (event) => {\n        //\n        if (!event.isUpdate) {\n            setSbOpen(true);\n            setDetails({\n                text: 'Site is now available offline.',\n                severity: 'info',\n                autoHideDuration: 3000,\n            });\n            console.log('Installed, isUpdate false');\n        } else\n            console.log('Installed, isUpdate true')\n    };\n\n    const onControlling = event => {\n        if (event.isUpdate)\n            console.log('Controlling, isUpdate false');\n        else\n            console.log('Controlling, isUpdate true')\n    };\n\n    const onActivated = event => {\n        if (event.isUpdate)\n            console.log('Activated, isUpdate false');\n        else\n            console.log('Activated, isUpdate true')\n    };\n\n    const onUpdate = () => {\n        /*Deactivates the previous service worker and starts running the new one, ready for requests\n        * Regardless of the user's decision, the next reload will result in a new page.\n        * The new sw instance must be messaged for this to work.\n        * This is obtained from 'registration' set during registration of the new sw.\n        * For some reason wb.messageSW messages the old SW instead.*/\n        if (registration.current?.waiting) {\n            //Prompt user\n            setSbOpen(true);\n            setDetails({\n                text: 'Site has been updated. Reload page?',\n                severity: 'info',\n                autoHideDuration: null,\n                actions: <>\n                    <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={() => setSbOpen(false)}\n                    >No</Button>\n                    <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={reloadPage}\n                    >Yes</Button>\n                </>\n            });\n\n            messageSW(registration.current.waiting, {type: 'SKIP_WAITING'});\n            clearInterval(intervalId.current);\n            console.log('Waiting for activation, newer version available');\n        }\n    };\n\n    const onError = error => {\n        setSbOpen(true);\n        setDetails({\n            text: `Service worker update failed: ${error.toString()}`,\n            autoHideDuration: null,\n            severity: 'error',\n        });\n        console.log('Service worker update failed: ', error)\n    };\n\n    const onLocalhost = () => {\n        setSbOpen(true);\n        setDetails({\n            text: 'On localhost, service worker registration skipped',\n            autoHideDuration: 3000,\n            severity: 'info'\n        });\n        console.log('On localhost, service worker registration skipped.')\n    };\n\n    useEffect(() => {\n\n        // Skip SW registration if on localhost\n        if (isLocalhost) {\n            onLocalhost();\n            return;\n        }\n\n\n        wb.addEventListener('controlling', onControlling);\n        wb.addEventListener('activated', onActivated);\n        wb.addEventListener('installed', onInstalled);\n        wb.addEventListener('waiting', onUpdate);\n        wb.addEventListener('externalwaiting', onUpdate); // Any other different version\n\n        // Throw errors during registration\n        wb.register().then(r => registration.current = r).catch(e => setError(e));\n\n        // Service worker updates are checked on initial load\n        intervalId.current = setInterval(() => {\n            console.log('Checking for service worker updates...');\n\n            // Show snackbar on update failure, rather than throwing error\n            wb.update().catch(onError)\n        }, 5 * 60 * 1000);\n\n        // eslint-disable-next-line\n    }, []);\n\n    return <Snackbar\n        open={sbOpen}\n        ClickAwayListenerProps={{onClickAway: noop}}\n        onClose={() => setSbOpen(false)}\n        autoHideDuration={details.autoHideDuration}>\n        <Alert\n            severity={details.severity}\n            action={details.actions}\n            onClose={() => setSbOpen(false)}>\n            {details.text}\n        </Alert>\n    </Snackbar>;\n};\n\nexport const LoadServiceWorker = withBrowserCheck(ServiceWorkerMain);","import {useState} from 'react'\nimport {useCallback} from \"react\";\n\n/*Workaround to throw errors in callbacks to ErrorBoundaries*/\nexport const useAsyncError = () => {\n    const setError = useState(null)[1];\n\n    return useCallback(e => setError(() => {\n        if (e instanceof Error){ //Subclasses of Error also return true\n            throw e\n        } else {\n            throw new Error(e)\n        }\n\n    }), [setError])\n};","/**\n * Utility functions.\n * Larger functions should be in their own file.\n */\nimport removeAccents from \"remove-accents\"\nimport seedrandom from 'seedrandom'\nimport {\n    differenceInCalendarDays,\n    differenceInCalendarYears,\n    differenceInMinutes,\n    format,\n    formatDistanceToNow,\n    formatDistanceToNowStrict\n} from \"date-fns\";\nimport UAParser from \"ua-parser-js\";\n\n/**\n * Strip accents, empty spaces and lowercase a string (for comparison purposes)\n * undefined/null returns an empty string\n * @param {String} string\n */\nexport const sanitizeString = string =>\n    string ? removeAccents(string).trim().toLowerCase() : ''\n;\n\nexport const isEmpty = string => !Boolean(string?.trim());\n\n/**\n * Returns a seeded random number between min (inclusive) and max (exclusive)\n * @param min\n * @param max\n * @param seed\n */\nexport const getRandomInt = (min, max, seed) => {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    let rng = seedrandom(seed);\n    return Math.floor(rng() * (max - min) + min)\n};\n\n/**\n * Days since Unix Epoch\n * Works properly so far (i.e. day count changes at 0000hrs of current locale)\n * @returns {number}\n */\nexport const getDaysSinceEpoch = () =>\n    differenceInCalendarDays(new Date(), new Date(0));\n\n/**\n * Returns formatDateToNow if within the same minute,\n * otherwise returns formatDistanceToNowStrict if within same calendar day,\n * otherwise returns date like 18 Apr if same calendar year,\n * otherwise like Apr 2021\n * @param date\n */\nexport const formatDistanceToNowPretty = date => {\n    if (differenceInMinutes(new Date(), date) < 1)\n        return formatDistanceToNow(date, {addSuffix: true});\n    if (differenceInCalendarDays(new Date(), date) < 1)\n        return formatDistanceToNowStrict(date, {addSuffix: true});\n    if (differenceInCalendarYears(new Date(), date) < 1)\n        return format(date, 'd MMM');\n    return format(date, 'MMM y')\n};\n\nexport const isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport const noop = () => {\n};\n\nlet arr = new Uint32Array(1);\nconst max = 2 ** 32;\n\n/**\n * Cryptographically secure random number generator.\n * Assumes window.crypto exists.\n */\nexport const getSecureRandom = () => {\n    if (!window.crypto) throw new Error('window.crypto not supported on browser');\n\n    /*Will generate random numbers between 0 and 1 (exclusive) with 32 bit maximum precision\n    * Rejection sampling.*/\n    const random = () => {\n        let val = crypto.getRandomValues(arr)[0] / max;\n        if (val >= 1) return random();\n        return val\n    };\n\n    /*Random integer between min (inclusive) and max (exclusive)*/\n    const randint = (min, max) => {\n        let floor_min = Math.floor(min);\n        let floor_max = Math.floor(max);\n        return Math.floor(random() * (floor_max - floor_min)) + floor_min\n    };\n\n    /*Select random element of an array*/\n    const choice = arr => arr[randint(0, arr.length)];\n\n    return {\n        random,\n        randint,\n        choice,\n    }\n};\n\nexport const prettifyUAString = uaString => {\n    let ua = UAParser(uaString);\n    let {\n        browser: {\n            name: browserName,\n        },\n        // if type is set, it is mobile\n        device: {model, type},\n        os: {name: osName, version: osVersion}\n    } = ua;\n\n    return {\n        name: `${browserName} on ${osName} ${osVersion}${model ? ` (${model})` : ''}`,\n        isMobile: Boolean(type),\n        browserName\n    }\n};","import {Component} from \"react\";\nimport {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    Snackbar,\n    styled as muiStyled\n} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\n\nconst StyledDialog = muiStyled(Dialog)(({theme}) => ({\n    /*As zIndex is set inline in Dialog, style must be overridden with !important*/\n    zIndex: `${theme.zIndex.snackbar + 1} !important`,\n}));\n\nexport class ErrorBoundary extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            error: false,\n            errorInfo: null,\n            dialogOpen: false,\n        };\n    }\n\n    static getDerivedStateFromError(error) {\n        return {error: error};\n    }\n\n    setDialogOpen = state => this.setState({dialogOpen: state});\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({errorInfo});\n    }\n\n    render = () => this.state.error\n        ? <>\n            <StyledDialog\n                open={this.state.dialogOpen}\n                onClose={() => this.setDialogOpen(false)}\n                scroll={'body'}\n            >\n\n                <DialogTitle>{this.state.error.toString()}</DialogTitle>\n\n                <DialogContent>\n                    <DialogContentText>{this.state.errorInfo?.componentStack}</DialogContentText>\n                </DialogContent>\n\n                <DialogActions>\n                    <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={() => this.setDialogOpen(false)}\n                    >Close\n                    </Button>\n                </DialogActions>\n\n            </StyledDialog>\n            <Snackbar open>\n                <Alert\n                    severity={'error'}\n                    action={<>\n                        <Button\n                            variant={'text'}\n                            color={'primary'}\n                            onClick={() => this.setDialogOpen(true)}\n                        >Details</Button>\n                        <Button\n                            variant={'text'}\n                            color={'primary'}\n                            onClick={() => window.location.reload()\n                            }\n                        >Reload</Button>\n                    </>\n                    }>\n                    An error has occurred.\n                </Alert>\n            </Snackbar>\n        </>\n        : this.props.children\n\n}","import {unstable_createMuiStrictModeTheme as createMuiTheme} from \"@material-ui/core/styles\"; //todo replace with v5 when out\n\nexport const theme = createMuiTheme({\n    palette: {\n        type: \"dark\",\n        primary: {\n            main: '#90caf9',\n        },\n        secondary: {\n            main: '#f48fb1',\n        },\n    }\n});\n\nexport const OverlayScrollbarOptions = {\n    className: 'os-theme-light',\n    overflowBehavior: {\n        x: 'hidden'\n    },\n    scrollbars: {\n        autoHide: 'move',\n    }\n};","import styled from \"styled-components\";\nimport {getDaysSinceEpoch, getRandomInt} from \"../util/util\";\nimport {useCallback, useEffect, useState} from \"react\";\n\n/*Largest index of background images, inclusive*/\nconst NUM_IMAGES = 90;\n\nconst RandomBackgroundImage = styled.div`\n  background: url(${({$picIndex}) => `/bg/${$picIndex}.jpg`}) top/cover;\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  z-index: -1;\n`;\n\n/*Get the latest pic index on window focus (setTimeout is unreliable*/\nconst getPicIndex = () => getRandomInt(1, NUM_IMAGES + 1, getDaysSinceEpoch());\n\nexport const RandomBackground = () => {\n\n    const [picIndex, setPicIndex] = useState(getPicIndex());\n    const listener = useCallback(() => setPicIndex(getPicIndex()), [])\n\n\n    useEffect(() => {\n        window.addEventListener('focus', listener)\n        return () => window.removeEventListener('focus', listener)\n    }, [listener]);\n\n    return <RandomBackgroundImage $picIndex={picIndex}/>\n};","/**\n * Entrypoint URLs shared between modules\n * */\n\n// Base API URL\nexport const API_URL = 'https://api.nicholaslyz.com';\n\n// Files URL\nexport const FILES_URL = 'https://files.nicholaslyz.com';\n\n// Account URLs\nexport const ACCOUNT_URL = `${API_URL}/account`;\n\nexport const LOGIN_URL = `${ACCOUNT_URL}/login/`;\nexport const LOGOUT_URL = `${ACCOUNT_URL}/logout/`;\nexport const RECAPTCHA_KEY_URL = `${ACCOUNT_URL}/recaptcha-key/`;\n\n// Test URL\nexport const TEST_URL = `${API_URL}/test/`;","import styled from \"styled-components\";\n\nexport const BACKGROUND_COLOR = `background: rgba(0, 0, 0, 0.6)`;\n\n//For use with already dark backgrounds\nexport const BACKGROUND_COLOR_LIGHT = `background: rgba(0, 0, 0, 0.3)`;\nexport const BACKGROUND_BOX_SHADOW = `box-shadow: 0 0 10px 5px rgba(0, 0, 0, 0.6)`;\n\nexport const BackgroundScreen = styled.div`\n  ${BACKGROUND_COLOR};\n`;\n\nexport const BackgroundScreenRounded = styled(BackgroundScreen)`\n  border-radius: 5px;\n  ${BACKGROUND_BOX_SHADOW};\n`;","import {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    IconButton,\n    Snackbar\n} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport React, {useState} from \"react\";\nimport {styled as muiStyled} from \"@material-ui/core/styles\";\nimport CloseIcon from \"@material-ui/icons/Close\";\n\nconst StyledDialog = muiStyled(Dialog)(({theme}) => ({\n    /*As zIndex is set inline in Dialog, style must be overridden with !important*/\n    zIndex: `${theme.zIndex.snackbar + 1} !important`,\n}));\n\n/* Display snackbar with dialog.\n* Omit onClose to prevent user from dismissing alert\n* Omit dialogTitle & dialogText to disable dialog*/\nexport const AlertSnackbarWithDialog = ({\n                                            severity = 'error',\n                                            onClose,\n                                            snackbarText,\n                                            dialogTitle,\n                                            dialogContent,\n                                            actions\n                                        }) => {\n\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const dialogEnabled = Boolean(dialogTitle && dialogContent);\n\n    return <>\n        {dialogEnabled && <StyledDialog\n            open={dialogOpen}\n            onClose={() => setDialogOpen(false)}\n            scroll={'body'}>\n\n            <DialogTitle>{dialogTitle}</DialogTitle>\n\n            <DialogContent>\n                <DialogContentText component={'div'}>\n                    {dialogContent}\n                </DialogContentText>\n            </DialogContent>\n\n\n            <DialogActions>\n                <Button\n                    variant={'text'}\n                    color={'primary'}\n                    onClick={() => setDialogOpen(false)}\n                >Close\n                </Button>\n            </DialogActions>\n\n        </StyledDialog>}\n        <Snackbar open>\n            <Alert\n                severity={severity}\n                action={<>\n                    {dialogEnabled && <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={() => setDialogOpen(true)}>\n                        Details\n                    </Button>}\n                    {actions}\n                    {onClose && <IconButton\n                        size=\"small\"\n                        color=\"inherit\"\n                        onClick={onClose}>\n                        <CloseIcon fontSize=\"small\"/>\n                    </IconButton>}\n                </>}>\n                {snackbarText}\n            </Alert>\n        </Snackbar>\n    </>\n        ;\n};","import {Button} from \"@material-ui/core\";\nimport React from \"react\";\nimport {AlertSnackbarWithDialog} from \"./shared/AlertSnackbarWithDialog\";\n\n/*Global object to notify user of network state*/\nexport const NetworkState = {\n    HTTP_ERROR: 'HTTP_ERROR',\n    FETCH_ERROR: 'FETCH_ERROR',\n    throwError: error => {\n        throw new Error(`'throwError' must be implemented`)\n    }\n};\n\n\n/*Displays appropriate snackbars informing users of network state/errors,\n* with remediation options.\n*\n* Accepts both Responses and Errors.*/\nexport const NetworkStateSnackbar = ({networkError: {message, name, object, status}, setNetworkError, logout}) => {\n\n    /*Authentication errors. Allow user to close snackbar*/\n    if (object instanceof Response && [401, 403].includes(status))\n        return <AlertSnackbarWithDialog\n            dialogTitle={name}\n            actions={<Button color={'primary'}\n                             onClick={logout}>\n                Login </Button>}\n            dialogContent={message}\n            severity={'warning'}\n            snackbarText={'You are logged out.'}\n            onClose={() => setNetworkError(undefined)}\n        />;\n\n\n    /*Other HTTP errors (4xx/5xx). Allow user to close snackbar*/\n    else if (object instanceof Response)\n        return <AlertSnackbarWithDialog\n            dialogTitle={name}\n            actions={<Button color={'primary'} onClick={() => window.location.reload()}>\n                Reload\n            </Button>}\n            dialogContent={message}\n            severity={'error'}\n            snackbarText={'An HTTP error has occurred.'}\n            onClose={() => setNetworkError(undefined)}\n        />;\n\n    /*Fetch error. Allow user to close snackbar*/\n    else return <AlertSnackbarWithDialog\n            dialogTitle={name}\n            snackbarText={'A network error has occurred.'}\n            dialogContent={message}\n            severity={'error'}\n            actions={<Button color={'primary'} onClick={() => window.location.reload()}>\n                Reload\n            </Button>}\n            onClose={() => setNetworkError(undefined)}\n        />\n\n};","import {NetworkState} from \"../NetworkStateSnackbar\";\n\n\nexport class NotAuthenticated extends Error {\n    constructor(message, data) {\n        super(message);\n        this.data = data\n    }\n}\n\n/**\n * Handles authentication for fetch() requests.\n * Static class\n */\nexport class Networking {\n\n    static GET = 'GET';\n    static POST = 'POST';\n    static DELETE = 'DELETE';\n    static PUT = 'PUT';\n\n    /**\n     * Wrap fetch request with authentication headers.\n     * Throws on fetch/4xx/5xx errors (promise is NOT resolved)\n     * User will be notified via snackbar.\n     *\n     * Sample usage:\n     * ```\n     * Networking.send(LOGIN_URL, {method: Networking.POST, body: {...}})\n     * .then(resp => //code to deal with response)\n     * ```\n     *\n     * @param url\n     * @param obj Parameters for the fetch() request. Defaults to 'GET'.\n     * @returns {Promise<Response>}\n     */\n    static send = (url, {method = Networking.GET, headers, body = null} = {}) =>\n        new Promise(resolve =>\n            fetch(url, {\n                    method: method,\n                    credentials: 'include',\n                    headers: {\n                        Accept: 'application/json',\n                        'Content-Type': 'application/json',\n                        ...headers\n                    },\n                    body: body\n                }\n            ).then(resp => resp.ok ?\n                void typeof resolve(resp) :\n                resp.text().then(r => NetworkState.throwError({\n                    message: <>\n                        <p>{method}: {url}</p>\n                        <p>{r}</p>\n                    </>,\n                    name: `HTTP Error ${resp.status}: ${resp.statusText}`,\n                    object: resp,\n                    status: resp.status\n                }))\n            ).catch(e => NetworkState.throwError({\n                message: <>\n                    <p>{method}: {url}</p>\n                    <p>{e.message}</p>\n                </>,\n                name: e.name,\n                object: e,\n                status: null\n            }))\n        );\n\n\n    /**\n     * Convenience methods for obtaining get, add, update and delete methods from a URL\n     *\n     * <pre>\n     * get: function(...params) => url(...params)\n     * add: function(object, ...params) => url(...params)\n     * update: function (object, id, ...params) => detailUrl(id, ...params)\n     * del: function (id, ...params) => detailUrl(id, ...params)\n     * </pre>\n     *\n     * @param url str or function(...params) => url to obtain object list\n     * @param detailUrl function(id, ...params) => url to obtain object details\n     * @returns {[function(): Promise<unknown>, function(*=): Promise<unknown>, function(*=): Promise<unknown>, function(*=): Promise<unknown>]}\n     */\n    static crudMethods = (url, detailUrl) => {\n        let get = (...params) => Networking.send(\n            typeof url === 'function' ?\n                url(...params) :\n                url,\n            {method: Networking.GET})\n            .then(resp => resp.json());\n\n        let add = (object, ...params) => Networking.send(\n            typeof url === 'function' ?\n                url(...params) :\n                url,\n            {\n                method: Networking.POST,\n                body: JSON.stringify(object),\n            })\n            .then(resp => resp.json());\n\n        let update = (object, id, ...params) => Networking.send(\n            detailUrl(id, ...params),\n            {\n                method: Networking.PUT,\n                body: JSON.stringify(object),\n            })\n            .then(resp => resp.json());\n\n        let del = (id, ...params) => Networking.send(\n            detailUrl(id, ...params),\n            {method: Networking.DELETE}); //Note - for a DELETE operation, nothing is returned by the server\n\n        return [get, add, update, del]\n    }\n}","import React, {useState} from 'react';\nimport {LOGIN_URL} from \"./globals/urls\";\nimport styled from \"styled-components\";\nimport {Button, Checkbox, CircularProgress, FormControlLabel, TextField, Typography} from \"@material-ui/core\";\nimport {BackgroundScreenRounded} from \"./shared/backgroundScreen\";\nimport {Networking} from \"./util/networking\";\nimport {useInput} from \"./util/useInput\";\nimport {useAsyncError} from \"./util/useAsyncError\";\nimport ReCAPTCHA from \"react-google-recaptcha\";\n\nconst StyledForm = styled.form`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  margin: 0 auto;\n  max-width: 300px;\n  height: 100vh;\n`;\n\nconst InnerContainer = styled(BackgroundScreenRounded)`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 10px;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 5px 0;\n`;\n\nconst Spacer = styled.div`\n  width: 30px\n`;\n\nconst StyledCircularProgress = styled(CircularProgress)`\n  margin-left: 10px;\n`;\n\nexport const Login = ({setLoggedIn, recaptchaKey}) => {\n\n    const [loginMessage, setLoginMessage] = useState('Sign In');\n    const [loading, setLoading] = useState(false);\n    const [otpRequired, setOtpRequired] = useState(false);\n\n    const {values, bind, setValue} = useInput();\n    const setError = useAsyncError();\n    const recaptchaRef = React.useRef();\n\n\n    const onSubmit = event => {\n        setLoading(true);\n        event.preventDefault();\n        recaptchaRef.current\n            .executeAsync()\n            .then(token => fetch(LOGIN_URL, {\n                method: Networking.POST,\n                credentials: 'include',\n                headers: {\n                    Accept: 'application/json',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    username: values.username,\n                    password: values.password,\n                    token: token,\n                    otp: values.otp,\n                    save_browser: values.saveBrowser\n                })\n            }))\n            .then(r => {\n                if (r.ok) setLoggedIn(true);\n                else if (![401, 403].includes(r.status)) {\n                    /*Throw on other, non 401/403 errors*/\n                    setError(`HTTP Error ${r.status}: ${r.statusText}`)\n                }\n                return r.json()\n            })\n            .then(r => {\n                /*401/403 errors*/\n                if (r.otp_required && !otpRequired) {\n                    /*Prompt for OTP*/\n                    setOtpRequired(true)\n                } else {\n                    /*Invalid OTP*/\n                    setLoginMessage(r.message)\n                }\n                /*Reset captcha to allow user to retry*/\n                recaptchaRef.current?.reset();\n                setLoading(false)\n            })\n    };\n    return <StyledForm onSubmit={onSubmit}>\n        <InnerContainer>\n            <Typography variant={'h6'} gutterBottom align={\"center\"}>\n                {loginMessage}\n            </Typography>\n            {!otpRequired && <>\n                <StyledTextField\n                    type='text'\n                    label={'Username'}\n                    fullWidth\n                    required\n                    autoFocus\n                    variant={'outlined'}\n                    autoComplete={'username'}\n                    {...bind('username')}\n                />\n\n                <StyledTextField\n                    type={'password'}\n                    label={'Password'}\n                    autoComplete={'current-password'}\n                    fullWidth\n                    required\n                    variant={'outlined'}\n                    {...bind('password')}\n                />\n            </>}\n\n            {otpRequired && <>\n                <StyledTextField\n                    type={'password'}\n                    label={'OTP'}\n                    autoComplete={'one-time-code'}\n                    fullWidth\n                    variant={'outlined'}\n                    inputmode={\"numeric\"}\n                    pattern={\"[0-9]*\"}\n                    {...bind('otp')}\n                />\n                <FormControlLabel\n                    control={<Checkbox\n                        checked={values.saveBrowser}\n                        onChange={e => setValue({\n                            name: 'saveBrowser',\n                            value: e.target.checked\n                        })}\n                    />}\n                    label={'Remember browser'}\n                />\n            </>}\n\n            <Button\n                variant={'contained'}\n                type={'submit'}\n                color={'primary'}\n                fullWidth\n            >\n                <Spacer/>Login{loading ? <StyledCircularProgress color={\"inherit\"} size={20}/> : <Spacer/>}\n            </Button>\n            <ReCAPTCHA\n                ref={recaptchaRef}\n                size={'invisible'}\n                sitekey={recaptchaKey}\n                theme={'dark'}\n            />\n\n        </InnerContainer>\n    </StyledForm>;\n};\n","import {useReducer} from \"react\";\n\n/**\n * Uses useReducer (setValue is dispatch({name, value})\n * value can be a function, which will receive the latest state[key] as an argument.\n * If initial state for a key is not set, returns '' by default.\n * @param initialValues initial value of inputs as an object of name: value pairs\n * @returns {{bind: (function(*=): {onChange: function(*): *, name: *, value}), onChange: (function(*): *), setValues: *, values: React.ReducerStateWithoutAction<function(*=, *): (*)>}}\n */\nexport const useInput = (initialValues = {}) => {\n    const reducer = (state, action) => {\n        if (typeof action.value === 'function') {\n            return {\n                ...state,\n                [action.name]: action.value(state[action.name])\n            }\n        } else\n            return {\n                ...state,\n                [action.name]: action.value\n            };\n    };\n\n    const [values, setValue] = useReducer(reducer, initialValues);\n\n    const onChange = e => setValue({\n        name: e.target.name,\n        value: e.target.value\n    });\n\n    const bind = name => ({\n        onChange,\n        name: name,\n        value: values[name] || ''\n    });\n\n    return {values, setValue, onChange, bind}\n\n};","import styled from 'styled-components'\nimport {Button, Slide, useScrollTrigger} from \"@material-ui/core\";\n\nexport const HideOnScroll = ({children, target}) => {\n    const trigger = useScrollTrigger({threshold: 50, target});\n    return <Slide direction={'down'} in={!trigger}>\n        {children}\n    </Slide>\n};\n\nconst MuiStyledButton = styled(Button)({\n    margin: '10px',\n});\n\n/**\n * Plain button with 10px margin\n * @type {function(JSX.Element): *}\n */\nexport const StyledButton = ({variant, color, onClick, ...props}) => <MuiStyledButton\n    variant={variant}\n    color={color}\n    onClick={onClick}\n    {...props}\n/>;","import React from 'react'\n\nexport const getNotificationCount = notifications => notifications.reduce((sum, e) => sum + e.count, 0);\n\nexport const NotificationContext = React.createContext(undefined);","import {Badge, Chip, Divider, IconButton, ListItem, ListItemText, Popover, Typography} from '@material-ui/core'\nimport NotificationsIcon from \"@material-ui/icons/Notifications\";\nimport React, {useContext, useState} from \"react\";\nimport {getNotificationCount, NotificationContext} from \"./NotificationProvider/notificationContext\";\nimport styled from \"styled-components\";\nimport {formatDistanceToNowStrict} from 'date-fns'\n\nconst StyledChip = styled(Chip)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\n\nconst StyledPopover = styled(Popover)`\n  .MuiPopover-paper {\n    max-width: min(calc(100% - 32px), 600px);\n  }\n`;\n\nconst StyledSpan = styled.div`\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n`;\n\nexport const NotificationMenu = () => {\n\n    const [anchorEl, setAnchorEl] = useState();\n    const context = useContext(NotificationContext);\n\n    const handleNotificationClick = e => setAnchorEl(e.currentTarget);\n    const onClose = () => setAnchorEl(null);\n\n    return <>\n        <IconButton\n            onClick={handleNotificationClick}\n        >\n            <Badge badgeContent={getNotificationCount(context.notifications)} color={'error'}>\n                <NotificationsIcon/>\n            </Badge>\n        </IconButton>\n        <StyledPopover\n            anchorEl={anchorEl}\n            open={Boolean(anchorEl)}\n            onClose={onClose}\n            anchorOrigin={{\n                vertical: 'bottom',\n                horizontal: 'right',\n            }}\n        >\n            {context.notifications.length > 0 ?\n                context.notifications.map(e => <React.Fragment key={e.id}><ListItem\n                        onClick={e.action}\n                        button>\n                        <ListItemText\n                            disableTypography\n                            primary={<>\n                                <StyledChip\n                                    color={'primary'}\n                                    label={e.source}\n                                />\n                                {e.title}\n                            </>\n                            }\n                            secondary={<>\n                                <StyledSpan>{e.content}</StyledSpan>\n                                <Typography variant={'body2'}\n                                            align={'right'}>\n                                    {formatDistanceToNowStrict(e.timestamp, {addSuffix: true})}\n                                </Typography></>}\n                        />\n                    </ListItem>\n                        <Divider/>\n                    </React.Fragment>\n                ) :\n                <ListItem>\n                    <ListItemText\n                        primary={'No new notifications'}/>\n                </ListItem>}\n        </StyledPopover>\n    </>\n\n};","import {HideOnScroll} from \"./common\";\nimport {\n    AppBar,\n    Drawer,\n    IconButton,\n    List,\n    ListItem,\n    ListItemIcon,\n    ListItemText,\n    Toolbar,\n    useMediaQuery,\n} from \"@material-ui/core\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport MeetingRoomIcon from '@material-ui/icons/MeetingRoom';\nimport {styled as muiStyled, useTheme} from \"@material-ui/core/styles\"\nimport styled from 'styled-components'\nimport {OverlayScrollbarsComponent} from \"overlayscrollbars-react\";\nimport {BACKGROUND_COLOR} from \"./backgroundScreen\";\nimport {OverlayScrollbarOptions} from \"../globals/theme\";\nimport {NotificationMenu} from \"./notificationMenu\";\n\n/*StyledContainer is a flex container for StyledDrawerContainer (flex: 1 0),\nHideOnScroll (flex: 0 0) and StyledContentContainer (flex: 1 0)*/\n\nconst drawerWidth = 300;\n\nconst OverlayScrollbarsWithMaxWidth = styled(OverlayScrollbarsComponent)`\n  width: ${drawerWidth}px;\n  max-width: 80vw;\n`;\n\n\nconst TransparentDrawer = styled(Drawer)`\n  .MuiDrawer-paper {\n    ${BACKGROUND_COLOR};\n  }\n`;\n\nconst FlexContainer = styled.div`\n  display: flex;\n  height: 100vh;\n`;\n\nconst TransparentAppBar = muiStyled(AppBar)(({theme}) => ({\n    [theme.breakpoints.up('md')]: {\n        width: `calc(100% - ${drawerWidth}px)`,\n        marginLeft: drawerWidth,\n    },\n\n    '@supports (backdrop-filter: blur(10px))': {\n        'backdrop-filter': 'blur(10px)',\n    },\n\n    background: 'rgba(0,0,0,0.6)',\n\n}));\n\nconst StyledDrawerContainer = muiStyled('div')(({theme}) => ({\n    [theme.breakpoints.up('md')]: {\n        width: drawerWidth,\n        flexShrink: 0,\n    },\n\n}));\n\nconst StyledContentContainer = styled.div`\n  flex: 1;\n`;\n\nconst ContentDiv = styled.div`\n  height: calc(100% - 48px); //48px is the height of Toolbar (variant=dense)\n`;\n\nconst StyledAppNameDiv = styled.div`\n  font-family: 'Starcraft', serif;\n  font-size: 20px;\n  margin: 0 auto;\n  text-align: center;\n  cursor: default;\n`;\n\nconst StyledIconButton = muiStyled(IconButton)(({theme}) => ({\n    [theme.breakpoints.up('md')]: {\n        display: 'none',\n    }\n}));\n\n\nexport const AppBarResponsive = ({\n                                     appName,\n                                     titleContent, // Typography h6 is recommended with 'noWrap'\n                                     drawerOpen,\n                                     setDrawerOpen,\n                                     drawerContent,\n                                     children,\n                                     returnToMainApp,\n                                     logout\n                                 }) => {\n\n    const theme = useTheme();\n    const mobile = useMediaQuery(theme.breakpoints.down('sm'));\n\n    const drawer = <OverlayScrollbarsWithMaxWidth\n        options={OverlayScrollbarOptions}\n        className={'os-host-flexbox'}>\n        <List>\n            <ListItem>\n                <StyledAppNameDiv>{appName}</StyledAppNameDiv>\n            </ListItem>\n            <ListItem button onClick={returnToMainApp}>\n                <ListItemIcon>\n                    <ArrowBackIcon/>\n                </ListItemIcon>\n                <ListItemText primary={'Back to Apps'}/>\n            </ListItem>\n            {drawerContent}\n            <ListItem button onClick={logout}>\n                <ListItemIcon>\n                    <MeetingRoomIcon/>\n                </ListItemIcon>\n                <ListItemText primary={'Logout'}/>\n            </ListItem>\n        </List>\n    </OverlayScrollbarsWithMaxWidth>;\n\n    return <FlexContainer>\n        <HideOnScroll>\n            <TransparentAppBar\n                position={'fixed'}\n                color={'transparent'}\n\n                // Elevation adds more borders, and makes the page look more busy\n                elevation={0}>\n                <Toolbar variant={\"dense\"}>\n                    <StyledIconButton\n                        color={\"inherit\"}\n                        edge={'start'}\n                        onClick={() => setDrawerOpen(true)}>\n                        <MenuIcon/>\n                    </StyledIconButton>\n                    {titleContent}\n                    <div style={{flex: 1}}/>\n                    <NotificationMenu/>\n                </Toolbar>\n            </TransparentAppBar>\n        </HideOnScroll>\n\n        <StyledDrawerContainer>\n            {mobile\n                ? <Drawer\n                    open={drawerOpen}\n                    onClose={() => setDrawerOpen(false)}\n                >{drawer}\n                </Drawer>\n                : <TransparentDrawer\n                    open\n                    variant={\"permanent\"}\n                >{drawer}\n                </TransparentDrawer>}\n        </StyledDrawerContainer>\n\n\n        <StyledContentContainer>\n            <Toolbar variant={\"dense\"}/>\n            <ContentDiv>\n                {children}\n            </ContentDiv>\n        </StyledContentContainer>\n\n    </FlexContainer>\n};","import {StyledButton} from \"../../shared/common\";\n\nexport const CreateTasklist = props => {\n    return (\n        <StyledButton\n            variant={'contained'}\n            color={'secondary'}\n            onClick={props.promptCreateTasklist}>\n            Create new Tasklist\n        </StyledButton>\n    )\n};\n","import styled from \"styled-components\";\nimport {ListItem, ListItemSecondaryAction} from \"@material-ui/core\";\nimport {BACKGROUND_COLOR} from \"./backgroundScreen\";\nimport {theme} from \"../globals/theme\";\n\nexport const StyledListItem = styled(ListItem)`\n  ::before {\n    margin-left: -16px;\n    content: '';\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    z-index: -1;\n    ${({$hideBackground}) => $hideBackground ? '' : BACKGROUND_COLOR};\n  }\n\n  ${theme.breakpoints.up('md')} {\n    ${({$reserveSpace}) => $reserveSpace ? 'padding-right: 48px' : 'padding-right: 16px'};\n  }\n  \n  .MuiListItem-container:hover & {\n    padding-right: 48px;\n    \n    // Highlight entire item even when secondary action is hovered\n    background-color: rgba(255, 255, 255, 0.08);\n  }\n`;\nexport const StyledListItemSecondaryAction = styled(ListItemSecondaryAction)`\n  ${theme.breakpoints.up('md')}  {\n    display: none;\n  }\n\n  .MuiListItem-container:hover & {\n    display: block;\n  }\n`;","import {StyledListItem, StyledListItemSecondaryAction} from \"../../shared/styledListItem\";\nimport {IconButton, ListItemText} from \"@material-ui/core\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\n\nexport const Tasklist = ({handleDelete, onClick, value}) => (\n\n    <StyledListItem\n        button\n        onClick={onClick}\n        $hideBackground\n        $reserveSpace={false}\n    >\n        <ListItemText\n            primary={value}\n            primaryTypographyProps={{noWrap: true}}\n        />\n        <StyledListItemSecondaryAction>\n            <IconButton\n                edge={'end'}\n                onClick={handleDelete}>\n                <DeleteIcon/>\n            </IconButton>\n        </StyledListItemSecondaryAction>\n\n    </StyledListItem>\n);\n","// URLs for Tasks App\nimport {API_URL} from \"../../globals/urls\";\n\n//todo move into static class, together with static methods for crud methods\nexport const TASKS_API_URL = `${API_URL}/tasks/`;\nexport const TASKLISTS_URL = `${TASKS_API_URL}tasklists/`;\nexport const getTasklistUrl = id => `${TASKLISTS_URL}${id}/`;\nexport const getTasksUrl = tasklist => `${TASKLISTS_URL}${tasklist}/tasks/`;\nexport const getTaskUrl = (id, tasklist) => `${getTasksUrl(tasklist)}${id}/`;\n","import {CreateTasklist} from \"./createTasklist\";\nimport {Tasklist} from \"./tasklist\";\nimport './tasklists.css'\nimport {getTasklistUrl, TASKLISTS_URL} from \"./urls\";\nimport {List} from \"@material-ui/core\";\nimport {Networking} from \"../../util/networking\";\n\nexport const Tasklists = ({tasklists, listTasklists, currentListId, setAndSaveCurrentList, setDrawerOpen}) => {\n\n    const createTasklist = async (title) => {\n        let resp = await Networking.send(TASKLISTS_URL, {\n            method: 'POST',\n            headers: {'Content-Type': 'application/json',},\n            body: JSON.stringify({title})\n        });\n        let json = await resp.json();\n        let id = json['id'];\n        await listTasklists();\n        setAndSaveCurrentList(id);\n    };\n\n    const deleteTasklist = id => {\n        let decision = window.confirm('Delete tasklist?');\n        if (!decision) return;\n        Networking.send(getTasklistUrl(id), {\n            method: 'DELETE'\n        })\n            .then(() => listTasklists())\n            .then(() => {\n                if (currentListId === id) { //If currently selected tasklist is deleted, display first tasklist\n                    setAndSaveCurrentList(tasklists[0]['id'])\n                }\n            });\n    };\n\n    let listItems = [\n        <CreateTasklist\n            key={0}\n            promptCreateTasklist={() => {\n                let title = prompt('Enter title:');\n                if (title) {\n                    createTasklist(title).then(() => setDrawerOpen(false));\n                }\n            }}\n        />,\n        tasklists?.map(e =>\n            (<Tasklist\n                key={e.id}\n                id={e.id}\n                value={e.title}\n                onClick={() => {\n                    setDrawerOpen(false);\n                    setAndSaveCurrentList(e.id);\n                }}\n                handleDelete={() => deleteTasklist(e.id)}\n            />)\n        )\n\n    ];\n\n    return <List disablePadding dense>\n        {tasklists\n            ? listItems\n            : 'Loading...'}\n    </List>\n\n};","import {IconButton, ListItemText} from \"@material-ui/core\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport {StyledListItem, StyledListItemSecondaryAction} from \"../../shared/styledListItem\";\n\n\nexport const Item = ({deleteTask, handleEditTask, task}) =>\n    <StyledListItem\n        button\n        onClick={() => handleEditTask(task)}\n        $reserveSpace={true}\n    >\n        <ListItemText\n            primary={task.title}\n            secondary={task.notes}\n            secondaryTypographyProps={{noWrap: true}}\n        />\n        <StyledListItemSecondaryAction>\n            <IconButton\n                edge={'end'}\n                onClick={e => {\n                    e.stopPropagation();\n                    deleteTask();\n                }}>\n                <DeleteIcon/>\n            </IconButton>\n        </StyledListItemSecondaryAction>\n\n    </StyledListItem>;","import CodeMirror from \"codemirror/lib/codemirror\";\n\nconst updateBottomMargin = cm => {\n\n    // Fixed 300px of virtual height if lineCount > 1\n    let padding = '';\n\n    if (cm.lineCount() > 1) {\n        // const totalH = cm.display.scroller.clientHeight - 30,\n        //     lastLineH = cm.getLineHandle(cm.lastLine()).height;\n        // padding = (totalH - lastLineH) + \"px\";\n        padding = '300px';\n    }\n\n    if (cm.state.scrollPastEndPadding !== padding) {\n        cm.state.scrollPastEndPadding = padding;\n        cm.display.lineSpace.parentNode.style.paddingBottom = padding;\n        cm.off(\"refresh\", updateBottomMargin);\n        cm.setSize();\n        cm.on(\"refresh\", updateBottomMargin);\n    }\n};\n\nconst onChange = (cm, change) => {\n    if (CodeMirror.changeEnd(change).line === cm.lastLine())\n        updateBottomMargin(cm);\n};\n\n\nCodeMirror.defineOption(\"scrollPastEnd\", false, (cm, val, old) => {\n\n    // I think this turns off the mode\n    if (old && old !== CodeMirror.Init) {\n        cm.off(\"change\", onChange);\n        cm.off(\"refresh\", updateBottomMargin);\n        cm.display.lineSpace.parentNode.style.paddingBottom = \"\";\n        cm.state.scrollPastEndPadding = null;\n    }\n\n    if (val) {\n        cm.on(\"change\", onChange);\n        cm.on(\"refresh\", updateBottomMargin);\n        updateBottomMargin(cm);\n    }\n});","import {UnControlled as CodeMirror} from 'react-codemirror2';\nimport 'codemirror/lib/codemirror.css'\nimport './codemirror.css'\nimport 'codemirror/mode/gfm/gfm'\nimport 'codemirror/addon/edit/closebrackets'\nimport 'codemirror/addon/edit/matchbrackets'\nimport 'codemirror/addon/selection/mark-selection'\nimport 'codemirror/addon/selection/active-line'\nimport 'codemirror/addon/display/autorefresh'\nimport './scrollPastEnd'\nimport {useEffect, useState} from \"react\";\n\n/*\n * Uncontrolled component. Modifying defaultValue after first mount will not trigger re-renders.\n */\nexport const MarkdownEditor = ({defaultValue, onChange}) => {\n\n    const [instance, setInstance] = useState(null);\n    const [initialValue, setInitialValue] = useState();\n    const [loaded, setLoaded] = useState(false);\n\n    /*Necessary to fix wrong Codemirror-sizer instance when mounted within\n    an OverlayScrollbars component with lineWrapping: true*/\n    useEffect(() => instance?.refresh(), [instance]);\n\n    // Set default value on first mount, and ignore all further updates\n\n    useEffect(() => {\n        setInitialValue(defaultValue);\n        setLoaded(true)\n        // eslint-disable-next-line\n    }, []);\n\n    return loaded\n        ? <CodeMirror\n            value={initialValue}\n            options={{\n                theme: 'codemirror',\n                mode: {\n                    name: 'gfm',\n                    highlightFormatting: true,\n                },\n                lineNumbers: true,\n                lineWrapping: true,\n                indentWithTabs: true,\n                viewportMargin: Infinity,\n                autoCloseBrackets: true,\n                matchBrackets: true,\n                styleSelectedText: true,\n                styleActiveLine: true,\n                autoRefresh: true,\n                scrollPastEnd: true\n\n            }}\n            editorDidMount={editor => setInstance(editor)}\n            onChange={(editor, data, newValue) => {\n\n                onChange(newValue);\n            }}\n        />\n        : null\n};\n","import styled from \"styled-components\";\nimport {OverlayScrollbarsComponent} from \"overlayscrollbars-react\";\nimport {Dialog} from \"@material-ui/core\";\nimport {OverlayScrollbarOptions, theme} from \"../globals/theme\";\n\nconst StyledDialog = styled(Dialog)`\n  .MuiDialog-paper {\n    width: min(100vw - 32px, ${({$maxWidth}) => $maxWidth}px);\n  }\n\n  // Blur effect only if supported\n  @supports (backdrop-filter: blur(5px)) {\n    .MuiDialog-container {\n      backdrop-filter: blur(5px);\n    }\n\n    .MuiDialog-paper {\n      background: none;\n    }\n  }\n\n  .MuiDialog-container {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n  }\n\n  // Reduce margins when on mobile\n  ${theme.breakpoints.down('sm')} {\n\n    // Extend width\n    .MuiDialog-paperWidthFalse {\n      max-width: calc(100% - 32px);\n    }\n\n    // Extend height\n    .MuiDialog-paperScrollPaper {\n      max-height: 100%;\n    }\n\n    // Add some margin to the top, and remove bottom margin settings\n    .MuiDialog-paper {\n      margin: 16px 0 0;\n    }\n\n  }\n`;\n\nconst StyledOverlayScrollbarsComponent = styled(OverlayScrollbarsComponent)`\n  .os-viewport {\n    overscroll-behavior: contain;\n  }\n`;\n\n/* Dialog with overlayscrollbars (does not scroll footer component)*/\nexport const DialogBlurResponsive = ({children, footer, maxWidth=800, ...props}) =>\n    <StyledDialog\n        maxWidth={false}\n        $maxWidth={maxWidth}\n        disableScrollLock\n        {...props}>\n        <StyledOverlayScrollbarsComponent\n            options={OverlayScrollbarOptions}\n            className={'os-host-flexbox'}>\n            {children}\n        </StyledOverlayScrollbarsComponent>\n        {footer}\n    </StyledDialog>;","import styled from \"styled-components\";\nimport {MarkdownEditor} from \"../../shared/MarkdownEditor/MarkdownEditor\";\nimport {Button, CircularProgress, TextField, Tooltip, Typography, useMediaQuery, Zoom} from \"@material-ui/core\";\nimport {useForm} from \"react-hook-form\";\nimport {useTheme} from \"@material-ui/core/styles\";\nimport {debounce} from 'lodash'\nimport {useCallback, useRef, useState} from \"react\";\nimport {formatDistanceToNowPretty, isEmpty} from \"../../util/util\";\nimport {DialogBlurResponsive} from \"../../shared/dialogBlurResponsive\";\nimport CheckIcon from '@material-ui/icons/Check';\nimport {parseJSON} from \"date-fns\";\n\nconst FooterRight = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n`;\n\nconst Footer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-left: 10px;\n`;\n\nconst SavingStates = {\n    UNCHANGED: 1,\n    MODIFIED: 2,\n    SAVED: 3\n};\n\nconst StyledTextField = styled(TextField)`\n  margin: 5px 0;\n`;\n\nexport const EditItem = ({editingTask, createTask, updateTask, closeEdit, listItems, currentList, deleteTask}) => {\n\n    const theme = useTheme();\n    const fullScreen = useMediaQuery(theme.breakpoints.down('sm'));\n    const [saving, setSaving] = useState(SavingStates.UNCHANGED);\n    const taskId = useRef(editingTask.id);\n    const creatingTask = useRef(false);\n\n    const initialTitle = editingTask.title || '';\n    const initialNotes = editingTask.notes || '';\n\n    const {register, getValues, setValue} = useForm({\n        defaultValues: {\n            'title': initialTitle,\n            'notes': initialNotes,\n        }\n    });\n\n    register('title');\n    register('notes');\n\n    // eslint-disable-next-line\n    const debouncedAutoSave = useCallback(debounce(() => {\n        let {title, notes} = getValues();\n\n        let update = () => updateTask(taskId.current, currentList, title, notes)\n            .then(() => {\n                setSaving(SavingStates.SAVED);\n            });\n\n        if (taskId.current) {\n            return update();\n\n        } else if (!creatingTask.current) {\n\n            // Task has not been created\n            // Prevent subsequent calls from calling createTask() while awaiting server reply\n            creatingTask.current = true;\n\n            return createTask(currentList, title, notes).then(json => {\n                taskId.current = json.id;\n                setSaving(SavingStates.SAVED);\n            })\n        } else return Promise.resolve()\n\n        // todo Calls while creatingTask.current = true will be lost\n        //, albeit the gap is very narrow (server reply must take > debounceTime)\n\n\n    }, 1000, {maxWait: 5000}), [updateTask, editingTask, createTask]);\n\n    const handleClose = () => {\n        //  getValues is null once closeEdit() is called\n        let {title, notes} = getValues();\n\n        // debouncedAutoSave.flush() is only defined when it has been called at least once\n        debouncedAutoSave.flush()?.then(() => {\n\n            // Delete task if it's empty\n            if (taskId.current && isEmpty(title) && isEmpty(notes)) {\n                deleteTask(taskId.current, currentList, false)\n            } else listItems(currentList);\n\n        });\n\n        closeEdit();\n    };\n\n    const autoSave = () => {\n        setSaving(SavingStates.MODIFIED);\n        debouncedAutoSave()\n    };\n\n\n    return <DialogBlurResponsive\n        open\n        onClose={handleClose}\n        footer={<Footer>\n            <Tooltip\n                arrow\n                enterTouchDelay={100}\n                interactive\n                title={editingTask.created ? `Created ${formatDistanceToNowPretty(parseJSON(editingTask.created))}` : ''}>\n                <Typography variant={'body2'} color={'textSecondary'}>\n                    Edited {saving === SavingStates.UNCHANGED && editingTask.updated ?\n                    formatDistanceToNowPretty(parseJSON(editingTask.updated)) :\n                    'just now'}\n                </Typography>\n            </Tooltip>\n            <FooterRight>\n                {{\n                    [SavingStates.UNCHANGED]: null,\n                    [SavingStates.MODIFIED]: <CircularProgress color=\"inherit\" size={20}/>,\n                    [SavingStates.SAVED]:\n                        <Zoom\n                            in={saving === SavingStates.SAVED}>\n                            <CheckIcon/>\n                        </Zoom>,\n                }[saving]}\n                <Button\n                    variant={'text'}\n                    color={'primary'}\n                    onClick={handleClose}>\n                    Close\n                </Button>\n            </FooterRight>\n        </Footer>}\n    >\n        <StyledTextField\n            label='Title'\n            multiline\n            fullWidth\n            name={'title'}\n            autoFocus={!initialTitle && !initialNotes}\n            defaultValue={initialTitle}\n            variant={'outlined'}\n            onChange={e => {\n                setValue('title', e.target.value);\n                autoSave()\n            }}\n        />\n        {fullScreen\n            ? <StyledTextField\n                label='Notes'\n                multiline\n                fullWidth\n                defaultValue={getValues('notes')}\n                variant={'outlined'}\n                onChange={e => {\n                    setValue('notes', e.target.value);\n                    autoSave()\n                }}\n            />\n            : <MarkdownEditor\n                defaultValue={getValues('notes')}\n                onChange={newVal => {\n                    setValue('notes', newVal);\n                    autoSave()\n                }}/>\n        }\n    </DialogBlurResponsive>\n};\n","import {styled as muiStyled} from \"@material-ui/core/styles\";\nimport {Backdrop, CircularProgress, Typography} from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport {BackgroundScreen} from \"./backgroundScreen\";\n\nconst StyledBackdrop = muiStyled(Backdrop)(({theme}) => ({\n    // To cover the app drawer\n    zIndex: theme.zIndex.drawer + 1,\n}));\n\nconst FlexContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-around;\n  height: 100px;\n`;\n\nconst FlexBackgroundScreen = styled(BackgroundScreen)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 100%;\n`;\n\n/**\n * A fullscreen loading backdrop element\n * @param open\n * @param message\n * @param showSpinner\n * @param fullscreen\n * @returns {JSX.Element}\n * @constructor\n */\nexport const Loading = ({\n                            open = true,\n                            message = 'Loading...',\n                            showSpinner = true,\n                            fullscreen = true\n                        }) => {\n\n    let content = <FlexContainer>\n        {showSpinner ? <CircularProgress color=\"inherit\" size={30}/> : null}\n        <Typography variant={'body1'} display={\"block\"}>{message}</Typography>\n    </FlexContainer>;\n\n    if (!open) return null;\n\n    return fullscreen ?\n        <StyledBackdrop open={open}>\n            {content}\n        </StyledBackdrop>\n        : <FlexBackgroundScreen>\n            {content}\n        </FlexBackgroundScreen>;\n\n};","import {forwardRef, useEffect, useRef, useState} from \"react\";\nimport {Item} from \"./item\";\nimport {EditItem} from \"./editItem\";\nimport {getTasksUrl, getTaskUrl} from \"./urls\";\nimport {Virtuoso} from 'react-virtuoso/dist'\nimport {Fab, List} from \"@material-ui/core\";\nimport {Loading} from \"../../shared/loading\";\nimport styled from 'styled-components'\nimport AddIcon from '@material-ui/icons/Add';\nimport {Networking} from \"../../util/networking\";\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\nconst StyledDiv = styled.div`\n  max-width: 800px;\n  height: 100%;\n`;\n\n//todo move into urls as static methods\nconst [, add, update, del] = Networking.crudMethods(getTasksUrl, getTaskUrl);\n\nexport const Tasks = ({currentList, items, listItems}) => {\n\n    const [editingTask, setEditingTask] = useState(null);\n\n    const virtuosoRef = useRef();\n\n    useEffect(() => {\n        if (!currentList) return;\n        listItems(currentList);\n\n        // Prevent virtuoso from remembering the scroll position of the previously viewed list\n        if (virtuosoRef.current) {\n            virtuosoRef.current.scrollToIndex({align: 'top', behavior: 'smooth'})\n        }\n        // eslint-disable-next-line\n    }, [currentList]);\n\n    const createTask = (list, title, notes) => add({tasklist: list, title, notes}, list);\n\n    const updateTask = (id, list, title, notes) => update({id, tasklist: list, title, notes}, id, list);\n\n    const deleteTask = (id, list, prompt = true) => {\n        if (prompt) {\n            let decision = window.confirm('Delete item?');\n            if (!decision) return;\n        }\n        return del(id, list)\n            .then(() => listItems(currentList))\n    };\n\n    const closeEdit = () => void setEditingTask(null);\n\n    const handleEditTask = task => {\n        setEditingTask(task);\n    };\n\n    const handleCreateTask = () => void setEditingTask({\n        id: null,\n        title: '',\n        notes: '',\n    });\n\n\n    const list = items.map(e => (\n        <Item\n            handleEditTask={handleEditTask}\n            deleteTask={() => deleteTask(e.id, e.tasklist)}\n            key={e.id}\n            task={e}/>\n    ));\n\n\n    if (!currentList) return <Loading\n        fullscreen={false}\n        showSpinner={false}\n        message={'Select a tasklist'}/>;\n\n    return <>\n        <StyledFab color={'primary'} onClick={() => handleCreateTask(currentList)}>\n            <AddIcon/>\n        </StyledFab>\n        {editingTask && <EditItem\n            editingTask={editingTask}\n            updateTask={updateTask}\n            createTask={createTask}\n            closeEdit={closeEdit}\n            currentList={currentList}\n            listItems={listItems}\n            deleteTask={deleteTask}\n        />}\n        <StyledDiv>\n            <Virtuoso\n                ref={virtuosoRef}\n                totalCount={list.length}\n                itemContent={index => list[index]}\n                components={{\n                    List: forwardRef(({children, ...props}, listRef) =>\n                        <List\n                            {...props}\n                            disablePadding\n                            dense\n                            ref={listRef}>\n                            {children}\n                        </List>)\n                }}/>\n        </StyledDiv>\n    </>\n};","import {useEffect, useState} from \"react\";\nimport {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport {Tasklists} from \"./tasklists\";\nimport {Tasks} from \"./tasks\";\nimport {getTasksUrl, getTaskUrl, TASKLISTS_URL} from \"./urls\";\nimport {CircularProgress, IconButton, Typography} from \"@material-ui/core\";\nimport SyncIcon from '@material-ui/icons/Sync';\nimport {useAsyncError} from \"../../util/useAsyncError\";\nimport {Networking} from \"../../util/networking\";\n\nconst LIST_CURRENT_LIST = 'LIST_CURRENT_LIST';\n\n//todo move into urls as static methods\nconst get = Networking.crudMethods(getTasksUrl, getTaskUrl)[0];\n\nexport const Lists = ({returnToMainApp, logout}) => {\n\n    // There is a chance the listId stored is invalid - useEffect below checks for this\n    const [currentListId, setCurrentListId] = useState(null);\n    const [tasklists, setTasklists] = useState(null);\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [items, setItems] = useState([]);\n    const setError = useAsyncError();\n\n    const setAndSaveCurrentList = listId => {\n        setCurrentListId(listId);\n        localStorage.setItem(LIST_CURRENT_LIST, listId);\n    };\n\n    const listTasklists = () => Networking.send(TASKLISTS_URL, {\n        method: 'GET'\n    })\n        .then(resp => resp.json())\n        .then(json => setTasklists(json));\n\n    //todo use Abort controller to cancel requests\n    const listItems = list => {\n        setLoading(true);\n        get(list).then(result => {\n            setLoading(false);\n            setItems(result);\n        }).catch(e => setError(e));\n    };\n\n    useEffect(() => void listTasklists(), []);\n\n    // Only set currentListId to saved id if valid\n    useEffect(() => {\n        let savedListId = localStorage.getItem(LIST_CURRENT_LIST);\n        if (tasklists && tasklists.map(e => e.id).includes(savedListId)) {\n            setCurrentListId(savedListId)\n        }\n    }, [tasklists]);\n\n\n    const getTasklistTitle = listId => {\n        if (listId && tasklists)\n            return tasklists.find(e => e.id === listId)?.title;\n    };\n\n    const title = <>\n        <Typography variant={\"h6\"} noWrap>{getTasklistTitle(currentListId)}</Typography>\n        {loading\n            ? <CircularProgress size={20} style={{margin: '12px'}}/>\n            : <IconButton onClick={() => currentListId ? listItems(currentListId) : 0}><SyncIcon/></IconButton>}\n    </>;\n\n    return <AppBarResponsive\n        appName={'Lists'}\n        returnToMainApp={returnToMainApp}\n        logout={logout}\n        drawerOpen={drawerOpen}\n        setDrawerOpen={setDrawerOpen}\n        titleContent={title}\n        drawerContent={<Tasklists\n            currentListId={currentListId}\n            setAndSaveCurrentList={setAndSaveCurrentList}\n            tasklists={tasklists}\n            listTasklists={listTasklists}\n            setDrawerOpen={setDrawerOpen}\n        />}\n    >\n        <Tasks\n            currentList={currentListId}\n            setLoading={setLoading}\n            items={items}\n            setItems={setItems}\n            listItems={listItems}\n        />\n    </AppBarResponsive>\n};\n","/**\n * Convenience URL-related methods for Literature app\n */\nimport {API_URL} from \"../../globals/urls\";\nimport {Networking} from \"../../util/networking\";\n\n//Static URls\nexport const LIT_API = `${API_URL}/literature`;\n\nexport const BOOKS = `${LIT_API}/books/`;\nexport const getBookDetail = id => `${BOOKS}${id}/`;\n\nexport const AUTHORS = `${LIT_API}/authors/`;\nexport const getAuthorDetail = id => `${AUTHORS}${id}/`;\n\nexport const GENRES = `${LIT_API}/genres/`;\nexport const getGenreDetail = id => `${GENRES}${id}/`;\n\nexport const TYPES = `${LIT_API}/types/`;\nexport const getTypeDetail = id => `${TYPES}${id}/`;\n\nexport const SEARCH = `${LIT_API}/search/`;\nexport const BOOK_INFO = `${LIT_API}/bookinfo/`;\n\n// These methods get 'published', 'series_name', 'series_position', 'description'\nexport const getGoogleBookInfo = isbn => Networking.send(`${BOOK_INFO}?isbn=${isbn}`, {method: 'GET'})\n    .then(resp => resp.json());\n\nexport const getGoodreadsBookInfo = (work_id, book_id) => Networking.send(`${BOOK_INFO}?work_id=${work_id}&book_id=${book_id}`, {method: 'GET'})\n    .then(resp => resp.json());\n\n//Convenience methods\nexport const [getBooks, addBook, updateBook, deleteBook] = Networking.crudMethods(BOOKS, getBookDetail);\nexport const [getAuthors, addAuthor, updateAuthor, deleteAuthor] = Networking.crudMethods(AUTHORS, getAuthorDetail);\nexport const [getGenres, addGenre, updateGenre, deleteGenre] = Networking.crudMethods(GENRES, getGenreDetail);\nexport const [getTypes, addType, updateType, deleteType] = Networking.crudMethods(TYPES, getTypeDetail);","/**\n * Schemas for Yup validation, default field values, transformations before submission and other utility functions\n */\n\nimport * as yup from \"yup\";\nimport {formatISO, parseISO} from \"date-fns\";\nimport {trim, isNumber, isEqual, pick} from 'lodash'\n\n/*\nThis is the schema AFTER hydrating to user-viewable input (id, date_added etc are stripped).\n\nSchema keys here are equal to those server-side\n*/\nconst BOOK_SCHEMA = {\n    authors: {\n        yupSchema: yup.array(\n            yup.object({\n                name: yup.string(),\n                id: yup.number().required(),\n                notes: yup.string()\n            }))\n            .ensure(),\n        defaultValue: [],\n        transformToServer: val => val.map(e => e.id),\n        transformFromServer: (val, {authors}) => val.map(id => authors.find(e => e.id === id))\n    },\n    genres: {\n        yupSchema: yup.array(\n            yup.object({\n                name: yup.string(),\n                id: yup.number().required(),\n                notes: yup.string()\n            }))\n            .ensure(),\n        defaultValue: [],\n        transformToServer: val => val.map(e => e.id),\n        transformFromServer: (val, {genres}) => val.map(id => genres.find(e => e.id === id))\n    },\n    type: {\n        yupSchema: yup.object({\n            name: yup.string(),\n            id: yup.number().required(),\n            notes: yup.string()\n        }).typeError('Required'),\n        defaultValue: null,\n        transformToServer: val => val.id,\n        transformFromServer: (val, {types}) => types.find(e => e.id === val)\n    },\n    title: {\n        yupSchema: yup.string().required(),\n        defaultValue: '',\n    },\n    description: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    read_next: {\n        yupSchema: yup.bool(),\n        defaultValue: false,\n    },\n    date_read: {\n        /*v3 KeyboardDatePicker will return 'Invalid Date' as a string for invalid input, causing typeError\n        * Apparently will return null if left blank\n        * This value is modified on submission, to ISO8601\n        * Necessary to check if validated date is not null prior to modifying to ISO8601*/\n        yupSchema: yup.date().nullable().typeError('Date must be in dd/mm/yyyy format'),\n        defaultValue: null,\n        transformToServer: val => val ? formatISO(val, {representation: \"date\"}) : null,\n        transformFromServer: val => val ? parseISO(val) : null // date could be null\n    },\n    image_url: {\n        yupSchema: yup.string().url(),\n        defaultValue: '',\n    },\n    published: {\n        yupSchema: yup.number().integer().nullable().transform((val, origVal) => trim(origVal) === '' ? null : val)\n            .typeError('Must be a valid year'),\n        defaultValue: '',\n        /* isNumber checks are needed because 0 is falsy*/\n        transformFromServer: val => isNumber(val) ? val : ''\n    },\n    google_id: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n        transformToServer: val => trim(val) || null,\n        transformFromServer: val => val || '',\n    },\n    goodreads_book_id: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n        transformToServer: val => trim(val) || null,\n        transformFromServer: val => val || ''\n    },\n    series: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    series_position: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    rating: {\n        yupSchema: yup.number().min(0).max(5).nullable().transform((val, origVal) => trim(origVal) === '' ? null : val),\n        defaultValue: '',\n        /* isNumber checks are needed because 0 is falsy*/\n        transformToServer: val => isNumber(val) ? Math.round(val * 10) / 10 : null, //val is guaranteed to be either number or null here\n        transformFromServer: val => isNumber(val) ? val : ''\n    },\n    my_review: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    notes: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n};\n\nexport const BOOK_FIELDS = Object.fromEntries(Object.keys(BOOK_SCHEMA).map(e => [e, e]));\n\nexport const YUP_SCHEMA = yup.object(Object.fromEntries(Object.entries(BOOK_SCHEMA)\n    .map(([k, v]) => [k, v.yupSchema]))).noUnknown();\n\nexport const DEFAULT_BOOK_VALUES = Object.fromEntries(Object.entries(BOOK_SCHEMA)\n    .map(([k, v]) => [k, v.defaultValue]));\n\nexport const transformToServer = data => Object.fromEntries(\n    Object.entries(data)\n        .map(([k, v]) =>\n            /*This is NOT the same as\n            * BOOK_SCHEMA[k].transformToServer?.(v) ?? v\n            *\n            * The above code will return v if transformToServer(v) === null, which is not intended behavior\n            * */\n            [k, BOOK_SCHEMA[k].transformToServer ?\n                BOOK_SCHEMA[k].transformToServer(v) :\n                v]\n        ));\n\nexport const transformFromServer = (data, dataTypes) => Object.fromEntries(\n    Object.entries(data).map(([k, v]) => [\n        /*See above for explanation why nullish coalescing/optional chaining is not used here*/\n        k, BOOK_SCHEMA[k]?.transformFromServer ?\n            BOOK_SCHEMA[k].transformFromServer(v, dataTypes) :\n            v])\n);\n\n/**\n * Verify if user had made changes to the fields\n * @param originalData - from server\n * @param userData - data from UI after transformation\n * @returns {boolean}\n */\nexport const isBookDataEqual = (originalData, userData) =>\n    isEqual(pick(originalData, Object.keys(BOOK_FIELDS)), userData);","import {useMemo, useState} from \"react\";\nimport {flow} from \"lodash\";\nimport {noop, sanitizeString} from \"../util/util\";\nimport {matchSorter} from \"match-sorter\";\nimport TextField from \"@material-ui/core/TextField\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport Chip from \"@material-ui/core/Chip\";\nimport styled from 'styled-components'\nimport {Autocomplete} from \"@material-ui/lab\";\nimport PropTypes from 'prop-types'\n\nconst StyledCircularProgress = styled(CircularProgress)`\n  cursor: default;\n`;\nconst propTypes = {\n    createOption: PropTypes.func,\n    getOptionLabel: PropTypes.func,\n    getOptions: PropTypes.func.isRequired,\n    getOptionSelected: PropTypes.func,\n    getValue: PropTypes.func, // Required if multiple=true (to get the current state in a callback)\n    maxOptionsToShow: PropTypes.number,\n    multiple: PropTypes.bool,\n    onChange: PropTypes.func.isRequired,\n    options: PropTypes.array.isRequired,\n    renderProps: PropTypes.object, // error state, helper text\n    value: PropTypes.any\n};\n\nexport const AutocompleteWithCreate = ({\n                                           createOption,\n                                           error, // Not used\n                                           getOptionLabel = e => e,\n                                           getOptions,\n                                           getOptionSelected = (a, b) => a === b,\n                                           getValue,\n                                           helperText, // Not used\n                                           maxOptionsToShow = 10,\n                                           multiple = false,\n                                           onChange,\n                                           options,\n                                           renderProps,\n                                           value,\n                                           ...props\n                                       }) => {\n\n        let [loading, setLoading] = useState(false);\n\n        // Optimization for filtering through option labels\n        const sanitizedOptionLabels = useMemo(() => options.map(flow(getOptionLabel, sanitizeString)), [options, getOptionLabel]);\n\n        /* Needed for getting option label for single autocomplete when option is being added (i.e. _name is set)*/\n        const _getOptionLabel = option => getOptionLabel(option) ?? option._name;\n\n        /* Needed to detect options with _name (e.g. currently being added),\n         * otherwise when creating an option while another is being created,\n         * useAutocomplete returns 'remove-option' instead*/\n        const _getOptionSelected = (option, value) =>\n            getOptionSelected(option, value) ||\n            /*An option is currently being created.\n            * Ternary is needed because undefined === undefined*/\n            value._name ? value._name === option._name : false;\n\n        const filterOptions = (options, state) => {\n            let input = state.inputValue;\n            //matchSorter already removes accents, spaces and converts to lowercase\n            let filtered = input ? matchSorter(options, input, {keys: [getOptionLabel]}) : options;\n\n            /*Suggest adding option ONLY if input is NOT blank,\n            NOT in existing options (comparing with diacritics stripped),\n            AND createOption is provided*/\n            if (createOption &&\n                input &&\n                !sanitizedOptionLabels.includes(input)) {\n                createOption && filtered.push({\n                    _name: state.inputValue.trim(),\n                    _isNew: true,\n                    _justAdded: true,\n                })\n            }\n\n            return maxOptionsToShow ? filtered.slice(0, maxOptionsToShow) : filtered //todo add 'Scroll for more' functionality\n        };\n\n        const renderInput = params => <TextField\n            {...params}\n            {...renderProps}\n            InputProps={{\n                ...params.InputProps,\n                ...renderProps?.InputProps,\n                endAdornment:\n                    <>\n                        {loading && <CircularProgress size={20}/>}\n                        {params.InputProps.endAdornment}\n                    </>\n            }}\n        />;\n\n        const renderTags = (tagValue, getTagProps) => tagValue.map((option, index) => {\n                let {onDelete, ...rest} = getTagProps({index});\n                return <Chip\n                    {...rest}\n                    size={\"small\"}\n                    variant={option._isNew ? 'outlined' : 'default'}\n                    onDelete={option._isNew ? noop : onDelete} // onDelete must be set for deleteIcon to appear, but I don't want it to actually delete a newly added option.\n                    deleteIcon={option._isNew ? <StyledCircularProgress size={16}/> : null}\n                    label={option._isNew ?\n                        `Adding ${option._name}...` :\n                        getOptionLabel(option)}\n                />\n            }\n        );\n\n        const onOptionChange = (event, newValue) => {\n            /* A click will never trigger a 'create-option' event.\n             * Only Enter will. So it's useless relying on that.\n             *\n             * The component must be controlled, or else book search\n             * will not be able to add authors.*/\n\n\n            if (multiple) {\n\n                // Find the options with _justAdded === true, call createOption for it and remove the flag\n                let el = newValue.find(e => e._justAdded);\n                if (el) {\n                    el._justAdded = false;\n                    createOption(el._name)\n                        .then(obj => {\n                            // Refresh options with newly added option\n                            getOptions();\n\n                            // Get current state and then replace new option with server returned object (it now has id)\n                            onChange(getValue().map(e => e._name === el._name ? obj : e))\n                        })\n\n                }\n\n            } else if (newValue && newValue._justAdded) {\n\n                // New option added to single value autocomplete (will be disabled while loading)\n                setLoading(true);\n                createOption(newValue._name)\n                    .then(obj => {\n\n                        // Refresh options with newly added option\n                        getOptions();\n\n                        // Input is disabled while this is happening\n                        onChange(obj);\n                        setLoading(false)\n                    })\n            }\n\n            /*No new options were created.\n            * Setting newValue here will result in some options having _name, _justAdded, _isNew properties.\n            * Submission is prevented while in such a state, by Yup schema validation.*/\n            onChange(newValue)\n        };\n\n        return <Autocomplete\n            clearOnBlur // Used together with freeSolo\n            disabled={!multiple && loading}\n            filterOptions={filterOptions}\n            freeSolo // This fixes the 'none of the options match with ...' error\n            getOptionLabel={_getOptionLabel}\n            getOptionSelected={_getOptionSelected}\n            loading={loading}\n            multiple={multiple}\n            onChange={onOptionChange}\n            options={options}\n            renderInput={renderInput}\n            renderOption={option => option._isNew ? `Add '${option._name}'` : getOptionLabel(option)}\n            renderTags={renderTags}\n            value={value}\n            {...props}\n        />\n    }\n;\n\nAutocompleteWithCreate.propTypes = propTypes;","import TextField from \"@material-ui/core/TextField\";\nimport {InputAdornment} from \"@material-ui/core\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\n\nexport const TextFieldClearable = ({onChange, ...props}) =>\n    <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n;","import {TextField} from \"@material-ui/core\";\nimport {useEffect, useRef, useState} from \"react\";\nimport styled from \"styled-components\";\n\nconst StyledTextField = styled(TextField)`\n  \n  ${({$ellipsis}) => $ellipsis ? `\n  .MuiInputBase-input {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }`: null}\n`;\n\n/*TextField which switches to multiline when focused, and singleline with ellipsis otherwise.*/\nexport const TextFieldMultilineEllipsis = ({onBlur, onFocus, ...props}) => {\n    const [focused, setFocused] = useState(false);\n    const [focusPos, setFocusPos] = useState(0);\n    const inputRef = useRef();\n\n    useEffect(() => {\n        if (!focused) return\n        inputRef.current.focus() // Required to focus on the new textarea\n        inputRef.current.setSelectionRange(focusPos, focusPos); // Maintain original cursor position\n    }, [focusPos, focused]);\n\n    return <StyledTextField\n        {...props}\n        $ellipsis={!focused}\n        multiline={focused}\n        inputRef={inputRef}\n        onFocus={e => {\n            setFocused(true)\n            e.target.selectionStart && setFocusPos(e.target.selectionStart)\n        }}\n        onBlur={() => setFocused(false)}\n    />\n};","/*Recursively sort Genre objects*/\nexport const recursiveSort = (arr, compareFn, childrenKey = 'children') => {\n    let mapped = arr.map(e => e[childrenKey].length ? {\n        ...e,\n        [childrenKey]: recursiveSort(e[childrenKey], compareFn, childrenKey)\n    } : e)\n    return mapped.sort(compareFn)\n}\n\n/*Get array of ancestors, from top level to direct parent*/\nexport const getAncestors = (e, genres) => {\n    let arr = []\n    let currentEl = e\n    while (currentEl.parent) {\n        // eslint-disable-next-line no-loop-func\n        let parent = genres.find(p => p.id === currentEl.parent);\n        arr.unshift(parent.name)\n        currentEl = parent\n    }\n    return arr\n}\n\n/*Add extra contextual information to the genres object*/\nexport const mapGenres = (e, genres) => {\n    let ancestors = getAncestors(e, genres)\n    return ({\n        ...e,\n        ancestors, /*for display*/\n        fullName: [...ancestors, e.name].join(' '), /*for sorting*/\n    })\n}","import React, {useCallback, useState} from 'react';\nimport * as Url from \"./urls\";\nimport styled from \"styled-components\";\nimport {KeyboardDatePicker} from \"@material-ui/pickers/DatePicker\";\nimport {MuiPickersUtilsProvider} from \"@material-ui/pickers/MuiPickersUtilsProvider\"\nimport DateFns from '@date-io/date-fns'\nimport {Controller, useForm} from 'react-hook-form'\nimport {yupResolver} from \"@hookform/resolvers/yup\";\nimport {\n    BOOK_FIELDS,\n    DEFAULT_BOOK_VALUES,\n    isBookDataEqual,\n    transformFromServer,\n    transformToServer,\n    YUP_SCHEMA\n} from \"./schema\";\nimport {\n    Button,\n    Checkbox,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    FormControlLabel,\n    FormHelperText,\n    IconButton,\n    Snackbar,\n    Typography\n} from \"@material-ui/core\";\nimport {isEmpty} from \"lodash\";\nimport {DialogBlurResponsive} from \"../../shared/dialogBlurResponsive\";\nimport {Alert} from \"@material-ui/lab\";\nimport {useAsyncError} from \"../../util/useAsyncError\";\nimport {AutocompleteWithCreate} from \"../../shared/AutocompleteWithCreate\";\nimport {TextFieldClearable} from \"../../shared/textFieldClearable\";\nimport {TextFieldMultilineEllipsis} from \"../../shared/textFieldMultilineEllipsis\";\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\nimport {mapGenres} from \"./utils\";\n\nconst FieldContainer = styled.div`\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);\n  grid-template-areas: \n    \"${BOOK_FIELDS.title} ${BOOK_FIELDS.title}\"\n    \"${BOOK_FIELDS.authors} ${BOOK_FIELDS.type}\"\n    \"${BOOK_FIELDS.description} ${BOOK_FIELDS.description}\"\n    \"${BOOK_FIELDS.genres} ${BOOK_FIELDS.read_next}\"\n    \"${BOOK_FIELDS.rating} ${BOOK_FIELDS.date_read} \"\n    \"${BOOK_FIELDS.image_url} ${BOOK_FIELDS.published}\"\n    \"${BOOK_FIELDS.google_id} ${BOOK_FIELDS.goodreads_book_id}\"\n    \"${BOOK_FIELDS.series} ${BOOK_FIELDS.series_position}\"\n    \"${BOOK_FIELDS.my_review} ${BOOK_FIELDS.my_review}\"\n    \"${BOOK_FIELDS.notes} ${BOOK_FIELDS.notes}\";\n  gap: 20px 10px;\n  margin: 10px;\n`;\n\nconst ButtonFlexDiv = styled.div`\n  display: flex;\n  justify-content: flex-end;\n`;\n\nexport const AddBook = ({\n                            books,\n                            setBooks,\n                            authors,\n                            setAuthors,\n                            genres,\n                            setGenres,\n                            types,\n                            setTypes,\n                            getBooks,\n                            getAuthors,\n                            getGenres,\n                            getTypes,\n\n                            bookData,\n                            onClose,\n                            setAddedSnackbar\n                        }) => {\n\n    const {\n        handleSubmit,\n        control,\n        getValues,\n        setValue,\n        formState: {\n            isDirty\n        },\n        watch\n    } = useForm({\n        resolver: yupResolver(YUP_SCHEMA),\n        defaultValues: isEmpty(bookData) ? DEFAULT_BOOK_VALUES : transformFromServer(bookData, {\n            authors,\n            genres,\n            types\n        }),\n        mode: 'onTouched',\n    });\n\n    const [errorSnackbar, setErrorSnackbar] = useState(false);\n    const [saveDialog, setSaveDialog] = useState(false);\n    const [infoDialog, setInfoDialog] = useState(false);\n\n    const setError = useAsyncError();\n\n    const sortedGenres = genres.map(e => mapGenres(e, genres)).sort((a, b) => a.fullName.localeCompare(b.fullName))\n\n    const onSubmit = handleSubmit(\n        data => {\n            if (!isDirty ||\n                /*Untouched form, guaranteed no changes*/\n\n                /*Editing book, no actual changes made*/\n                (!isEmpty(bookData) && isBookDataEqual(bookData, transformToServer(data)))) {\n                setAddedSnackbar({message: 'No changes were detected'});\n                onClose();\n                return\n            }\n\n            let transformedData = transformToServer(data);\n\n            if (isEmpty(bookData) || !('id' in bookData)) {\n                /*User is adding book*/\n                Url.addBook(transformedData)\n                    .then(() => {\n                        getBooks();\n                        setAddedSnackbar({message: 'Book added'});\n                        onClose()\n                    })\n                    .catch(setError);\n            } else {\n                /* Changes were made in editing book*/\n                Url.updateBook(transformedData, bookData['id'])\n                    .then(() => {\n                        getBooks();\n                        setAddedSnackbar({message: 'Changes saved'});\n                        onClose()\n                    })\n                    .catch(setError);\n            }\n        },\n        () => {\n            setErrorSnackbar(true)\n        });\n\n\n    const handleDiscard = () => isDirty ?\n        setSaveDialog(true) :\n        onClose(); //Untouched form\n\n\n    const footer = <ButtonFlexDiv>\n        <IconButton\n            tabIndex={-1}\n            onClick={() => setInfoDialog(true)}>\n            <InfoOutlinedIcon/>\n        </IconButton>\n        <Button onClick={handleDiscard}>Discard</Button>\n        <Button onClick={onSubmit} color={'primary'}> Save </Button>\n    </ButtonFlexDiv>;\n\n    const StandardField = useCallback(({Component, name, label, getComponentProps = () => ({}), ...props}) =>\n        <Controller\n            control={control}\n            name={name}\n            render={controllerProps => {\n                const {field: {ref, ...field}, fieldState: {error}} = controllerProps\n                return <Component\n                    error={Boolean(error)}\n                    label={label}\n                    helperText={error?.message}\n                    size={'small'}\n                    style={{gridArea: field.name}}\n                    variant={'outlined'}\n                    {...props}\n                    {...field}\n                    {...getComponentProps({...controllerProps, name, label})}/>\n            }}/>, [control])\n\n    return <>\n        <Dialog\n            open={saveDialog}\n            onClose={() => setSaveDialog(false)}>\n            <DialogTitle>Discard changes?</DialogTitle>\n            <DialogActions>\n                <Button onClick={() => {\n                    setAddedSnackbar({message: 'Changes discarded'});\n                    onClose()\n                }}> Discard </Button>\n                <Button onClick={() => setSaveDialog(false)} color={'primary'}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <Dialog\n            open={infoDialog}\n            onClose={() => setInfoDialog(false)}>\n            <DialogTitle>Notes on fields</DialogTitle>\n            <DialogContent>\n                <DialogContentText component={'div'}>\n                    Series:\n                    <ul>\n                        <li>For new ones I wish to read, just store the first book.</li>\n                        <li>If I like it, add just the next book (read_next=true)</li>\n                        <li>As I complete each book in the series, it is added.</li>\n                        <li>If I don't like it halfway, I don't add any further books (i.e. the series is left\n                            hanging)\n                        </li>\n                        <li>Series which I have completed should have all books added.</li>\n                    </ul>\n\n                    Authors with many works:\n                    <ul>\n                        <li>The anthology is listed, if I plan to read it</li>\n                        <li>All works I have read/wish to read are also listed.</li>\n                        <li>I could also make comments in the author object's notes.</li>\n                    </ul>\n\n                    Unknown read date\n                    <ul>\n                        <li>put as 01/01/2000</li>\n                    </ul>\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button\n                    onClick={() => setInfoDialog(false)}>\n                    Close\n                </Button>\n            </DialogActions>\n\n        </Dialog>\n        <Snackbar\n            open={errorSnackbar}\n            onClose={() => setErrorSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                severity={'error'}\n                onClose={() => setErrorSnackbar(false)}>\n                Check errors before submitting\n            </Alert>\n        </Snackbar>\n        <DialogBlurResponsive\n            open\n            footer={footer}\n            disableBackdropClick\n            onBackdropClick={handleDiscard}>\n            <FieldContainer>\n\n                <StandardField\n                    name={BOOK_FIELDS.title}\n                    label={'Title'}\n                    Component={TextFieldMultilineEllipsis}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.authors}\n                    label={'Authors'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={e => Url.addAuthor({name: e})}\n                    filterSelectedOptions\n                    getComponentProps={({field: {name}, fieldState: {error}, label}) => ({\n                        getValue: () => getValues(name),\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error ? 'Creating author(s)...' : null\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptions={getAuthors}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    multiple={true}\n                    options={authors}\n                />\n\n                <StandardField\n                    name={BOOK_FIELDS.type}\n                    label={'Type'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={e => Url.addType({name: e})}\n                    filterSelectedOptions\n                    getComponentProps={({fieldState: {error}, label}) => ({\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error?.message\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptions={getTypes}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    maxOptionsToShow={0}\n                    multiple={false}\n                    options={types}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.description}\n                    label={'Description'}\n                    Component={TextFieldMultilineEllipsis}/>\n\n                {/*todo Very hacky. Write this better*/}\n                <StandardField\n                    name={BOOK_FIELDS.genres}\n                    label={'Genres'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={e => Url.addGenre({name: e})}\n                    filterSelectedOptions\n                    getComponentProps={({field: {name}, fieldState: {error}, label}) => ({\n                        getValue: () => getValues(name),\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error ? 'Creating genre(s)...' : null\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptions={getGenres}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    groupBy={e => e.ancestors?.length ? e.ancestors.join(' > ') : ''}\n                    maxOptionsToShow={0}\n                    multiple={true}\n                    options={sortedGenres}\n                    renderOption={e => e.ancestors?.length ?\n                        <Typography style={{marginLeft: '20px'}}>{e.name}</Typography> : (e.name || `Add '${e._name}'`)}\n\n                />\n\n                <Controller\n                    name={BOOK_FIELDS.read_next}\n                    control={control}\n                    render={({\n                                 field: {onChange, value, ...field},\n                                 fieldState: {error},\n                             }) => <>\n                        <FormControlLabel\n                            {...field}\n                            checked={value}\n                            control={<Checkbox/>}\n                            label={'Read next?'}\n                            labelPlacement={'end'}\n                            onChange={e => {\n                                setValue(BOOK_FIELDS.date_read, DEFAULT_BOOK_VALUES[BOOK_FIELDS.date_read])\n                                onChange(e)\n                            }}\n                            style={{gridArea: field.name}}\n                        />\n                        <FormHelperText\n                            error={Boolean(error)}>\n                            {error?.message}\n                        </FormHelperText>\n                    </>}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.rating}\n                    label={'Rating'}\n                    Component={TextFieldClearable}/>\n\n                <MuiPickersUtilsProvider utils={DateFns}>\n                    <StandardField\n                        name={BOOK_FIELDS.date_read}\n                        label={'Date Read'}\n                        Component={KeyboardDatePicker}\n\n                        autoOk\n                        disabled={watch(BOOK_FIELDS.read_next)}\n                        disableFuture\n                        format={'dd/MM/yyyy'}\n                        placeholder={'dd/mm/yyyy'}\n                        inputVariant={'outlined'}\n                    />\n\n                </MuiPickersUtilsProvider>\n\n                <StandardField\n                    name={BOOK_FIELDS.image_url}\n                    label={'Image URL'}\n                    Component={TextFieldClearable}\n                    type={'url'}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.published}\n                    label={'Year Published'}\n                    Component={TextFieldClearable}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.google_id}\n                    label={'Google ID'}\n                    Component={TextFieldClearable}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.goodreads_book_id}\n                    label={'Goodreads ID'}\n                    Component={TextFieldClearable}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.series}\n                    label={'Series Name'}\n                    Component={TextFieldClearable}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.series_position}\n                    label={'Series Position'}\n                    Component={TextFieldClearable}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.my_review}\n                    label={'My Review'}\n                    Component={TextFieldMultilineEllipsis}\n                    placeholder={'Not good, read others, highlight specific chapters, etc'}/>\n\n                <StandardField\n                    name={BOOK_FIELDS.notes}\n                    label={'Notes'}\n                    Component={TextFieldMultilineEllipsis}\n                    placeholder={'Specific edition, comments on metadata, somebody recommended me, want to buy etc'}/>\n\n            </FieldContainer>\n        </DialogBlurResponsive>\n    </>\n};\n","import styled from \"styled-components\";\nimport {capitalize} from \"lodash\"\nimport {Button, Card, CardActionArea, CardActions, CardContent, CircularProgress, Typography} from \"@material-ui/core\";\nimport {useEffect, useState} from \"react\";\n\n\nconst StyledCard = styled(Card)`\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst StyledCardContent = styled(CardContent)`\n  height: 100%;\n`;\n\nconst Description = styled(CardContent)`\n  display: ${({$empty}) => $empty ? 'flex': 'block'};\n  justify-content: center;\n  align-items: center;\n  overflow-y: auto;\n  height: ${({$maxHeight}) => `${$maxHeight}px` || 'initial'};\n`;\n\nconst StyledActionArea = styled(CardActionArea)`\n  height: 100%;\n`;\n\nconst Image = styled.img`\n  height: 200px;\n`\n\nconst ImageContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 10px 0;\n  height: 200px;\n`;\nconst Title = styled(Typography)`\n  line-height: 1rem;\n`;\n\nconst Authors = styled(Typography)`\n  font-style: italic;\n`;\n\nexport const BookResult = ({idx, onSearchResultClick, result, searchLoading}) => {\n    let {authors=[], from, image_url, published, title, description} = result;\n\n    const [detailView, setDetailView] = useState(false);\n    const [maxHeight, setMaxHeight] = useState();\n    const [loading, setLoading] = useState(false);\n\n    const onClick = () => {\n        setLoading(true);\n        onSearchResultClick(result)\n    };\n\n    useEffect(() => void setDetailView(false), [result]);\n\n    return <StyledCard key={idx}>\n        <StyledActionArea onClick={() => setDetailView(!detailView)}>\n            {detailView ?\n                <Description $maxHeight={maxHeight} $empty={!Boolean(description)}>\n                    <Typography variant={'body2'}>{description ? description : 'No description provided'}</Typography>\n                </Description> :\n                <StyledCardContent ref={ref => ref && setMaxHeight(ref.offsetHeight)}>\n                    <Typography align={'right'} color={'textSecondary'} variant={'body2'}>{capitalize(from)}</Typography>\n                    <ImageContainer>{image_url ? <Image src={image_url} alt={''}/> : <Typography variant={'body2'}>No cover</Typography>}</ImageContainer>\n                    <Title align={'center'} variant={'subtitle2'}>{title} {published ? `(${published})` : null}</Title>\n                    <Authors align={'center'} variant={'body2'}>{authors.length ? authors.reduce((acc, cur) => acc + `, ${cur}`) : ''}</Authors>\n                </StyledCardContent>}\n        </StyledActionArea>\n        <CardActions>\n            <Button onClick={onClick} disabled={searchLoading}>Select</Button>\n            {loading && <CircularProgress size={20}/>}\n        </CardActions>\n    </StyledCard>\n};\n","import {BookResult} from \"./BookResult\";\nimport styled from \"styled-components\";\nimport {Button, CircularProgress, TextField} from \"@material-ui/core\";\nimport {Networking} from \"../../util/networking\";\nimport * as Url from \"./urls\";\nimport {useState} from \"react\";\nimport {DialogBlurResponsive} from \"../../shared/dialogBlurResponsive\";\nimport SearchIcon from '@material-ui/icons/Search';\nimport {Autocomplete} from \"@material-ui/lab\";\nimport {matchSorter} from \"match-sorter\";\n\nconst BookResults = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  grid-auto-rows: 1fr;\n  gap: 10px 10px;\n  margin: 10px 0;\n`;\n\nconst StyledForm = styled.form`\n  padding: 10px 0;\n`;\n\nconst Footer = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nexport const SearchBooks = ({books, closeSearch, handleSearch, setBookData}) => {\n\n    const [loading, setLoading] = useState(false);\n    const [results, setResults] = useState(null);\n\n    const onSearch = event => {\n        event.preventDefault();\n        setResults(null);\n        setLoading(true);\n        let query = event.target.elements.search.value;\n        Networking.send(`${Url.SEARCH}?q=${query}`, {method: 'GET'})\n            .then(resp => resp.json())\n            .then(json => {\n                setResults(json.results);\n                setLoading(false)\n            });\n    };\n\n    const onSearchResultClick = result => {\n        setLoading(true);\n        handleSearch(result)\n            .then(r => {\n                setBookData(r);\n                closeSearch()\n            })\n    };\n\n    const footer = <Footer>\n        <Button\n            onClick={() => {\n                setBookData({});\n                closeSearch()\n            }}>\n            Add manually\n        </Button>\n        <Button\n            onClick={closeSearch}\n            color={'primary'}>\n            Close\n        </Button>\n    </Footer>;\n\n    return <>\n        <DialogBlurResponsive\n            open\n            onClose={closeSearch}\n            footer={footer}>\n            <StyledForm onSubmit={onSearch}>\n                <Autocomplete\n                    autoComplete\n                    filterSelectedOptions\n                    filterOptions={(options, state) => state.inputValue ?\n                        matchSorter(options, state.inputValue.trim()).slice(0, 3) : []}\n                    freeSolo\n                    options={books.map(e => e.title)}\n                    renderInput={params => <TextField\n                        {...params}\n                        autoFocus\n                        disabled={loading}\n                        fullWidth\n                        InputProps={{\n                            ...params.InputProps,\n                            startAdornment: <SearchIcon/>,\n                            endAdornment: <>\n                                {loading && <CircularProgress size={25}/>}\n                                {params.InputProps.endAdornment}\n                            </>\n                        }}\n                        label={'Search'}\n                        name={'search'}\n                        variant={'outlined'}\n                    />}\n                />\n            </StyledForm>\n            {results && <BookResults>\n                {results.map((result, idx) => {\n                    return <BookResult\n                        result={result}\n                        onSearchResultClick={onSearchResultClick}\n                        searchLoading={loading}\n                        idx={idx}\n                    />\n                })}\n            </BookResults>}\n        </DialogBlurResponsive>\n    </>\n};","//Books in a series should be collapsible\nimport {useMemo, useState} from 'react';\nimport {Checkbox, Fab, FormControlLabel, Snackbar, TableContainer, TextField} from \"@material-ui/core\";\nimport styled from 'styled-components'\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport {AddBook} from \"./AddBook\";\nimport {isBefore, parseISO, subMonths, subWeeks, subYears} from 'date-fns'\nimport {Alert, Autocomplete} from \"@material-ui/lab\";\nimport * as Url from './urls'\nimport {getGoodreadsBookInfo, getGoogleBookInfo} from './urls'\nimport {formatDistanceToNowPretty, sanitizeString} from \"../../util/util\";\nimport {matchSorter} from \"match-sorter\";\nimport {BOOK_FIELDS, DEFAULT_BOOK_VALUES} from \"./schema\";\nimport {Waypoint} from 'react-waypoint';\nimport {ThemeProvider, unstable_createMuiStrictModeTheme as createMuiTheme} from '@material-ui/core/styles'; //todo replace with v5 when out\nimport MUIDataTable, {debounceSearchRender} from \"mui-datatables\";\nimport {SearchBooks} from \"./searchBooks\";\nimport {mergeWith} from \"lodash\";\nimport ErrorOutlineOutlinedIcon from '@material-ui/icons/ErrorOutlineOutlined';\n\n\nconst StyledTableContainer = styled(TableContainer)`\n  ${BACKGROUND_COLOR};\n`;\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\nconst BOOK_COLUMN_STATE = 'BOOK_COLUMN_STATE';\n\nconst DEFAULT_COLUMN_STATES = {\n    [BOOK_FIELDS.image_url]: true,\n    [BOOK_FIELDS.title]: true,\n    [BOOK_FIELDS.authors]: true,\n    [BOOK_FIELDS.genres]: true,\n};\n\nexport const Books = ({\n                          getBooks,\n                          books,\n                          setBooks,\n                          authors,\n                          setAuthors,\n                          genres,\n                          setGenres,\n                          types,\n                          setTypes,\n                          getAuthors,\n                          getGenres,\n                          getTypes\n                      }) => {\n    const [searchBookOpen, setSearchBookOpen] = useState(false);\n    const [bookData, setBookData] = useState(null);\n    const [addedSnackbar, setAddedSnackbar] = useState(null);\n    const [filteredItemsLength, setFilteredItemsLength] = useState(books.length);\n    const [count, setCount] = useState(10);\n\n    const getColumnState = column => localStorage.getItem(BOOK_COLUMN_STATE) ?\n        JSON.parse(localStorage.getItem(BOOK_COLUMN_STATE))[column] :\n        DEFAULT_COLUMN_STATES[column];\n\n    const setColumnState = (column, state) => {\n        let columnState = localStorage.getItem(BOOK_COLUMN_STATE)\n\n        let parsedColumnState = columnState ? JSON.parse(columnState) : DEFAULT_COLUMN_STATES;\n        localStorage.setItem(BOOK_COLUMN_STATE, JSON.stringify({\n            ...parsedColumnState,\n            [column]: state\n        }));\n    };\n\n    const dateOptions = useMemo(() => [\n        {\n            name: 'All',\n            date: new Date(0),\n        },\n        {\n            name: 'Last week',\n            date: subWeeks(new Date(), 1)\n        },\n        {\n            name: 'Last month',\n            date: subMonths(new Date(), 1)\n        },\n        {\n            name: 'Last year',\n            date: subYears(new Date(), 1)\n        }\n    ], [])\n\n    /*Get book description from results\n    * todo Note: Goodreads is getting deprecated...*/\n    const handleSearch = result => {\n        let type = result.from;\n        let request;\n        if (type === 'google') {\n            // Use ISBN_13 if available, otherwise ISBN_10\n            request = getGoogleBookInfo(result.ISBN_13 || result.ISBN_10)\n        } else {\n            request = getGoodreadsBookInfo(result.goodreads_work_id, result.goodreads_book_id)\n        }\n        return request.then(r => {\n            let mergedResult = mergeWith({}, result, r,\n                //preferentially choose srcVal over existing values if both present\n                (objVal, srcVal) => srcVal || objVal);\n\n            let authorsToAdd = []; // [] of {id, name, notes}\n            let authorsToCreate = []; // [] of String\n\n            mergedResult.authors.forEach(e => {\n                let val = authors.find(author => sanitizeString(author.name) === sanitizeString(e));\n                if (val) {\n                    // Author already exists\n                    authorsToAdd.push(val)\n                } else {\n                    // Author doesn't exist, to create\n                    authorsToCreate.push(e)\n                }\n            });\n\n            let bookResult = Object.assign({}, DEFAULT_BOOK_VALUES);\n\n            [\n                BOOK_FIELDS.description,\n                BOOK_FIELDS.google_id,\n                BOOK_FIELDS.goodreads_book_id,\n                BOOK_FIELDS.image_url,\n                BOOK_FIELDS.published,\n                BOOK_FIELDS.title,\n                BOOK_FIELDS.series,\n                BOOK_FIELDS.series_position\n            ].forEach(e => mergedResult[e] && (bookResult[e] = mergedResult[e]));\n\n            return Promise\n                .all(authorsToCreate.map(name => Url.addAuthor({name: name})))\n                .then(r => {\n                    bookResult[BOOK_FIELDS.authors] = [...authorsToAdd, ...r].map(e => e.id);\n                    return getAuthors().then(() => bookResult);\n                });\n\n        });\n    };\n\n    const columns = useMemo(() => [\n        {\n            label: 'Cover',\n            name: BOOK_FIELDS.image_url,\n            options: {\n                filter: false,\n                searchable: false,\n                sort: false,\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.image_url] ?\n                    <img alt={''} src={books[dataIndex][BOOK_FIELDS.image_url]} style={{maxHeight: '80px'}}/> : null,\n            },\n        },\n        {\n            label: 'Title',\n            name: BOOK_FIELDS.title,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Authors',\n            name: BOOK_FIELDS.authors,\n            options: {\n                customBodyRenderLite: dataIndex =>\n                    books[dataIndex][BOOK_FIELDS.authors]\n                        .map(id => authors.find(authors => authors.id === id)?.name)\n                        .join(', '),\n                customFilterListOptions: {\n                    render: val => val.map(e => `Author: ${e.name}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => el.includes(e.id)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options,\n                                    state.inputValue,\n                                    {keys: ['name']}\n                                ).slice(0, 10)}\n                            getOptionLabel={option => option.name}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={authors}\n                            renderInput={params => <TextField {...params} label={'Author'}/>}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Genres',\n            name: BOOK_FIELDS.genres,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.genres]\n                    .map(id => genres.find(genres => genres.id === id)?.name).join(', '),\n                customFilterListOptions: {\n                    render: val => val.map(e => `Genre: ${e.name}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => el.includes(e.id)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options,\n                                    state.inputValue,\n                                    {keys: ['name']}\n                                )}\n                            getOptionLabel={option => option.name}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={genres}\n                            renderInput={params => <TextField {...params} label={'Genre'}/>}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Type',\n            name: BOOK_FIELDS.type,\n            options: {\n                customBodyRenderLite: dataIndex => types.find(type => type.id === books[dataIndex][BOOK_FIELDS.type])?.name,\n                customFilterListOptions: {\n                    render: v => `Type: ${types.find(type => type.id === v).name}`\n                },\n                filterOptions: {\n                    renderValue: v => types.find(type => type.id === v).name,\n                },\n                filterType: 'multiselect',\n            }\n        },\n        {\n            label: 'Description',\n            name: BOOK_FIELDS.description,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Date added',\n            name: 'date_added', // date_added is not in BOOK_FIELDS\n            options: {\n                customBodyRenderLite: dataIndex => formatDistanceToNowPretty(parseISO(books[dataIndex].date_added)), // date_added is not in BOOK_FIELDS\n                customFilterListOptions: {\n                    render: v => `Date Added: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && isBefore(parseISO(el), filters[0].date),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Date Added'}/>}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        },\n        {\n            label: 'Read Next',\n            name: BOOK_FIELDS.read_next,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.read_next] ?\n                    <ErrorOutlineOutlinedIcon color={'secondary'}/> : '',\n                customFilterListOptions: {\n                    render: () => 'Read Next'\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !el,\n                    display: (filterList, onChange, index, column) =>\n                        <FormControlLabel\n                            control={<Checkbox\n                                checked={Boolean(filterList[index][0])}\n                                onChange={e => onChange(e.target.checked ? [true] : [], index, column)}\n                            />}\n                            label={'Read Next'}/>\n                },\n                filterType: 'custom',\n                searchable: false,\n            }\n        },\n        {\n            label: 'Date Read',\n            name: BOOK_FIELDS.date_read,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.date_read] ?\n                    formatDistanceToNowPretty(parseISO(books[dataIndex][BOOK_FIELDS.date_read])) : '',\n                customFilterListOptions: {\n                    render: v => `Date Read: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && (isBefore(parseISO(el), filters[0].date) || !Boolean(el)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Date Read'}/>}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        },\n\n        {\n            label: 'Published',\n            name: BOOK_FIELDS.published,\n            options: {\n                filter: false,\n                sortDescFirst: true\n            },\n        },\n        {\n            label: 'Series',\n            name: BOOK_FIELDS.series,\n            options: {\n                customBodyRenderLite: dataIndex => {\n                    let row = books[dataIndex];\n                    return row[BOOK_FIELDS.series] ? `${row[BOOK_FIELDS.series]} #${row[BOOK_FIELDS.series_position]}` : ''\n                },\n                customFilterListOptions: {\n                    render: v => v.map(e => `Series: ${e}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => e === el),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options, state.inputValue,)}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={[...new Set(books.map(e => e[BOOK_FIELDS.series]).filter(e => Boolean(e)))]}\n                            renderInput={params => <TextField {...params} label={'Series'}/>}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Rating',\n            name: BOOK_FIELDS.rating,\n            options: {\n                searchable: false,\n            }\n        },\n        {\n            label: 'My Review',\n            name: BOOK_FIELDS.my_review,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Notes',\n            name: BOOK_FIELDS.notes,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Updated',\n            name: 'updated',\n            options: {\n                customBodyRenderLite: dataIndex => formatDistanceToNowPretty(parseISO(books[dataIndex].updated)),\n                customFilterListOptions: {\n                    render: v => `Updated: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && isBefore(parseISO(el), filters[0].date),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Updated'}/>}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        }\n    ].map(e => ({\n        ...e,\n        options: {\n            ...e.options,\n            display: getColumnState(e.name),\n            sortThirdClickReset: true,\n        }\n    })), [authors, books, dateOptions, genres, types]);\n\n    const options = useMemo(() => ({\n        count: count,\n        customFooter: () =>\n            <Waypoint\n                bottomOffset={-400}\n                onEnter={() => setCount(row => row + 10)}\n                scrollableAncestor={window}\n            >\n                <tfoot/>\n            </Waypoint>,\n        customSearchRender: debounceSearchRender(200),\n        draggableColumns: {\n            enabled: true,\n        },\n        onFilterChange: () => setCount(20),\n        onRowClick: (rowData, {dataIndex}) =>\n            setBookData(books[dataIndex]),\n        onRowsDelete: (rowsDeleted, data, newTableData) => {\n            Promise.all(rowsDeleted.data.map(e => Url.deleteBook(books[e.dataIndex].id)))\n                .then(getBooks)\n        },\n        onTableChange: (action, tableState) => setFilteredItemsLength(tableState.displayData.length),\n        onViewColumnsChange: (changedColumn, action) => action === 'add' ?\n            setColumnState(changedColumn, true) :\n            setColumnState(changedColumn, false),\n        pagination: false,\n        responsive: 'simple',\n        setTableProps: () => ({\n            padding: 'none',\n            size: 'small',\n        }),\n        searchPlaceholder: `Search ${filteredItemsLength} items`,\n        tableBodyMaxHeight: '100%'\n    }), [books, filteredItemsLength, getBooks, count]);\n\n    return <>\n        <StyledFab color={'primary'} onClick={() => setSearchBookOpen(true)}>\n            <AddIcon/>\n        </StyledFab>\n        {bookData && <AddBook\n            getBooks={getBooks}\n            books={books}\n            setBooks={setBooks}\n            authors={authors}\n            setAuthors={setAuthors}\n            genres={genres}\n            setGenres={setGenres}\n            types={types}\n            setTypes={setTypes}\n            getAuthors={getAuthors}\n            getGenres={getGenres}\n            getTypes={getTypes}\n\n            bookData={bookData}\n            onClose={() => setBookData(null)}\n            setAddedSnackbar={setAddedSnackbar}\n        />}\n        {searchBookOpen && <SearchBooks\n            books={books}\n            closeSearch={() => setSearchBookOpen(false)}\n            handleSearch={handleSearch}\n            setBookData={setBookData}\n        />}\n        <Snackbar\n            open={Boolean(addedSnackbar)}\n            onClose={() => setAddedSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                severity={'success'}\n                onClose={() => setAddedSnackbar(false)}>\n                {addedSnackbar?.message}\n            </Alert>\n        </Snackbar>\n        <StyledTableContainer>\n            <ThemeProvider theme={theme => createMuiTheme({\n                ...theme,\n                overrides: {\n                    MUIDataTable: {\n                        paper: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MUIDataTableHeadCell: {\n                        fixedHeader: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MUIDataTableSelectCell: {\n                        headerCell: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MuiGrid: {},\n                    MUIDataTableToolbar: {\n                        filterPaper: {\n                            maxWidth: 'calc(100% - 32px) !important',\n                        }\n                    }\n                }\n            })}>\n\n                <MUIDataTable\n                    columns={columns}\n                    data={books}\n                    options={options}\n                    title={`${filteredItemsLength} items`}\n                />\n            </ThemeProvider>\n        </StyledTableContainer>\n    </>\n\n};\n","import {DialogBlurResponsive} from \"../../shared/dialogBlurResponsive\";\nimport React from \"react\";\nimport {Button, TextField} from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport {Controller, useForm} from \"react-hook-form\";\n\nconst FormContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n`;\n\nconst StyledFooter = styled.div`\n  display: flex;\n  align-content: flex-end;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 10px 0;\n`;\n\nconst StyledDiv = styled.div`\n  flex: 1\n`;\n\nexport const GenericAddDeleteCreateDialog = ({\n                                                 onClose,\n                                                 onSubmit,\n                                                 editingItem: {id, name, notes}\n                                             }) => {\n\n    const {\n        control,\n        handleSubmit\n    } = useForm({\n        defaultValues: {\n            name,\n            notes,\n        }\n    });\n\n    const footer = <StyledFooter>\n        <StyledDiv/>\n        <Button onClick={() => handleSubmit(data => onSubmit(data, id))()\n        }>Submit</Button>\n    </StyledFooter>;\n\n    return <DialogBlurResponsive\n        open\n        onClose={onClose}\n        footer={footer}>\n\n        <FormContainer>\n\n            <Controller\n                name={'name'}\n                control={control}\n                render={({field: {ref, ...field}}) =>\n                    <StyledTextField\n                        {...field}\n                        label={'Name'}\n                        variant={'outlined'}/>}/>\n\n            <Controller\n                name={'notes'}\n                control={control}\n                render={({field: {ref, ...field}}) =>\n                    <StyledTextField\n                        {...field}\n                        label={'Notes'}\n                        variant={'outlined'}/>}/>\n\n        </FormContainer>\n\n    </DialogBlurResponsive>\n};","import {Fab, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText} from \"@material-ui/core\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport React, {useState} from 'react'\nimport styled from 'styled-components'\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport {GenericAddDeleteCreateDialog} from \"./genericAddDeleteCreateDialog\";\n\nconst StyledList = styled(List)`\n  max-width: 600px;\n  ${BACKGROUND_COLOR};\n`;\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\n\n/*Generic CRUD display for Authors/Genres/Types (for now)\n* Assumes keys id, name and notes are present on the object*/\nexport const GenericAddDeleteCreate = ({\n                                           types,\n                                           getType,\n                                           addType,\n                                           updateType,\n                                           deleteType,\n                                       }) => {\n    const [editingItem, setEditingItem] = useState(false);\n\n    const onDelete = id => deleteType(id).then(getType);\n\n    const onClose = () => setEditingItem(null);\n\n\n    const onClickItem = item => setEditingItem(item);\n\n    const onSubmit = (data, id) => {\n        if (id) {\n            // Editing item\n            updateType(data, id).then(getType);\n            setEditingItem(null)\n        } else {\n            // Adding item\n            addType(data).then(getType);\n            setEditingItem(null)\n        }\n    };\n\n\n    return <>\n        <StyledFab color={'primary'} onClick={() => setEditingItem(true)}>\n            <AddIcon/>\n        </StyledFab>\n        {editingItem && <GenericAddDeleteCreateDialog\n            editingItem={editingItem}\n            onClose={onClose}\n            onSubmit={onSubmit}\n        />}\n        <StyledList>\n            {types.map(item => <ListItem\n                button\n                key={item.id}\n                onClick={() => onClickItem(item)}\n            >\n                <ListItemText\n                    primary={item.name}\n                    secondary={item.notes}\n                />\n                <ListItemSecondaryAction>\n                    <IconButton onClick={() => onDelete(item.id)}>\n                        <DeleteIcon/>\n                    </IconButton>\n                </ListItemSecondaryAction>\n            </ListItem>)}\n        </StyledList>\n    </>\n};","import {DialogBlurResponsive} from \"../../shared/dialogBlurResponsive\";\nimport React, {useState} from \"react\";\nimport {Button, Dialog, DialogActions, DialogTitle, TextField, Typography} from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport {Controller, useForm} from \"react-hook-form\";\nimport {Autocomplete} from \"@material-ui/lab\";\nimport {mapGenres} from \"./utils\";\n\nconst FormContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n`;\n\nconst StyledFooter = styled.div`\n  display: flex;\n  align-content: flex-end;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 10px 0;\n`;\n\nconst StyledDiv = styled.div`\n  flex: 1\n`;\n/*Todo consider using 'genres' as an object instead of array for improved performance*/\nexport const GenreDialog = ({\n                                onDelete,\n                                genres,\n                                onClose,\n                                onSubmit,\n                                editingItem: {id, name, notes, parent}\n                            }) => {\n\n    const [saveDialog, setSaveDialog] = useState(false)\n    const [deleteDialog, setDeleteDialog] = useState(false)\n\n    let genresWithNull = [\n        {\n            ancestors: [],\n            fullName: '<Top Level>',\n            id: null,\n            name: '<Top Level>',\n            parent: null\n        },\n        ...genres.map(e => mapGenres(e, genres)),\n    ]\n\n    genresWithNull.sort((a, b) => a.fullName.localeCompare(b.fullName))\n\n    const {\n        control,\n        handleSubmit,\n        formState: {\n            isDirty\n        },\n    } = useForm({\n        defaultValues: {\n            name,\n            notes,\n            parent: genresWithNull.find(e => e.id === parent) || genresWithNull[0],\n        }\n    });\n\n    const onCloseCheckDirty = () => isDirty ? setSaveDialog(true) : onClose()\n\n    const parseData = ({parent, ...data}) => ({parent: parent.id, ...data})\n\n    const footer = <StyledFooter>\n        <StyledDiv/>\n        {id && <Button onClick={() => setDeleteDialog(true)}>Delete</Button>}\n        <Button onClick={() => handleSubmit(data => onSubmit(parseData(data), id))()}>\n            Submit</Button>\n    </StyledFooter>;\n\n\n    return <>\n        <Dialog\n            open={saveDialog}\n            onClose={() => setSaveDialog(false)}>\n            <DialogTitle>Discard changes?</DialogTitle>\n            <DialogActions>\n                <Button onClick={() => onClose()}>Discard</Button>\n                <Button onClick={() => setSaveDialog(false)} color={'primary'}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <Dialog\n            open={deleteDialog}\n            onClose={() => setDeleteDialog(false)}>\n            <DialogTitle>Delete '{name}'?</DialogTitle>\n            <DialogActions>\n                <Button onClick={() => {\n                    onDelete(id)\n                    onClose()\n                }}>Delete</Button>\n                <Button onClick={() => setDeleteDialog(false)} color={'primary'}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <DialogBlurResponsive\n            open\n            onClose={onCloseCheckDirty}\n            footer={footer}>\n\n            <FormContainer>\n\n                <Controller\n                    name={'name'}\n                    control={control}\n                    render={({field: {ref, ...field}}) =>\n                        <StyledTextField\n                            {...field}\n                            autoFocus\n                            label={'Name'}\n                            variant={'outlined'}/>}/>\n\n                <Controller\n                    name={'notes'}\n                    control={control}\n                    render={({field: {ref, ...field}}) =>\n                        <StyledTextField\n                            {...field}\n                            label={'Notes'}\n                            variant={'outlined'}/>}/>\n\n                <Controller\n                    name={'parent'}\n                    control={control}\n                    render={({field: {ref, onChange, ...field}}) =>\n                        <Autocomplete\n                            {...field}\n                            disableClearable\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.id === val.id}\n                            groupBy={e => e.ancestors.length ? e.ancestors.join(' > ') : ''}\n                            onChange={(event, value) => onChange(value)}\n                            options={genresWithNull}\n                            renderInput={params => <TextField label={'Parent'} {...params} variant={'outlined'}/>}\n                            renderOption={e => e.ancestors.length ?\n                                <Typography style={{marginLeft: '20px'}}>{e.name}</Typography> : e.name}\n                        />}/>\n\n            </FormContainer>\n\n        </DialogBlurResponsive>\n    </>\n};","import SortableTree from \"react-sortable-tree\";\nimport 'react-sortable-tree/style.css';\nimport styled from 'styled-components'\nimport {recursiveSort} from \"./utils\";\nimport React, {useCallback, useEffect, useState} from \"react\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport {\n    Button,\n    CircularProgress,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    Fab,\n    IconButton,\n    ListItem,\n    ListItemText\n} from \"@material-ui/core\";\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\nimport {GenreDialog} from \"./GenreDialog\";\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport NoteIcon from '@material-ui/icons/Note';\nimport {HTML5Backend} from \"react-dnd-html5-backend\";\nimport {DndProvider} from \"react-dnd\";\n\n\nconst StyledSortableTree = styled(SortableTree)`\n\n  .rst__lineHalfHorizontalRight::before,\n  .rst__lineFullVertical::after,\n  .rst__lineHalfVerticalTop::after,\n  .rst__lineHalfVerticalBottom::after,\n  .rst__lineChildren::after {\n    background-color: white;\n  }\n\n  .rst__rowContents {\n    background-color: transparent;\n    border: none;\n    box-shadow: none;\n  }\n\n  .rst__moveHandle {\n    width: 20px;\n    border: none;\n    box-shadow: none;\n    background-color: transparent;\n  }\n`\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\n\nconst Container = styled.div`\n  ${BACKGROUND_COLOR};\n`\n\nexport const NumberCircle = styled.span`\n  margin: auto 5px;\n  border: 2px solid rgba(255, 255, 255, 0.4);\n  padding: 3px;\n  border-radius: 20%;\n  font-weight: lighter;\n`\n\nexport const Genres = ({\n                           books,\n                           genres,\n                           getGenres,\n                           addGenre,\n                           updateGenre,\n                           deleteGenre,\n                           setTitleEndAdornment,\n                       }) => {\n\n    const [treeState, setTreeState] = useState([])\n    const [editingItem, setEditingItem] = useState(false);\n    const [genreInfoDialogOpen, setGenreInfoDialogOpen] = useState(false);\n    const [loading, setLoading] = useState(false);\n\n\n    const onChange = useCallback(_genres => setTreeState(recursiveSort(getTreeDataFromGenres(_genres, books), (a, b) => a.name.localeCompare(b.name))), [books])\n    const onDelete = id => {\n        setLoading(true)\n        deleteGenre(id)\n            .then(getGenres)\n            .then(() => setLoading(false));\n    }\n    const onClose = () => setEditingItem(null);\n    const onSubmit = (data, id) => {\n        if (id) {\n            // Editing item\n            setLoading(true)\n            updateGenre(data, id)\n                .then(getGenres)\n                .then(() => setLoading(false));\n            setEditingItem(null)\n        } else {\n            // Adding item\n            setLoading(true)\n            addGenre(data)\n                .then(getGenres)\n                .then(() => setLoading(false));\n            setEditingItem(null)\n        }\n    };\n\n    /*Will also get book counts for each genre, with each parent's including the sum of their children*/\n    const getTreeDataFromGenres = (genres, books) => {\n        let genreMap = new Map()\n        let root = []\n        let bookCountForGenre = {}\n\n        /*Get count of books for each genre*/\n        books.forEach(e => e.genres.forEach(id =>\n            id in bookCountForGenre ?\n                bookCountForGenre[id] += 1 :\n                bookCountForGenre[id] = 1))\n\n        /*Clone genres, add React-Sortable-Tree specific props*/\n        genres.forEach(e => genreMap.set(e.id, {\n            ...e,\n            expanded: true,\n            children: [],\n            bookCount: bookCountForGenre[e.id] ?? 0,\n            title: ({node}) => <ListItem\n                disableGutters\n                dense\n                onClick={() => setEditingItem(node)}\n                button>\n                <NumberCircle>{node.bookCount}</NumberCircle>\n                <ListItemText primary={`${node.name}`}/>\n                {node.notes &&\n                <NoteIcon/>}\n            </ListItem>\n        }))\n\n        let addCount = (v, numToAdd) => {\n            if (!v.parent) return\n            let parent = genreMap.get(v.parent)\n            parent.bookCount += numToAdd\n            addCount(parent, numToAdd);\n        }\n\n        /* Start creating the tree\n         * Also add descendent counts*/\n        genreMap.forEach(v => {\n            if (v.parent) {\n                genreMap.get(v.parent).children.push(v);\n                addCount(v, v.bookCount)\n            } else {\n                root.push(v);\n            }\n        })\n\n        return root\n    }\n\n    const onMoveNode = ({\n                            node: {title, id, children, parent, ...data},\n                            nextParentNode\n                        }) => {\n        if (parent === (nextParentNode ? nextParentNode.id : null)) return\n        setLoading(true)\n        updateGenre({...data, parent: nextParentNode && nextParentNode.id}, id)\n            .then(getGenres)\n            .then(() => setLoading(false))\n\n    }\n\n    useEffect(() => onChange(genres), [genres, onChange])\n\n    useEffect(() => {\n        setTitleEndAdornment(<>\n            <IconButton onClick={() => setGenreInfoDialogOpen(true)}>\n                <InfoOutlinedIcon/>\n            </IconButton>\n            {loading && <CircularProgress size={20}/>}\n        </>)\n        return () => setTitleEndAdornment(null)\n    }, [loading, setTitleEndAdornment])\n\n    return <DndProvider backend={HTML5Backend}>\n        <Dialog\n            open={genreInfoDialogOpen}\n            onClose={() => setGenreInfoDialogOpen(false)}>\n            <DialogTitle>Genre Notes</DialogTitle>\n            <DialogContent>\n                <DialogContentText component={'div'}>\n                    A book can belong to multiple tags e.g.\n                    <ul>\n                        <li>Fahrenheit 451 belongs to 'Science Fiction', 'Dystopian'</li>\n                    </ul>\n\n                    Books can be tagged with both a tag as well as its parent:\n                    searching for the parent tag will also include all child tags\n\n                    <ul>\n                        <li>If a tag is deleted/modified, it is deleted/modified on all books</li>\n                        <li>A parent tag cannot be deleted if it has children</li>\n                    </ul>\n\n                    Also, book counts by genre will not add up to the total number of books. This is because\n                    some books can belong to two top-level genres, for example Finance and Programming.\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button color={'primary'} onClick={() => setGenreInfoDialogOpen(false)}>Close</Button>\n            </DialogActions>\n        </Dialog>\n        <Container>\n            <StyledFab color={'primary'} onClick={() => setEditingItem(true)}>\n                <AddIcon/>\n            </StyledFab>\n            {editingItem && <GenreDialog\n                genres={genres}\n                editingItem={editingItem}\n                onClose={onClose}\n                onDelete={onDelete}\n                onSubmit={onSubmit}\n            />}\n            <StyledSortableTree\n                canDrop={({prevParent, nextParent}) => prevParent?.id !== nextParent?.id}\n                getNodeKey={({node}) => node.id}\n                onChange={setTreeState}\n                onMoveNode={onMoveNode}\n                rowHeight={35}\n                treeData={treeState}\n                isVirtualized={false}\n            />\n        </Container>\n    </DndProvider>\n\n}","import {useCallback, useEffect, useState} from 'react';\nimport {Books} from \"./Books\";\nimport * as Url from \"./urls\";\nimport {capitalize} from \"lodash\";\nimport {List, ListItem, ListItemIcon, ListItemText, Typography} from \"@material-ui/core\";\nimport {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport HomeIcon from '@material-ui/icons/Home';\nimport PeopleIcon from '@material-ui/icons/People';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\nimport TitleIcon from '@material-ui/icons/Title';\nimport {GenericAddDeleteCreate} from \"./genericAddDeleteCreate\";\nimport {Genres} from \"./Genres\";\n\nconst LITERATURE_CURRENT_SUBMODULE = 'LITERATURE_CURRENT_SUBMODULE';\n\nconst LITERATURE_MODULES = (props = {}) => ({\n    BOOKS: {\n        appDrawer: <><ListItemIcon>\n            <HomeIcon/>\n        </ListItemIcon>\n            <ListItemText primary={'Books'}/>\n        </>,\n        jsx: <Books {...props}/>\n    },\n    AUTHORS: {\n        appDrawer: <><ListItemIcon>\n            <PeopleIcon/>\n        </ListItemIcon>\n            <ListItemText primary={'Authors'}/></>,\n        jsx: <GenericAddDeleteCreate\n            types={props.authors}\n            addType={Url.addAuthor}\n            deleteType={Url.deleteAuthor}\n            getType={props.getAuthors}\n            updateType={Url.updateAuthor}\n        />\n    },\n    GENRES: {\n        appDrawer: <><ListItemIcon>\n            <InsertDriveFileIcon/>\n        </ListItemIcon>\n            <ListItemText primary={'Genres'}/></>,\n        jsx: <Genres\n            books={props.books}\n            genres={props.genres}\n            addGenre={Url.addGenre}\n            deleteGenre={Url.deleteGenre}\n            getGenres={props.getGenres}\n            updateGenre={Url.updateGenre}\n            setTitleEndAdornment={props.setTitleEndAdornment}\n        />\n    },\n    TYPES: {\n        appDrawer: <><ListItemIcon>\n            <TitleIcon/>\n        </ListItemIcon>\n            <ListItemText primary={'Types'}/></>,\n        jsx: <GenericAddDeleteCreate\n            types={props.types}\n            addType={Url.addType}\n            deleteType={Url.deleteType}\n            getType={props.getTypes}\n            updateType={Url.updateType}\n        />\n    }\n});\n\nexport const Literature = ({returnToMainApp, logout}) => {\n\n    const storedSubModule = sessionStorage.getItem(LITERATURE_CURRENT_SUBMODULE);\n\n    const saveCurrentSubModule = key => sessionStorage.setItem(LITERATURE_CURRENT_SUBMODULE, key);\n\n    // Default to first module in LITERATURE_MODULES\n    const [currentSubModule, setCurrentSubModule] = useState(storedSubModule ?? Object.keys(LITERATURE_MODULES())[0]);\n\n    const [books, setBooks] = useState([]);\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [authors, setAuthors] = useState([]);\n    const [genres, setGenres] = useState([]);\n    const [types, setTypes] = useState([]);\n\n    const [titleEndAdornment, setTitleEndAdornment] = useState(null)\n\n\n    const getBooks = useCallback(() => Url.getBooks().then(json => setBooks(json)), []);\n\n    const getAuthors = useCallback(() => Url.getAuthors().then(result => setAuthors(result)), []);\n    const getGenres = useCallback(() => Url.getGenres().then(result => setGenres(result)), []);\n    const getTypes = useCallback(() => Url.getTypes().then(result => setTypes(result)), []);\n\n    useEffect(() => {\n        void getBooks();\n        void getAuthors();\n        void getGenres();\n        void getTypes();\n    }, [getAuthors, getBooks, getGenres, getTypes]);\n\n    const drawerContent = <List disablePadding>\n        {Object.entries(LITERATURE_MODULES()).map(([key, value]) => <ListItem\n            key={key}\n            button\n            onClick={() => {\n                setCurrentSubModule(key);\n                saveCurrentSubModule(key);\n                setDrawerOpen(false)\n            }}>\n            {value.appDrawer}</ListItem>)}\n    </List>;\n\n    return (\n        <AppBarResponsive\n            appName={'Literature'}\n            titleContent={<>\n                <Typography variant={\"h6\"} noWrap>\n                    {capitalize(currentSubModule)}\n                </Typography>\n                {titleEndAdornment}\n            </>}\n            logout={logout}\n            returnToMainApp={returnToMainApp}\n            drawerOpen={drawerOpen}\n            setDrawerOpen={setDrawerOpen}\n            drawerContent={drawerContent}>\n            {LITERATURE_MODULES({\n                getBooks,\n                books,\n                setBooks,\n                authors,\n                setAuthors,\n                genres,\n                setGenres,\n                types,\n                setTypes,\n                getAuthors,\n                getGenres,\n                getTypes,\n                setTitleEndAdornment,\n            })[currentSubModule].jsx}\n        </AppBarResponsive>\n    );\n};\n","import {API_URL} from \"../../globals/urls\";\nimport {Networking} from \"../../util/networking\";\n\nconst HOME_AUTOMATION_URL = `${API_URL}/home-automation/send`;\n\nexport const COMMANDS = {\n    gate_toggle: 'Gate: Toggle',\n    ac_off: 'AC: Off',\n    ac_on_24: 'AC: On @ 24°C',\n    ac_on_25: 'AC: On @ 25°C',\n    ceiling_fan_on: 'Ceiling Fan: On',\n    ceiling_fan_off: 'Ceiling Fan: Off',\n    dyson_fan_on: 'Dyson Fan: On',\n    dyson_fan_off: 'Dyson Fan: Off',\n};\n\nexport const sendCommand = command => Networking.send(HOME_AUTOMATION_URL, {\n    method: Networking.POST,\n    headers: {'Content-Type': 'application/json'},\n    body: JSON.stringify({command})\n});","import {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport {Button, FormControl, InputLabel, MenuItem, Select, Snackbar, Typography} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport React, {useState} from \"react\";\nimport styled from 'styled-components'\nimport {COMMANDS, sendCommand} from \"./urls\";\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\n\nconst StyledContainer = styled.form`\n  display: flex;\n  max-width: 600px;\n  height: 200px;\n  justify-content: space-between;\n  flex-direction: column;\n  padding: 20px;\n  ${BACKGROUND_COLOR};\n`;\n\nexport const HomeAutomation = ({logout, returnToMainApp}) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [snackbar, setSnackbar] = useState();\n    const [disabled, setDisabled] = useState(false);\n\n    const handleSubmit = e => {\n        e.preventDefault();\n        setDisabled(true);\n        setTimeout(() => setDisabled(false), 2000);\n        sendCommand(e.target.command.value).then(() => setSnackbar(true));\n    };\n\n    return <AppBarResponsive\n        appName={'Home Automation'}\n        titleContent={<Typography variant={\"h6\"} noWrap>Home Automation</Typography>}\n        logout={logout}\n        returnToMainApp={returnToMainApp}\n        drawerOpen={drawerOpen}\n        setDrawerOpen={setDrawerOpen}>\n        <Snackbar\n            anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n            open={snackbar}\n            onClose={() => setSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                variant={'filled'}\n                severity={'success'}>\n                Command sent\n            </Alert>\n        </Snackbar>\n        <StyledContainer\n                onSubmit={handleSubmit}>\n\n            <FormControl>\n                <InputLabel>Command</InputLabel>\n                <Select\n                    defaultValue={Object.entries(COMMANDS)[0][0]}\n                    name={'command'}\n                    required>\n                    {Object.entries(COMMANDS).map(([k, v]) => <MenuItem value={k} key={k}>{v}</MenuItem>)}\n                </Select>\n            </FormControl>\n            <Button\n                disabled={disabled}\n                    variant={'contained'}\n                    color={'primary'}\n                    type={'submit'}\n                >Send command\n                </Button>\n        </StyledContainer>\n    </AppBarResponsive>\n};","import {API_URL, FILES_URL} from \"../../globals/urls\";\nimport {Networking} from \"../../util/networking\";\n\nexport const DVR_URL = `${API_URL}/dvr`;\nexport const DVR_STREAM_URL = `${FILES_URL}/dvr_stream`;\n\nexport const getOrRefreshChannel = channel =>\n    Networking.send(`${DVR_URL}/?channel=${channel}`, {\n        method: 'GET'\n    })\n    .then(resp => resp.json());\n\nexport const getChannelUrl = (uuid, channel) =>\n    `${DVR_STREAM_URL}/${uuid}/${channel}.mpd`;","import React, {useEffect, useRef, useState} from \"react\";\nimport {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport {CircularProgress, List, ListItem, ListItemText, Typography} from \"@material-ui/core\";\nimport shaka from 'shaka-player/dist/shaka-player.ui'\nimport {getChannelUrl, getOrRefreshChannel} from \"./urls\";\nimport styled from 'styled-components'\nimport 'shaka-player/dist/controls.css'\n\nconst CHANNELS = [\n    'CAM_1',\n    'CAM_2',\n    'CAM_5',\n];\n\nconst REFRESH_INTERVAL = 10_000;\n\nconst VideoDiv = styled.div`\n  width: min(100%, 1280px)\n`;\n\nconst StyledVideo = styled.video`\n  width: 100%;\n  height: 100%;\n`;\n\nexport const DVR = ({logout, returnToMainApp}) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [channel, setChannel] = useState(CHANNELS[0]);\n    const [loading, setLoading] = useState(false);\n    const player = useRef();\n\n    // Load channel and keep refreshing every REFRESH_INTERVAL seconds\n    useEffect(() => {\n        getOrRefreshChannel(channel)\n            .then(({stream_uuid, timeout}) =>\n                getChannelUrl(stream_uuid, channel))\n            .then(url => player.current?.load(url))\n            .then(() => setLoading(false));\n\n        let intervalId = setInterval(() => {\n            getOrRefreshChannel(channel)\n        }, REFRESH_INTERVAL);\n\n        // Cleanup old timers\n        return () => clearInterval(intervalId)\n    }, [channel]);\n\n    // Initialize polyfills (required)\n    useEffect(() => {\n        shaka.polyfill.installAll();\n        return () => {\n            if (player.current) {\n                player.current.unload();\n                player.current.destroy()\n            }\n        }\n    }, []);\n\n    // Init and attach to video element\n    const attachPlayer = videoEl => {\n        /*Do not reinitialize video element if a null element is passed, or player already exists*/\n        if (!videoEl || player.current) return;\n        if (!shaka.Player.isBrowserSupported()) {\n            console.error('Shaka player not supported');\n            return\n        }\n\n        player.current = new shaka.Player(videoEl);\n        player.current.addEventListener('error', e => console.error('Shaka player error: ', e.detail));\n\n        /* Set up video controls\n        videoEl.parentNode is guaranteed to have been mounted, if videoEl itself was mounted*/\n        let ui = new shaka.ui.Overlay(player.current, videoEl.parentNode, videoEl);\n        let controls = ui.getControls();\n        controls.addEventListener('UIError', e => console.error('Shaka UI error: ', e.detail))\n    };\n    const switchChannel = channel =>\n        void player.current?.unload()\n            .then(setChannel(channel));\n\n    const drawerContent =\n        <List>\n            {CHANNELS.map(e =>\n                <ListItem\n                    key={e}\n                    button\n                    onClick={() => {\n                        setLoading(true);\n                        setDrawerOpen(false);\n                        switchChannel(e)\n                    }}>\n                    <ListItemText primary={e}/>\n                </ListItem>)}\n        </List>;\n\n    return <AppBarResponsive\n        appName={'DVR'}\n        titleContent={<>\n            <Typography variant={\"h6\"} noWrap>DVR: {channel}</Typography>\n            {loading && <CircularProgress color=\"inherit\" size={20} style={{margin: '12px'}}/>}\n        </>}\n        setDrawerOpen={setDrawerOpen}\n        logout={logout}\n        returnToMainApp={returnToMainApp}\n        drawerOpen={drawerOpen}\n        drawerContent={drawerContent}\n    >\n        <VideoDiv data-shaka-player-container>\n            <StyledVideo\n                data-shaka-player\n                ref={attachPlayer}\n                id=\"video\"\n                autoPlay/>\n        </VideoDiv>\n    </AppBarResponsive>\n};","import InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\nimport {IconButton, InputAdornment, Tooltip} from \"@material-ui/core\";\nimport TextField from \"@material-ui/core/TextField\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\n\n/*Textfield with clear and info buttons*/\nexport const TextFieldClearableInfo = ({info, onChange, ...props}) => {\n\n    return <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    {info && <InputAdornment position={'end'}>\n                        <Tooltip\n                            arrow\n                            enterTouchDelay={100}\n                            interactive\n                            title={info}>\n                            <IconButton tabIndex={-1}>\n                                <InfoOutlinedIcon/>\n                            </IconButton>\n                        </Tooltip>\n                    </InputAdornment>}\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n};","import {TextFieldClearableInfo} from \"../../shared/textFieldClearableInfo\";\nimport Cleave from \"cleave.js/react\";\nimport React from \"react\";\n\nconst CleaveTextField = ({inputRef, ...props}) =>\n    <Cleave\n        htmlRef={inputRef}\n        {...props}\n    />;\n\n/*Textfield with clear and info buttons, and currency formatting\n* Permanently shrunk*/\nexport const TextFieldClearableInfoCurrency = ({info, onChange, InputProps, ...props}) => {\n\n    return <TextFieldClearableInfo\n        {...props}\n        info={info}\n        InputLabelProps={{ shrink: true }}\n        InputProps={{\n            ...InputProps,\n            inputComponent: CleaveTextField,\n            inputProps: {\n                options: {\n                    numeral: true,\n                    prefix: '$',\n                    rawValueTrimPrefix: true,\n                }\n            },\n            onChange: e => onChange(e.target.rawValue)\n        }}\n        onChange={onChange}\n    />\n};","import {useWatch} from \"react-hook-form\";\nimport React from \"react\";\n\n/*Isolate rendering of an array of fields (convenience)*/\nexport const FieldUseWatch = ({control, fieldsToWatch, Component}) => {\n    const fields = useWatch({\n        control,\n        name: fieldsToWatch,\n    });\n    return <Component fields={fields}/>\n};","import {Typography} from \"@material-ui/core\";\nimport {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport React, {useEffect, useState} from \"react\";\nimport {yupResolver} from '@hookform/resolvers/yup'\nimport styled from 'styled-components'\nimport {Controller, useForm} from \"react-hook-form\";\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\nimport * as yup from 'yup'\nimport {trim} from \"lodash\";\nimport {TextFieldClearableInfo} from \"../../shared/textFieldClearableInfo\";\nimport {TextFieldRefreshLoading} from \"./textFieldRefreshLoading\";\nimport {formatDistanceToNowStrict} from 'date-fns'\nimport {TextFieldClearableInfoCurrency} from \"./TextFieldClearableInfoCurrency\";\nimport {FieldUseWatch} from \"./FieldUseWatch\";\n\n/*API Key from dnsproxy@gmail.com*/\nconst ENDPOINT = 'https://finnhub.io/api/v1/quote?symbol=SPY&token=c10sd6n48v6pp7chu95g';\n\nconst FIELDS = {\n    portfolioValue: 'portfolioValue',\n    spyPrice: 'spyPrice',\n    hedgeRatio: 'hedgeRatio',\n    delta: 'delta',\n};\n\nconst emptyStringToUndefined = (val, origVal) => trim(origVal) === '' ? undefined : val;\n\nconst schema = yup.object({\n    portfolioValue: yup.number().positive().required().transform(emptyStringToUndefined),\n    spyPrice: yup.number().positive().required().transform(emptyStringToUndefined),\n    hedgeRatio: yup.number().positive().max(1).required().transform(emptyStringToUndefined),\n    delta: yup.number().positive().max(1).required().transform(emptyStringToUndefined)\n});\n\nconst Container = styled.div`\n  ${BACKGROUND_COLOR};\n  max-width: 600px;\n`;\n\nconst StyledTypography = styled(Typography)`\n  &.MuiTypography-root {\n    white-space: pre-line;\n  }\n`;\n\nconst StyledTextFieldClearableInfo = styled(TextFieldClearableInfo)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\nconst StyledTextFieldRefresh = styled(TextFieldRefreshLoading)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\nconst StyledTextFieldClearableInfoCurrency = styled(TextFieldClearableInfoCurrency)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\nconst explanatoryText = `Hedge instrument: SPY puts\nNOTE: This calculates a 1:1 put spread, not the 1:1.1 as described in the 'Options Edge' book\n\nNote: As I am only hedging CSPX and IWDA, beta for my portfolio is 1\nTake beta of IWDA to be 0.89 for now (see 'Finance and Investing' doc)\nBeta of DPYA = IWDP = 0.99\n5yr beta of ISAC = 1\n\nRehedge in first month ONLY if SPY has moved > 3% from the previous long put strike\n`;\n\nconst formatNoDecimals = new Intl.NumberFormat(undefined, {maximumFractionDigits: 0});\nconst formatDecimals = new Intl.NumberFormat(undefined, {maximumFractionDigits: 1});\nconst formatDollars = new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: 'USD',\n    currencyDisplay: 'symbol'\n});\n\nexport const OptionHedgeCalculator = ({logout, returnToMainApp}) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [spyPriceUpdated, setSpyPriceUpdated] = useState();\n    const [tooltipText, setTooltipText] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const {\n        control,\n        setValue,\n        setError\n    } = useForm({\n        mode: 'onTouched',\n        resolver: yupResolver(schema),\n        defaultValues: {\n            [FIELDS.portfolioValue]: '',\n            [FIELDS.spyPrice]: '',\n            [FIELDS.hedgeRatio]: 0.47,\n            [FIELDS.delta]: '',\n        }\n    });\n\n    const getSpyPrice = () => {\n        setLoading(true);\n        return fetch(ENDPOINT, {method: 'GET'})\n            .then(r => r.json())\n            .then(({c}) => {\n                setValue(FIELDS.spyPrice, c);\n                setSpyPriceUpdated(new Date());\n                setLoading(false)\n            })\n            .catch(e => {\n                setLoading(false);\n                setError(FIELDS.spyPrice, {message: `Failed to fetch from API: ${e}`})\n            })\n    };\n\n\n    // eslint-disable-next-line\n    useEffect(() => void getSpyPrice(), []);\n\n    return <AppBarResponsive\n        appName={'Option Hedge Calculator'}\n        titleContent={<Typography variant={\"h6\"} noWrap>Option Hedge Calculator</Typography>}\n        setDrawerOpen={setDrawerOpen}\n        logout={logout}\n        returnToMainApp={returnToMainApp}\n        drawerOpen={drawerOpen}\n    >\n        <Container>\n            <StyledTypography variant={'body1'}>{explanatoryText}</StyledTypography>\n\n            <Controller\n                name={FIELDS.portfolioValue}\n                control={control}\n                render={({\n                             field: {ref, ...field},\n                             fieldState: {error}\n                         }) =>\n                    <StyledTextFieldClearableInfoCurrency\n                        {...field}\n                        error={Boolean(error)}\n                        helperText={error?.message}\n                        info={'Take beta of IWDA to be 0.89 and exclude bonds e.g. AGGU'}\n                        label={'Beta-weighted Portfolio Value (USD)'}\n                        variant={'outlined'}\n                    />}/>\n\n            <Controller\n                name={FIELDS.spyPrice}\n                control={control}\n                render={({\n                             field: {ref, ...field},\n                             fieldState: {error}\n                         }) =>\n                    <StyledTextFieldRefresh\n                        {...field}\n                        error={Boolean(error)}\n                        helperText={error?.message}\n                        label={'SPY Price'}\n                        loading={loading}\n                        onOpen={() => setTooltipText(spyPriceUpdated ? 'Last updated ' + formatDistanceToNowStrict(spyPriceUpdated, {addSuffix: true}) : '')}\n                        onRefresh={getSpyPrice}\n                        tooltipText={tooltipText}\n                        variant={'outlined'}/>}/>\n\n\n            <FieldUseWatch\n                control={control}\n                fieldsToWatch={[FIELDS.spyPrice]}\n                Component={({fields: [spyPrice]}) => <Typography variant={'body1'}>\n                    Strike price for short 8.6% delta OTM, 90-day\n                    put: {formatNoDecimals.format(0.914 * spyPrice)}\n                </Typography>}/>\n\n            <Controller\n                name={FIELDS.hedgeRatio}\n                control={control}\n                render={({\n                             field: {ref, ...field},\n                             fieldState: {error}\n                         }) =>\n                    <StyledTextFieldClearableInfo\n                        {...field}\n                        error={Boolean(error)}\n                        info={'% of portfolio value to hedge using put options (via delta equivalent amount)'}\n                        helperText={error?.message}\n                        label={'Hedge Ratio'}\n                        variant={'outlined'}/>}/>\n\n\n            <FieldUseWatch\n                control={control}\n                fieldsToWatch={[FIELDS.hedgeRatio, FIELDS.portfolioValue]}\n                Component={({fields: [hedgeRatio, portfolioValue]}) =>\n                    <Typography variant={'body1'}>\n                        Notional amount to hedge: {formatDollars.format(portfolioValue * hedgeRatio)}\n                    </Typography>}/>\n\n            <Controller\n                name={FIELDS.delta}\n                control={control}\n                render={({\n                             field: {ref, ...field},\n                             fieldState: {error}\n                         }) =>\n                    <StyledTextFieldClearableInfo\n                        {...field}\n                        error={Boolean(error)}\n                        info={'Delta of each spread with OTM 8.6% put sold, per option e.g. 0.250'}\n                        label={'Delta'}\n                        helperText={error?.message}\n                        variant={'outlined'}/>}/>\n\n            <FieldUseWatch\n                control={control}\n                fieldsToWatch={[FIELDS.portfolioValue, FIELDS.hedgeRatio, FIELDS.delta, FIELDS.spyPrice]}\n                Component={({fields: [portfolioValue, hedgeRatio, delta, spyPrice]}) =>\n                    <Typography variant={'body1'}>\n                        Number of spreads required (i.e. standard option contracts):\n                        {formatDecimals.format(portfolioValue * hedgeRatio / (delta * spyPrice * 100))}\n                    </Typography>}\n            />\n\n        </Container>\n    </AppBarResponsive>\n};\n\n/*Test case:\n*\n* Beta-weighted portfolio value in USD: 1000000\n* Current price of SPY: 300\n* OTM Put Strike to sell: 274.2\n* Hedge ratio: 0.47\n* Notional amount: 470000.0\n* Delta of 8.6% OTM put spread: 0.21\n* Number of spreads required (i.e. option contracts): 74.60317460317461\n* */","import TextField from \"@material-ui/core/TextField\";\nimport {CircularProgress, IconButton, InputAdornment, Tooltip} from \"@material-ui/core\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport CachedIcon from '@material-ui/icons/Cached';\nimport {noop} from \"../../util/util\";\nimport React from \"react\";\n\nexport const TextFieldRefreshLoading = ({onChange, onRefresh, loading, tooltipText = '', onOpen = noop, ...props}) => {\n\n    return <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    <InputAdornment position={'end'}>\n                        <Tooltip\n                            onOpen={onOpen}\n                            arrow\n                            enterTouchDelay={100}\n                            interactive\n                            title={tooltipText}>\n                            <IconButton onClick={onRefresh}>\n                                {loading ? <CircularProgress size={20}/> : <CachedIcon/>}\n                            </IconButton>\n                        </Tooltip>\n                    </InputAdornment>\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n};","import {getSecureRandom} from \"./util\";\nimport {formatDistance} from \"date-fns\";\n\nconst DIGITS_REGEX = /\\d/;\nconst LOWER_REGEX = /[a-z]/;\nconst UPPER_REGEX = /[A-Z]/;\nconst SYMBOLS_REGEX = /[!@#$%^&*]/;\n\n\nconst DIGITS = '0123456789';\nconst LOWER = 'abcdefghijklmnopqrstuvwxyz';\nconst UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst SYMBOLS = '!@#$%^&*';\n\nconst secureRandom = getSecureRandom();\nconst formatNumber = new Intl.NumberFormat(undefined, {\n    maximumFractionDigits: 0,\n    maximumSignificantDigits: 3,\n});\n\n/*Gets the entropy in bits for a password, assuming it is completely random*/\nexport const getEntropy = password => {\n\n    let hasDigits = DIGITS_REGEX.test(password);\n    let hasLowerCase = LOWER_REGEX.test(password);\n    let hasUpperCase = UPPER_REGEX.test(password);\n    let hasSymbols = SYMBOLS_REGEX.test(password);\n\n    let totalSymbols =\n        (hasDigits ? 10 : 0) +\n        (hasLowerCase ? 26 : 0) +\n        (hasUpperCase ? 26 : 0) +\n        (hasSymbols ? SYMBOLS.length : 0);\n\n    let bitsPerChar = Math.log2(totalSymbols);\n    let totalEntropy = bitsPerChar * password.length;\n\n    return {\n        length: password.length,\n        hasDigits,\n        hasLowerCase,\n        hasUpperCase,\n        hasSymbols,\n        bitsPerChar,\n        totalEntropy,\n    }\n\n};\n\nexport const generatePassword = ({length = 10, digits = true, lower = true, upper = true, symbols = true} = {}) => {\n\n    if (length < 4) throw new Error('Password length is too short');\n\n    let charSet =\n        (digits ? DIGITS : '') +\n        (lower ? LOWER : '') +\n        (upper ? UPPER : '') +\n        (symbols ? SYMBOLS : '');\n\n    const generate = () => {\n        let password = '';\n        while (password.length < length)\n            password += secureRandom.choice(charSet);\n        return password\n    };\n\n    let password = generate();\n\n    /*Ensure generated password meets criteria*/\n    while ((digits && !DIGITS_REGEX.test(password)) ||\n    (lower && !LOWER_REGEX.test(password)) ||\n    (upper && !UPPER_REGEX.test(password)) ||\n    (symbols && !SYMBOLS_REGEX.test(password))) {\n        password = generate()\n    }\n    return password\n};\n\nwindow.test = generatePassword;\n\nexport const getSha1Hash = async message => {\n    const msgUint8 = new TextEncoder().encode(message);                            // encode as (utf-8) Uint8Array\n    const hashBuffer = await crypto.subtle.digest('SHA-1', msgUint8);    // hash the message\n    const hashArray = Array.from(new Uint8Array(hashBuffer));                      // convert buffer to byte array\n    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();       // convert bytes to hex string\n};\n\nexport const generateUsername = ({length = 8} = {}) => {\n\n    const vowels = ['a', 'e', 'i', 'o', 'u'];\n    const cons = ['b', 'c', 'd', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'r', 's', 't', 'u', 'v', 'w', 'tr', 'cr', 'br', 'fr', 'th', 'dr', 'ch', 'ph', 'wr', 'st', 'sp', 'sw', 'pr', 'sl', 'cl'];\n\n    const num_vowels = vowels.length;\n    const num_cons = cons.length;\n    let password = '';\n\n    for (let i = 0; i < length; i++) {\n        password += cons[Math.floor(secureRandom.random() * num_cons)] + vowels[Math.floor(secureRandom.random() * num_vowels)];\n    }\n\n    return password.substr(0, length);\n};\n\nexport const formatLargeDuration = seconds => {\n    if (seconds < 3.154e+7) {\n        return formatDistance(new Date(0), new Date(seconds * 1000))\n    }\n    if (seconds > 4.4e+17) {\n        return 'longer than the age of the Universe'\n    }\n    return formatNumber.format(seconds / 3.154e+7) + ' years';\n};","import {API_URL} from \"../../globals/urls\";\n\n\nconst PASSWORDS_API = `${API_URL}/passwords`;\n\nexport const HIBP_LOOKUP = hash => `${PASSWORDS_API}/lookup/?hash=${hash}`;","import {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport {useCallback, useEffect, useState} from \"react\";\nimport {\n    Button,\n    Checkbox,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    FormControl,\n    FormControlLabel,\n    FormGroup,\n    IconButton,\n    Slider,\n    Snackbar,\n    TextField,\n    Tooltip,\n    Typography\n} from \"@material-ui/core\";\nimport {\n    formatLargeDuration,\n    generatePassword,\n    generateUsername,\n    getEntropy,\n    getSha1Hash\n} from \"../../util/passwordUtil\";\nimport {Networking} from \"../../util/networking\";\nimport {HIBP_LOOKUP} from \"./urls\";\nimport styled from 'styled-components'\nimport {BACKGROUND_COLOR} from \"../../shared/backgroundScreen\";\nimport ReplayIcon from '@material-ui/icons/Replay';\nimport \"@fontsource/jetbrains-mono\"\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\nimport {Alert} from \"@material-ui/lab\";\nimport {debounce} from 'lodash'\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport CheckIcon from '@material-ui/icons/Check';\nimport ClearIcon from '@material-ui/icons/Clear';\n\nconst Container = styled.div`\n  display: flex;\n  max-width: 600px;\n  flex-direction: column;\n  padding: 10px;\n  ${BACKGROUND_COLOR};\n`;\n\nconst StyledTextField = styled(TextField)`\n  .MuiInputBase-input {\n    font-family: \"JetBrains Mono\", monospace\n  }\n\n  margin: 10px 0;\n`;\n\nconst TextFieldContainer = styled.div`\n  display: flex;\n  align-items: flex-start;\n`;\n\nconst StyledIconButton = styled(IconButton)`\n  margin-top: 14px;\n`;\n\nconst OptionsFormGroup = styled(FormGroup)`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst PasswordDetailGrid = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  justify-items: start;\n  gap: 10px 10px;\n  align-items: center;\n  margin: 5px 0 15px;\n`;\n\nconst GreenCheck = styled(CheckIcon)`\n  color: chartreuse;\n  margin-right: 10px;\n`;\n\nconst GreyCross = styled(ClearIcon)`\n  color: grey;\n  margin-right: 10px;\n`;\n\n\nconst formatNumber = new Intl.NumberFormat(undefined, {maximumFractionDigits: 0});\nconst formatDecimal = new Intl.NumberFormat(undefined, {maximumFractionDigits: 2});\n\nconst DEFAULT_USERNAME_LENGTH = 10;\nconst DEFAULT_PASSWORD_LENGTH = 24;\n\nexport const PasswordTools = ({returnToMainApp, logout}) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [hashCount, setHashCount] = useState(0);\n    const [settings, setSettings] = useState({\n        dialogOpen: false,\n        dialogType: null,\n        passwordSettings: {\n            length: DEFAULT_PASSWORD_LENGTH,\n            digits: true,\n            lower: true,\n            upper: true,\n            symbols: true\n        },\n        usernameSettings: {\n            length: DEFAULT_USERNAME_LENGTH\n        }\n    });\n\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [snackbarOpen, setSnackbarOpen] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [entropy, setEntropy] = useState({});\n\n    let secondsToBruteforce = (2 ** entropy.totalEntropy / (200 * 10 ** 18));\n\n    useEffect(() => {\n        if (!password) return;\n\n        let generatedPassword = generatePassword(settings.passwordSettings);\n        setPassword(generatedPassword);\n        setEntropy(getEntropy(generatedPassword))\n        // eslint-disable-next-line\n    }, [settings.passwordSettings]);\n\n    useEffect(() => {\n        setUsername(generateUsername(settings.usernameSettings))\n    }, [settings.usernameSettings]);\n\n    // eslint-disable-next-line\n    const checkHibp = useCallback(debounce(\n        hash => getSha1Hash(hash)\n            .then(r => Networking.send(HIBP_LOOKUP(r)))\n            .then(r => r.json())\n            .then(r => {\n                setHashCount(r.count);\n                setLoading(false)\n            })\n        , 500)\n        , []);\n\n    const copyToClipboard = text => navigator.clipboard.writeText(text)\n        .then(() => {\n            if (snackbarOpen) {\n                setSnackbarOpen(false);\n                setTimeout(() => setSnackbarOpen(true), 100)\n            } else\n                setSnackbarOpen(true);\n        });\n\n    const onPasswordChange = text => {\n        setLoading(true);\n        setPassword(text);\n        checkHibp(text);\n        setEntropy(getEntropy(text))\n    };\n\n    const closeSettings = () => setSettings(current => ({...current, dialogOpen: false}));\n\n    return <AppBarResponsive\n        drawerOpen={drawerOpen}\n        drawerContent={null}\n        returnToMainApp={returnToMainApp}\n        logout={logout}\n        setDrawerOpen={setDrawerOpen}\n        titleContent={<Typography variant={'h6'}>Password Tools</Typography>}\n        appName={'Password Tools'}\n    >\n        <Dialog open={settings.dialogOpen} onClose={closeSettings}>\n            <DialogTitle\n                style={{zIndex: 1}}>{settings.dialogType === 'username' ? 'Username' : 'Password'} Options</DialogTitle>\n            <DialogContent>\n                {settings.dialogType === 'username' && <>\n                    Length: {settings.usernameSettings.length}\n                    <Slider value={settings.usernameSettings.length}\n                            step={1}\n                            min={6}\n                            max={24}\n                            onChange={(e, value) =>\n                                setSettings(current => ({\n                                    ...current,\n                                    usernameSettings: {\n                                        length: value\n                                    }\n                                }))}/>\n                </>}\n                {settings.dialogType === 'password' && <>\n                    Length: {settings.passwordSettings.length}\n                    <Slider value={settings.passwordSettings.length}\n                            step={1}\n                            min={6}\n                            max={64}\n                            onChange={(e, value) =>\n                                setSettings(current => ({\n                                    ...current,\n                                    passwordSettings: {\n                                        ...current.passwordSettings,\n                                        length: value\n                                    }\n                                }))}/>\n                    <FormControl>\n                        <OptionsFormGroup>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.lower}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         lower: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'a-z'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.upper}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         upper: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'A-Z'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.digits}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         digits: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'0-9'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.symbols}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         symbols: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'!@#$%^&*'}/>\n                        </OptionsFormGroup>\n                    </FormControl>\n                </>}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={closeSettings}>Close</Button>\n            </DialogActions>\n        </Dialog>\n        <Snackbar\n            anchorOrigin={{vertical: 'top', horizontal: 'center'}}\n            open={snackbarOpen}\n            autoHideDuration={3000}\n            onClose={() => setSnackbarOpen(false)}>\n            <Alert severity=\"success\" variant={'filled'}>Copied</Alert>\n        </Snackbar>\n        <Container>\n            <TextFieldContainer>\n                <StyledTextField\n                    variant={'outlined'}\n                    label={'Random Username'}\n                    value={username}\n                    fullWidth\n                    onChange={e => setUsername(e.target.value)}\n                    InputProps={{\n                        endAdornment:\n                            <>\n                                <IconButton onClick={() => copyToClipboard(username)}>\n                                    <FileCopyIcon/>\n                                </IconButton>\n                                <IconButton\n                                    onClick={() => setUsername(generateUsername(settings.usernameSettings))}>\n                                    <ReplayIcon/>\n                                </IconButton>\n                            </>\n                    }}\n                />\n                <StyledIconButton onClick={() => setSettings(current => ({\n                    ...current,\n                    dialogOpen: true,\n                    dialogType: 'username'\n                }))}><SettingsIcon/></StyledIconButton>\n            </TextFieldContainer>\n            <TextFieldContainer>\n                <StyledTextField\n                    variant={'outlined'}\n                    label={'Type a password'}\n                    value={password}\n                    fullWidth\n                    error={!loading && Boolean(hashCount)}\n                    helperText={loading ? 'Checking...' :\n                        password === '' ? 'Type a password to check, or generate one' :\n                            hashCount > 0 ? `Password cracked ${formatNumber.format(hashCount)} times` :\n                                'Password has not been cracked'}\n                    onChange={e => onPasswordChange(e.target.value)}\n                    InputProps={{\n                        endAdornment:\n                            <>\n                                <IconButton onClick={() => copyToClipboard(password)}>\n                                    <FileCopyIcon/>\n                                </IconButton>\n                                <IconButton\n                                    onClick={() => onPasswordChange(generatePassword(settings.passwordSettings))}>\n                                    <ReplayIcon/>\n                                </IconButton>\n                            </>\n                    }}\n                />\n                <StyledIconButton onClick={() => setSettings(current => ({\n                    ...current,\n                    dialogOpen: true,\n                    dialogType: 'password'\n                }))}><SettingsIcon/></StyledIconButton>\n            </TextFieldContainer>\n            <PasswordDetailGrid>\n                <Typography variant={'body1'} color={entropy.hasLowerCase ? 'textPrimary' : 'textSecondary'}>Lowercase\n                    letters </Typography>\n                {entropy.hasLowerCase ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'} color={entropy.hasUpperCase ? 'textPrimary' : 'textSecondary'}>Uppercase\n                    letters</Typography>\n                {entropy.hasUpperCase ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'}\n                            color={entropy.hasDigits ? 'textPrimary' : 'textSecondary'}>Digits</Typography>\n                {entropy.hasDigits ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'} color={entropy.hasSymbols ? 'textPrimary' : 'textSecondary'}>Symbols\n                    (@#...)</Typography>\n                {entropy.hasSymbols ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'}>Entropy\n                    <Tooltip\n                        arrow\n                        enterTouchDelay={100}\n                        interactive\n                        title={'A measure of how secure the password is. 128 bits is recommended for most people.'}>\n                        <IconButton tabIndex={-1}>\n                            <InfoOutlinedIcon/>\n                        </IconButton>\n                    </Tooltip>\n                </Typography>\n                <Typography variant={'body1'}>{entropy.totalEntropy && (formatDecimal.format(entropy.totalEntropy) + ' bits')}</Typography>\n\n                <Typography variant={'body1'}>Time to crack\n                    <Tooltip\n                        arrow\n                        enterTouchDelay={100}\n                        interactive\n                        title={'Based on the current Bitcoin hashrate (200 EH/s)'}>\n                        <IconButton tabIndex={-1}>\n                            <InfoOutlinedIcon/>\n                        </IconButton>\n                    </Tooltip>\n                </Typography>\n                <Typography variant={'body1'}>{Number.isFinite(secondsToBruteforce) && formatLargeDuration(secondsToBruteforce)}</Typography>\n            </PasswordDetailGrid>\n\n\n        </Container>\n    </AppBarResponsive>\n\n\n};","import {API_URL} from \"../../globals/urls\";\n\nconst ACCOUNT_URL = `${API_URL}/account`;\nexport const TWOFACTOR_URL = `${ACCOUNT_URL}/twofactor/`;\nexport const BROWSERS_URL = `${ACCOUNT_URL}/browsers/`;\nexport const getBrowserDetail = id => `${BROWSERS_URL}${id}/`;","import QRCode from \"qrcode.react\";\nimport {formatDistanceToNowPretty} from \"../../util/util\";\nimport {parseJSON} from \"date-fns\";\nimport {Button, TextField, Typography} from \"@material-ui/core\";\nimport {useEffect, useState} from \"react\";\nimport {Networking} from \"../../util/networking\";\nimport {TWOFACTOR_URL} from \"./urls\";\n\n\nexport const TwoFactor = () => {\n\n    const [otpStats, setOtpStats] = useState({});\n    const [otpStatus, setOtpStatus] = useState(false);\n    const [otp, setOtp] = useState('');\n    const [secret, setSecret] = useState();\n\n    const getOtpStatus = () => Networking.send(TWOFACTOR_URL)\n        .then(r => r.json())\n        .then(r => {\n            setOtpStatus(r['2fa_enabled']);\n            setOtpStats(r)\n        });\n\n    useEffect(() => void getOtpStatus(), []);\n\n    const register = () => Networking.send(TWOFACTOR_URL, {\n        method: Networking.POST,\n        body: JSON.stringify({action: 'register'})\n    })\n        .then(r => r.json())\n        .then(r => setSecret(r['otpauth_url']));\n\n    const enable = () => Networking.send(TWOFACTOR_URL, {\n        method: Networking.POST,\n        body: JSON.stringify({action: 'enable', otp})\n    }).then(r => r.json())\n        .then(getOtpStatus);\n\n    const disable = () => Networking.send(TWOFACTOR_URL, {\n        method: Networking.POST,\n        body: JSON.stringify({action: 'disable', otp})\n    }).then(getOtpStatus);\n\n    return <>\n        {secret && <a href={secret}><QRCode value={secret}/></a>}\n        <Typography variant={'body1'}>OTP is {Boolean(otpStatus) ? 'enabled' : 'disabled'}.</Typography>\n        <Typography variant={'body1'}>Created: {otpStats['created'] && formatDistanceToNowPretty(parseJSON(otpStats['created']))}</Typography>\n        <Button color={'primary'} variant={'contained'} onClick={register}>Register</Button>\n        <Button color={'primary'} variant={'contained'} onClick={enable}>Enable</Button>\n        <Button color={'secondary'} variant={'contained'} onClick={disable}>Disable</Button>\n        <TextField\n            value={otp}\n            onChange={e => setOtp(e.target.value)}\n        />\n    </>\n};","import {Button, Card, CardActionArea, CardActions, CardContent, Chip, Typography} from \"@material-ui/core\";\nimport {formatDistanceToNowPretty, prettifyUAString} from \"../../util/util\";\nimport PhoneIphoneIcon from \"@material-ui/icons/PhoneIphone\";\nimport DesktopWindowsIcon from \"@material-ui/icons/DesktopWindows\";\nimport PublicIcon from '@material-ui/icons/Public';\nimport {format, parseJSON} from \"date-fns\";\nimport styled from \"styled-components\";\nimport {theme} from \"../../globals/theme\";\nimport ChromeLogo from '../../browserLogos/chrome.png'\nimport FirefoxLogo from '../../browserLogos/firefox.png'\nimport EdgeLogo from '../../browserLogos/edge.png'\nimport SafariLogo from '../../browserLogos/safari.png'\nimport {useState} from \"react\";\nimport {getName} from \"country-list\";\n\nconst StyledCard = styled(Card)`\n  outline: ${props => props.$thisDevice ? '2px solid ' + theme.palette.primary.main : 'none'};\n`;\n\nconst StyledTypography = styled(Typography)`\n  margin: 10px 0;\n`;\n\nconst ImageDiv = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst SavedBrowserDiv = styled.div`\n  width: 100%;\n  height: 32px;\n  display: flex;\n  justify-content: flex-end;\n`;\n\nconst BrowserLogoDiv = styled.div`\n  background: no-repeat url(${props => props.$image}) center/contain;\n  margin: 0 6px;\n  width: 32px;\n  height: 32px\n`;\n\nconst CardContainer = styled.div`\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst BrowserLogo = {\n    Chrome: ChromeLogo,\n    Firefox: FirefoxLogo,\n    Edge: EdgeLogo,\n    Safari: SafariLogo,\n};\n\nexport const BrowserCard = ({\n                                browser: {\n                                    id,\n                                    is_active,\n                                    is_current_session,\n                                    is_saved,\n                                    first_login,\n                                    last_activity,\n                                    ip,\n                                    country_code,\n                                    user_agent,\n                                },\n                                forgetAndLogoutBrowser,\n                            }) => {\n\n    const prettifiedUserAgent = prettifyUAString(user_agent);\n    const browserName = prettifiedUserAgent.browserName;\n    const [detailView, setDetailView] = useState(false);\n\n    return <>\n        <StyledCard $thisDevice={is_current_session} key={id}>\n            <CardContainer>\n                <CardActionArea onClick={() => setDetailView(!detailView)}>\n                    <CardContent>\n                        {detailView ?\n                            <>\n                                <Typography variant={'body1'}>First Login</Typography>\n                                <Typography variant={'body2'}\n                                            color={'textSecondary'}>{format(parseJSON(first_login), 'PPpp')}</Typography>\n                                <Typography variant={'body1'}>Last Activity</Typography>\n                                <Typography variant={'body2'}\n                                            color={'textSecondary'}>{format(parseJSON(last_activity), 'PPpp')}</Typography>\n                                <Typography variant={'body1'}>User-Agent</Typography>\n                                <Typography variant={'body2'} color={'textSecondary'}>{user_agent}</Typography>\n\n                            </> :\n                            <>\n                                <ImageDiv>\n                                    {prettifiedUserAgent.isMobile ? <PhoneIphoneIcon/> : <DesktopWindowsIcon/>}\n                                    {browserName in BrowserLogo ? <BrowserLogoDiv $image={BrowserLogo[browserName]}/> :\n                                        <PublicIcon/>}\n                                    <SavedBrowserDiv>\n                                        {is_saved && <Chip label={'Saved'} color={'primary'}/>}\n                                    </SavedBrowserDiv>\n                                </ImageDiv>\n\n                                <StyledTypography variant={'body1'}>{prettifiedUserAgent.name}</StyledTypography>\n                                <Typography variant={'body2'}>{getName(country_code)}</Typography>\n                                <Typography variant={'body2'} style={{overflowWrap: 'break-word'}}>{ip}</Typography>\n                                <StyledTypography variant={'body2'}\n                                                  color={'textSecondary'}>{formatDistanceToNowPretty(parseJSON(last_activity))}</StyledTypography>\n                            </>\n                        }\n                    </CardContent>\n                </CardActionArea>\n                <CardActions>\n                    {(is_active || is_saved) ?\n                        <Button color={'primary'}\n                                onClick={() => forgetAndLogoutBrowser(id)}>\n                            {is_active ? 'Logout' : 'Forget'}\n                        </Button> :\n                        null}\n                </CardActions>\n            </CardContainer>\n        </StyledCard>\n    </>\n};","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import {useEffect, useState} from \"react\";\nimport {Networking} from \"../../util/networking\";\nimport {BROWSERS_URL, getBrowserDetail} from \"./urls\";\nimport {Typography} from \"@material-ui/core\";\nimport {compareDesc, parseJSON} from \"date-fns\";\nimport styled from 'styled-components'\nimport {BrowserCard} from \"./BrowserCard\";\n\nconst Grid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  grid-auto-rows: 1fr;\n  gap: 20px 20px;\n  margin: 20px;\n`;\nconst GridContainer = styled.div`\n  max-width: 1000px;\n`;\n\nexport const Browsers = () => {\n    const [browsers, setDevices] = useState([]);\n\n    const forgetAndLogoutBrowser = id =>\n        Networking.send(getBrowserDetail(id), {method: Networking.DELETE})\n            .then(getBrowsers);\n\n    const getBrowsers = () =>\n        Networking.send(BROWSERS_URL)\n            .then(r => r.json())\n            .then(r => setDevices(r));\n\n    useEffect(() => void getBrowsers(), []);\n\n    return <GridContainer>\n        <Typography variant={'h5'} style={{marginLeft: '10px'}}>Active Browsers</Typography>\n        <Grid>\n            {browsers\n                .filter(e => e.is_active)\n                .sort((a, b) => compareDesc(parseJSON(a.last_activity), parseJSON(b.last_activity)))\n                .map(browser => <BrowserCard\n                    browser={browser}\n                    forgetAndLogoutBrowser={forgetAndLogoutBrowser}\n                />)}\n        </Grid>\n\n        <Typography variant={'h5'} style={{marginLeft: '10px'}}>Inactive Browsers</Typography>\n\n        <Grid>\n            {browsers\n                .filter(e => !e.is_active)\n                .sort((a, b) => compareDesc(parseJSON(a.last_activity), parseJSON(b.last_activity)))\n                .map(browser => <BrowserCard\n                    browser={browser}\n                    forgetAndLogoutBrowser={forgetAndLogoutBrowser}\n                />)}\n        </Grid>\n    </GridContainer>\n};","import {AppBarResponsive} from \"../../shared/AppBarResponsive\";\nimport {useState} from \"react\";\nimport {List, ListItem, ListItemIcon, ListItemText, Typography} from \"@material-ui/core\";\nimport {BackgroundScreen} from \"../../shared/backgroundScreen\";\nimport VpnKeyIcon from '@material-ui/icons/VpnKey';\nimport PublicIcon from '@material-ui/icons/Public';\nimport {TwoFactor} from \"./TwoFactor\";\nimport {Browsers} from \"./Browsers\";\n\nconst SUBMODULES = {\n    BROWSERS: {\n        name: 'Browsers',\n        appDrawer: <>\n            <ListItemIcon>\n                <PublicIcon/>\n            </ListItemIcon>\n            <ListItemText primary={'Browsers'}/>\n        </>,\n        jsx: <Browsers/>\n    },\n    TWOFACTOR: {\n        name: '2FA Settings',\n        appDrawer: <>\n            <ListItemIcon>\n                <VpnKeyIcon/>\n            </ListItemIcon>\n            <ListItemText primary={'2FA Settings'}/>\n        </>,\n        jsx: <TwoFactor/>\n    }\n};\n\nexport const Account = ({returnToMainApp, logout}) => {\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [submodule, setSubmodule] = useState(Object.keys(SUBMODULES)[0]);\n\n    const drawerContent = <List disablePadding>\n        {Object.entries(SUBMODULES).map(([k, v]) =>\n            <ListItem key={k}\n                      button\n                      onClick={() => setSubmodule(k)}\n            >{v.appDrawer}</ListItem>)}\n    </List>;\n\n    return <AppBarResponsive\n        appName={'Account'}\n        drawerOpen={drawerOpen}\n        setDrawerOpen={setDrawerOpen}\n        titleContent={<Typography variant={'h6'}>{SUBMODULES[submodule].name}</Typography>}\n        logout={logout}\n        returnToMainApp={returnToMainApp}\n        drawerContent={drawerContent}\n    >\n        <BackgroundScreen>\n            {SUBMODULES[submodule].jsx}\n        </BackgroundScreen>\n\n    </AppBarResponsive>\n};","import {useState} from \"react\";\nimport {Lists} from \"./modules/Lists/Lists\";\nimport {Literature} from \"./modules/Literature/Literature\";\nimport {StyledButton} from \"./shared/common\";\nimport styled from \"styled-components\";\nimport {BackgroundScreenRounded} from \"./shared/backgroundScreen\";\nimport CallMadeIcon from '@material-ui/icons/CallMade';\nimport {HomeAutomation} from \"./modules/HomeAutomation/HomeAutomation\";\nimport {DVR} from \"./modules/Dvr/DVR\";\nimport {OptionHedgeCalculator} from \"./modules/OptionHedgeCalculator/OptionHedgeCalculator\";\nimport {PasswordTools} from './modules/PasswordTools/PasswordTools'\nimport {Account} from \"./modules/Account/Account\";\n\nconst GDOCS_ATTRACTIONS_URL = 'https://docs.google.com/document/d/1MS6oLLnTWWhdS_FEr1vudNfsnGBMT2V1GtrmHzDd6s0/edit#';\n\n/*LocalStorage key*/\nconst CURRENT_MODULE = 'CURRENT_MODULE';\n\n/*Add new modules here*/\nconst modules = props => ({\n    LISTS: {\n        displayName: 'Lists',\n        jsx: <Lists {...props}/>\n    },\n    LITERATURE: {\n        displayName: 'Literature',\n        jsx: <Literature {...props}/>\n    },\n    ACCOUNT: {\n        displayName: 'Account',\n        jsx: <Account {...props}/>\n    },\n    PASSWORDS: {\n        displayName: 'Password Tools',\n        jsx: <PasswordTools {...props}/>\n    },\n    HOME_AUTOMATION: {\n        displayName: 'Home Automation',\n        jsx: <HomeAutomation {...props}/>\n    },\n    DVR: {\n        displayName: 'DVR',\n        jsx: <DVR {...props}/>\n    },\n    OPTION_HEDGE_CALCULATOR: {\n        displayName: 'Option Hedge Calculator',\n        jsx: <OptionHedgeCalculator {...props}/>\n    },\n});\n\nconst FlexContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: 100vh;\n  margin: 0 auto;\n  max-width: 300px;\n`;\n\nconst InnerContainer = styled(BackgroundScreenRounded)`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\n\nexport const ModuleSelect = ({logout}) => {\n    const [currentModule, setCurrentModule] = useState(localStorage.getItem(CURRENT_MODULE));\n\n    const returnToMainApp = () => {\n        localStorage.removeItem(CURRENT_MODULE);\n        setCurrentModule(null);\n    };\n\n    return currentModule in modules()\n        ? modules({returnToMainApp, logout})[currentModule].jsx\n        : <FlexContainer>\n            <InnerContainer>\n                {\n                    Object.entries(modules()).map(([moduleName, value]) =>\n                        <StyledButton\n                            variant={'outlined'}\n                            color={'primary'}\n                            key={moduleName}\n                            onClick={() => {\n                                localStorage.setItem(CURRENT_MODULE, moduleName);\n                                setCurrentModule(moduleName)\n                            }}\n                        >{value.displayName}</StyledButton>\n                    )\n                }\n                <StyledButton\n                    variant={'outlined'}\n                    color={'primary'}\n                    onClick={() => window.open(GDOCS_ATTRACTIONS_URL, '_blank', 'noopener,noreferrer')}\n                    endIcon={<CallMadeIcon/>}>\n                    Attractions and Food\n                </StyledButton>\n                <StyledButton\n                    variant={'contained'}\n                    color={'primary'}\n                    onClick={logout}>\n                    Logout\n                </StyledButton>\n            </InnerContainer>\n        </FlexContainer>;\n};","import {API_URL} from \"../../globals/urls\";\nimport {Networking} from \"../../util/networking\";\n\nconst MOHH_MAIL_URL = `${API_URL}/hmail/check-mohh-mail/`;\nconst IHIS_MAIL_URL = `${API_URL}/hmail/check-ihis-mail/`;\n\nexport const HMAIL_URL = 'https://www.hmail.sg';\n\nexport const getMohhMail = () => Networking.send(MOHH_MAIL_URL, {method: 'GET'})\n    .then(resp => resp.json());\n\nexport const getIhisMail = () => Networking.send(IHIS_MAIL_URL, {method: 'GET'})\n    .then(resp => resp.json());","import {getIhisMail, getMohhMail, HMAIL_URL} from \"./urls\";\nimport {throttle} from 'lodash'\n\nexport const CHECK_MAIL_FREQUENCY_MS = 30 * 1000;\n\nconst [IHIS, MOHH] = ['IHIS', 'MOHH'];\n\nconst checkMail = ({addNotification, removeNotificationBySource}) => Promise.all([\n    getIhisMail().then(json => {\n        removeNotificationBySource(IHIS);\n        if (json.length > 0) {\n            addNotification({\n                source: IHIS,\n                title: `Unread Mail (${json.length})`,\n                content: [json[0]['from'].join(', '), json[0]['preview']].join(' - '),\n                count: json.length,\n                action: () => window.open(HMAIL_URL, '_blank')\n            })\n        }\n    }),\n\n    getMohhMail().then(json => {\n        removeNotificationBySource(MOHH);\n        if (json.length > 0) {\n            addNotification({\n                source: 'MOHH',\n                title: `Unread Mail (${json.length})`,\n                content: [json[0]['from'].join(', '), json[0]['preview']].join(' - '),\n                count: json.length,\n                action: () => window.open(HMAIL_URL, '_blank')\n            })\n        }\n\n    })\n]);\n\n/*Throttling reduces network calls when the user repeatedly switches tabs*/\nexport const checkMailThrottled = throttle(checkMail, CHECK_MAIL_FREQUENCY_MS, {trailing: false});\n","import {useCallback, useContext, useEffect, useRef} from \"react\";\nimport {NotificationContext} from \"../../shared/NotificationProvider/notificationContext\";\nimport {CHECK_MAIL_FREQUENCY_MS, checkMailThrottled} from \"./checkMailThrottled\";\n\n\nexport const Mail = () => {\n\n    const notificationParams = useContext(NotificationContext);\n    const intervalId = useRef();\n\n    const checkMailAndSetInterval = useCallback(() => {\n        checkMailThrottled(notificationParams);\n        if (!intervalId.current)\n            intervalId.current = setInterval(\n                () => checkMailThrottled(notificationParams),\n                CHECK_MAIL_FREQUENCY_MS);\n    }, [notificationParams])\n\n    const onBlur = useCallback(() => {\n        if (intervalId.current) {\n            clearInterval(intervalId.current);\n            intervalId.current = undefined\n        }\n    }, [])\n\n    useEffect(() => {\n            /*Run once on mount*/\n            checkMailAndSetInterval();\n\n            window.addEventListener('focus', checkMailAndSetInterval);\n            window.addEventListener('blur', onBlur);\n\n            // Remove all listeners/sync on unmount\n            return () => {\n                onBlur();\n                window.removeEventListener('focus', checkMailAndSetInterval);\n                window.removeEventListener('blur', onBlur)\n            }\n        }\n\n        //eslint-disable-next-line\n        , []);\n\n    return null\n};","import {NotificationContext} from './notificationContext'\nimport {useRef, useState} from \"react\";\nimport {noop} from \"../../util/util\";\nimport {Mail} from '../../modules/Mail/Mail'\n\n/*\nThis class handles notifications and also provides notificationContext.\nOnly executed after successful login.\n*/\nexport const NotificationProvider = ({children}) => {\n\n    const [notifications, setNotifications] = useState([]);\n    const nextId = useRef(0);\n\n    const addNotification = ({source, title, content, count = 1, action = noop()}) => {\n        setNotifications(state => [...state, {\n            id: nextId.current,\n            source,\n            title,\n            content,\n            count,\n            timestamp: Date.now(),\n            action,\n        }]);\n        return nextId.current++;\n    };\n\n    const removeNotification = id => setNotifications(state => state.filter(e => e.id !== id));\n    const removeNotificationBySource = source => setNotifications(state => state.filter(e => e.source !== source));\n\n    const notificationParams = {\n        nextId: nextId.current,\n        notifications,\n        addNotification,\n        removeNotification,\n        removeNotificationBySource\n    };\n\n    return <NotificationContext.Provider value={notificationParams}>\n        <Mail/>\n        {children}\n    </NotificationContext.Provider>\n};","import {useEffect} from \"react\";\nimport {Networking} from \"./util/networking\";\nimport {LOGIN_URL} from \"./globals/urls\";\n\nconst SESSION_REFRESH_INTERVAL_MS = 60 * 60 * 1000;\n\n/**\n * Refreshes session every {SESSION_REFRESH_INTERVAL_MS} while tab is open\n * @returns {*}\n * @constructor\n */\nexport const RefreshSession = () => {\n\n    useEffect(() => {\n        let intervalId = setInterval(\n            () => Networking.send(LOGIN_URL, {method: 'GET'}),\n            SESSION_REFRESH_INTERVAL_MS);\n        return () => clearInterval(intervalId)\n    }, []);\n\n    return null\n};","import React, {useEffect, useState} from \"react\";\nimport {LOGIN_URL, LOGOUT_URL, RECAPTCHA_KEY_URL} from \"./globals/urls\";\nimport {Login} from \"./Login\";\nimport {ModuleSelect} from \"./ModuleSelect\";\nimport {Loading} from \"./shared/loading\";\nimport {NotificationProvider} from \"./shared/NotificationProvider/NotificationProvider\";\nimport {Networking} from \"./util/networking\";\nimport {useAsyncError} from \"./util/useAsyncError\";\nimport {RefreshSession} from \"./RefreshSession\";\nimport {NetworkState, NetworkStateSnackbar} from \"./NetworkStateSnackbar\";\n\n/* Checks if user is logged in, as well as sets global NetworkState callbacks*/\nexport const LoginCheckAndNetworkState = () => {\n\n    const [loggedIn, setLoggedIn] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [networkError, setNetworkError] = useState();\n    const [recaptchaKey, setRecaptchaKey] = useState('');\n    const setError = useAsyncError();\n\n    const fetchRecaptchaKey = () => void Networking.send(RECAPTCHA_KEY_URL)\n        .then(r => r.json())\n        .then(r => void setRecaptchaKey(r['key']));\n\n\n    const logout = () => {\n        localStorage.clear(); // Clear localStorage if called\n        Networking\n            .send(LOGOUT_URL, {method: 'POST'})\n            .then(() => {\n                setNetworkError(undefined);\n                setLoggedIn(false);\n\n                /*If the user refreshed the page while logged in, the recaptcha key\n                * would not have been fetched*/\n                if (!recaptchaKey)\n                    fetchRecaptchaKey()\n            })\n    };\n\n\n    useEffect(() => {\n\n        /*Setup global callback to notify user of 4xx/5xx errors.*/\n        NetworkState.throwError = error => setNetworkError(error);\n\n        /*Check if user is logged in*/\n        fetch(LOGIN_URL, {\n            method: 'GET',\n            credentials: 'include',\n            headers: {Accept: 'application/json'}\n        }).then(r => {\n            setLoading(false);\n            if (r.ok) setLoggedIn(true);\n            else if ([401, 403].includes(r.status)) {\n                /*User is not logged in, get reCAPTCHA key*/\n                fetchRecaptchaKey()\n            } else {\n                /*Throw on other, non 401/403 errors*/\n                setError(`HTTP Error ${r.status}: ${r.statusText}`)\n            }\n        })\n    }, [setError]);\n\n    if (loading || (!loggedIn && !recaptchaKey))\n        return <Loading\n            open={true}\n            message={'Checking authentication...'}\n            fullscreen={true}/>;\n\n    if (!loggedIn)\n        return <Login setLoggedIn={setLoggedIn} recaptchaKey={recaptchaKey}/>;\n\n    /*User is authenticated*/\n    return <>\n        {networkError &&\n        <NetworkStateSnackbar\n            logout={logout}\n            networkError={networkError}\n            setNetworkError={setNetworkError}\n        />}\n        <RefreshSession/>\n        <NotificationProvider>\n            <ModuleSelect logout={logout}/>\n        </NotificationProvider>\n    </>;\n};\n","import ReactDOM from 'react-dom';\nimport {StrictMode} from \"react\";\nimport '@fontsource/roboto/300.css'\nimport '@fontsource/roboto/400.css'\nimport '@fontsource/roboto/500.css'\nimport '@fontsource/roboto/700.css'\nimport '@fontsource/source-sans-pro' //For codemirror in MarkdownEditor.js\nimport './fonts/starcraft/starcraft.css' //Stylized font for menu\nimport {MuiThemeProvider} from \"@material-ui/core\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport {LoadServiceWorker} from \"./LoadServiceWorker\";\nimport {ErrorBoundary} from \"./ErrorBoundary\";\nimport 'overlayscrollbars/css/OverlayScrollbars.css'\nimport {theme} from \"./globals/theme\";\nimport {RandomBackground} from \"./shared/randomBackground\";\nimport {LoginCheckAndNetworkState} from \"./LoginCheckAndNetworkState\";\n\n/*Decide whether to run mock service worker for debugging*/\nconst USE_MOCK_SERVICE_WORKER = false;\nif (process.env.NODE_ENV === 'development' && USE_MOCK_SERVICE_WORKER) {\n    const {worker} = require('./test/mocks/browser');\n    worker.start()\n}\n\nReactDOM.render(\n    <StrictMode>\n        <MuiThemeProvider theme={theme}>\n            <CssBaseline/>\n            <RandomBackground/>\n            <ErrorBoundary>\n                <LoadServiceWorker/>\n                <LoginCheckAndNetworkState/>\n            </ErrorBoundary>\n        </MuiThemeProvider>\n    </StrictMode>\n    , document.getElementById('root'));\n\n\n\n"],"sourceRoot":""}