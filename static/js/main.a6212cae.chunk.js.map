{"version":3,"sources":["app/load-service-worker/LoadServiceWorker.js","shared/components/GenericList/BaseItemEdit.js","shared/util.js","shared/useAsyncError.js","app/error-boundary/ErrorBoundary.js","app/theme.js","app/constants.js","app/network-core/baseQuery.js","app/network-core/baseApi.js","modules/Hmail/hmailApi.js","app/notifications/notificationSlice.js","modules/Hmail/hmailActions.js","modules/Hmail/Hmail.js","app/auth/authApi.js","app/appSlice.js","shared/generateCrudApi.js","modules/Literature/literatureApi.js","modules/Literature/schema.js","modules/Literature/literatureSlice.js","shared/components/AddButton.js","shared/useAutosave.js","shared/components/DialogBlurResponsive.js","shared/components/GenericList/ItemSkeleton.js","shared/components/backgroundScreen.js","shared/components/GenericList/StyledListItem.js","shared/components/GenericList/StyledListItemSecondaryAction.js","shared/components/GenericList/BaseListItem.js","shared/components/GenericList/BaseList.js","shared/components/GenericList/GenericList.js","shared/components/Loading.js","shared/components/AutocompleteWithCreate.js","shared/components/textFieldClearable.js","shared/components/textFieldMultilineEllipsis.js","modules/Literature/utils.js","modules/Literature/AddBook.js","modules/Literature/BookResult.js","modules/Literature/SearchBooks.js","modules/Literature/Books.js","modules/Literature/GenreEdit.js","modules/Literature/GenreTreeView.js","modules/Literature/submodules.js","modules/Literature/Genres.js","modules/Account/accountApi.js","modules/Account/BrowserCard.js","shared/static/browserLogos/chrome.png","shared/static/browserLogos/firefox.png","shared/static/browserLogos/edge.png","shared/static/browserLogos/safari.png","modules/Account/Browsers.js","modules/Account/TwoFactor.js","modules/Account/Account.js","modules/Dvr/dvrApi.js","modules/Dvr/Dvr.js","modules/Testing/testingApi.js","modules/Testing/util.js","modules/Testing/Testing.js","modules/PasswordTools/passwordUtil.js","modules/PasswordTools/passwordToolsApi.js","modules/PasswordTools/PasswordTools.js","modules/HomeAutomation/homeAutomationApi.js","modules/HomeAutomation/HomeAutomation.js","shared/components/textFieldClearableInfo.js","modules/OptionHedgeCalculator/TextFieldClearableInfoCurrency.js","modules/OptionHedgeCalculator/FieldUseWatch.js","modules/OptionHedgeCalculator/optionHedgeCalculatorApi.js","modules/OptionHedgeCalculator/explanatoryText.js","modules/OptionHedgeCalculator/OptionHedgeCalculator.js","modules/OptionHedgeCalculator/textFieldRefreshLoading.js","modules/Lists/listApi.js","modules/Lists/List.js","shared/components/MarkdownEditor/scrollPastEnd.js","shared/components/MarkdownEditor/MarkdownEditor.js","modules/Lists/ListItemEdit.js","modules/Lists/listsSlice.js","modules/Lists/ListItems.js","modules/Lists/Lists.js","app/modules/modules.js","modules/Literature/Literature.js","app/urls.js","app/modules/ModuleSelect.js","app/notifications/NotificationMenu.js","app/app-bar/AppBarDrawer.js","app/app-bar/AppBarNetworkLoading.js","app/app-bar/AppBar.js","app/starfield/spriteShaderMaterial.js","app/starfield/zoomShader.js","app/starfield/Starfield.js","app/auth/Login.js","app/refresh-session/RefreshSession.js","app/App.js","app/network-error/networkErrorMiddleware.js","app/network-loading/networkLoadingMiddleware.js","app/store.js","shared/components/AlertSnackbarWithDialog.js","app/network-error/NetworkError.js","shared/components/randomBackground.js","index.js"],"names":["Component","defaultFieldValues","sanitizeString","string","removeAccents","trim","toLowerCase","getRandomInt","min","max","seed","undefined","Math","ceil","floor","rng","seedrandom","random","formatDistanceToNowPretty","date","differenceInMinutes","Date","formatDistanceToNow","addSuffix","differenceInCalendarDays","formatDistanceToNowStrict","differenceInCalendarYears","format","isLocalhost","Boolean","window","location","hostname","match","noop","stripHtml","html","DOMParser","parseFromString","body","textContent","stripUndefined","obj","isPlainObject","copy","Object","entries","k","joinUrl","base","url","String","replace","hasServiceWorker","navigator","wb","Workbox","NoServiceWorker","useState","sbOpen","setSbOpen","Snackbar","open","onClose","autoHideDuration","Alert","severity","LoadServiceWorker","intervalId","useRef","registration","text","actions","details","setDetails","setError","useCallback","e","Error","useAsyncError","reloadPage","reload","onInstalled","event","isUpdate","console","log","onControlling","onActivated","onUpdate","current","waiting","Button","variant","color","onClick","messageSW","type","clearInterval","onError","error","toString","useEffect","addEventListener","register","then","r","catch","setInterval","update","ClickAwayListenerProps","onClickAway","action","StyledDialog","muiStyled","Dialog","theme","zIndex","snackbar","ErrorBoundary","props","setDialogOpen","state","setState","dialogOpen","errorInfo","this","scroll","DialogTitle","DialogContent","DialogContentText","componentStack","DialogActions","children","createMuiTheme","palette","primary","main","secondary","OverlayScrollbarOptions","className","overflowBehavior","x","scrollbars","autoHide","NETWORK_ERROR","defaultValidateStatus","response","status","responseHandler","headers","get","startsWith","json","baseQuery","baseUrl","defaultHeaders","prepareHeaders","fetchFn","fetch","baseFetchOptions","a","arg","signal","getState","method","Headers","params","validateStatus","config","JSON","stringify","divider","indexOf","query","URLSearchParams","request","Request","requestClone","clone","responseClone","meta","resultData","data","name","message","baseQueryWithRetry","baseQueryOptions","retry","fail","maxRetries","baseApi","createApi","reducerPath","credentials","endpoints","hmailApi","injectEndpoints","build","checkIhisMail","checkMohhMail","useCheckIhisMailQuery","useCheckMohhMailQuery","notificationsSliceName","shape","notificationSlice","createSlice","initialState","reducers","addNotifications","reducer","payload","every","item","keys","includes","validateShape","push","prepare","id","nanoid","timestamp","now","Array","isArray","map","removeNotification","filter","removeNotificationsFromSource","source","selectNotificationsSorted","createSelector","items","slice","sort","b","handleMailAction","dispatch","parseJSON","title","content","isToday","from","join","preview","getTime","Hmail","useDispatch","ihisMail","pollingInterval","mohhMail","authApi","checkLogin","login","mutation","logout","useCheckLoginQuery","useLoginMutation","useRecaptchaKeyQuery","useLogoutMutation","appSliceName","handleLoginFulfilled","user","expiry","isSuperUser","is_superuser","recaptchaKey","recaptcha_key","loginStatus","loggedIn","appSlice","module","networkError","pendingNetworkActions","setNetworkError","clearNetworkError","setCurrentModule","setAppBar","drawerOpen","appBar","addNetworkAction","removeNetworkAction","splice","extraReducers","builder","addMatcher","matchFulfilled","isAllOf","matchRejected","isRejectedWithValue","localStorage","clear","selectLoginStatus","selectNetworkError","selectCurrentModule","selectPendingNetworkActions","BaseGetCreateSkeleton","queryArg","isSkeleton","generateCrudApi","api","create","_delete","delete","getCreateSkeleton","onQueryStarted","queryFulfilled","result","util","updateQueryData","draft","unshift","undo","find","assign","generateStub","bookApi","authorApi","genreApi","typeApi","literatureApi","searchBook","q","transformResponse","resp","results","googleBookInfo","isbn","goodreadsBookInfo","work_id","workId","book_id","bookId","useSearchBookMutation","useGoodreadsBookInfoMutation","useGoogleBookInfoMutation","useGetBooksQuery","useCreateBookMutation","useUpdateBookMutation","useDeleteBookMutation","useGetAuthorsQuery","useCreateAuthorMutation","useUpdateAuthorMutation","useDeleteAuthorMutation","useGetGenresQuery","useCreateGenreMutation","useUpdateGenreMutation","useDeleteGenreMutation","useGetTypesQuery","useCreateTypeMutation","useUpdateTypeMutation","useDeleteTypeMutation","BOOK_SCHEMA","authors","yupSchema","yup","required","notes","ensure","defaultValue","transformToServer","val","transformFromServer","genres","typeError","types","description","read_next","date_read","nullable","formatISO","representation","parseISO","image_url","published","integer","transform","origVal","isNumber","google_id","goodreads_book_id","series","series_position","rating","round","my_review","BOOK_FIELDS","fromEntries","YUP_SCHEMA","noUnknown","DEFAULT_BOOK_VALUES","v","literaturePath","submodule","displayedColumns","literatureSlice","setLiteratureSubmodule","setDisplayedColumn","column","display","selectLiteratureSubmodule","selectDisplayedColumns","StyledFab","styled","Fab","AddButton","useAutosave","createItem","updateItem","deleteItem","itemIsEmpty","wait","maxWait","pendingData","creationInProgress","flushing","updateOrDelete","_onChange","newId","onChange","debounce","flush","breakpoints","down","StyledOverlayScrollbarsComponent","OverlayScrollbarsComponent","DialogBlurResponsive","footer","fullscreen","maxWidth","disableScrollLock","disablePortal","$fullscreen","options","FooterRight","div","Footer","StyledTextField","TextField","ItemSkeleton","ListItemText","Skeleton","animation","width","BACKGROUND_COLOR","BackgroundScreen","BackgroundScreenRounded","StyledListItem","ListItem","$hideBackground","up","$reserveSpace","StyledListItemSecondaryAction","ListItemSecondaryAction","BaseListItem","primaryTextKey","secondaryTextKey","context","deleteItemMutation","itemIdField","setEditingItem","len","primaryText","secondaryText","closeDialog","length","button","secondaryTypographyProps","noWrap","IconButton","edge","stopPropagation","StyledDiv","DefaultItem","BaseList","Item","loading","disablePadding","dense","_","idx","itemsArray","totalCount","itemContent","components","List","forwardRef","ref","DefaultItemEdit","editingItem","closeEdit","isItemEmpty","createItemMutation","updateItemMutation","useMemo","useAutosaveOptions","unwrap","res","useForm","defaultValues","getValues","setValue","forEach","key","label","capitalize","multiline","fullWidth","autoFocus","target","value","DefaultList","GenericList","getItemsQuery","defaultItemValues","ItemEdit","isFetching","StyledBackdrop","Backdrop","drawer","FlexContainer","FlexBackgroundScreen","Loading","showSpinner","CircularProgress","size","Typography","StyledCircularProgress","AutocompleteWithCreate","createOption","getOptionLabel","getOptionSelected","getValue","helperText","maxOptionsToShow","multiple","renderProps","setLoading","sanitizedOptionLabels","flow","Autocomplete","clearOnBlur","disabled","filterOptions","input","inputValue","filtered","matchSorter","_name","_isNew","_justAdded","freeSolo","option","newValue","el","renderInput","InputProps","endAdornment","renderOption","renderTags","tagValue","getTagProps","index","onDelete","rest","Chip","deleteIcon","TextFieldClearable","InputAdornment","position","style","cursor","$ellipsis","TextFieldMultilineEllipsis","onBlur","onFocus","focused","setFocused","focusPos","setFocusPos","inputRef","focus","setSelectionRange","selectionStart","NumberCircle","span","recursiveSort","arr","compareFn","childrenKey","mapped","mapGenres","ancestors","currentEl","parent","p","getAncestors","fullName","getTreeDataFromGenres","books","genreMap","Map","root","bookCountForGenre","set","expanded","bookCount","node","disableGutters","addCount","numToAdd","FieldContainer","ButtonFlexDiv","AddBook","dataTypes","bookData","setAddedSnackbar","createBook","updateBook","createAuthor","createGenre","createType","resolver","yupResolver","isEmpty","mode","handleSubmit","control","isDirty","formState","watch","errorSnackbar","setErrorSnackbar","saveDialog","setSaveDialog","infoDialog","setInfoDialog","sortedGenres","localeCompare","onSubmit","originalData","userData","isEqual","pick","transformedData","handleDiscard","tabIndex","StandardField","getComponentProps","render","controllerProps","field","fieldState","gridArea","component","autoComplete","autoHighlight","filterSelectedOptions","groupBy","marginLeft","FormControlLabel","checked","Checkbox","labelPlacement","FormHelperText","MuiPickersUtilsProvider","utils","DateFns","KeyboardDatePicker","autoOk","disableFuture","placeholder","inputVariant","StyledCard","Card","StyledCardContent","CardContent","Description","$empty","$maxHeight","StyledActionArea","CardActionArea","Image","img","ImageContainer","Title","Authors","BookResult","onSearchResultClick","searchLoading","detailView","setDetailView","maxHeight","setMaxHeight","offsetHeight","align","src","alt","reduce","acc","cur","CardActions","BookResults","StyledForm","form","SearchBooks","closeSearch","setBookData","search","searchResults","isLoading","getGoogleBookInfo","googleBookInfoLoading","getGoodreadsBookInfo","goodreadsBookInfoLoading","getBookInfoAndCreateAuthors","book","goodreads_work_id","ISBN_10","ISBN_13","searchMutation","apiBookInfo","mergedBook","mergeWith","objVal","srcVal","existingAuthors","authorsToCreate","mergedBookAuthor","author","existingAuthor","Promise","all","createdAuthors","bookTemplate","preventDefault","elements","startAdornment","StyledTableContainer","TableContainer","FormContainer","StyledFooter","GenreEdit","updateGenre","deleteGenre","deleteDialog","setDeleteDialog","genresWithNull","ownIdx","findIndex","parseData","disableClearable","opt","StyledSortableTree","SortableTree","Container","GenreTreeView","treeState","setTreeState","canDrop","prevParent","nextParent","getNodeKey","onMoveNode","nextParentNode","rowHeight","treeData","isVirtualized","submodules","BOOKS","Icon","HomeIcon","jsx","useSelector","booksLoading","authorsLoading","genresLoading","typesLoading","deleteBook","searchBookOpen","setSearchBookOpen","addedSnackbar","filteredItemsLength","setFilteredItemsLength","numBooksToShow","setNumBooksToShow","dateOptions","subWeeks","subMonths","subYears","count","customFooter","bottomOffset","scrollableAncestor","onEnter","row","customSearchRender","debounceSearchRender","draggableColumns","enabled","onFilterChange","onRowClick","rowData","dataIndex","onRowsDelete","rowsDeleted","newTableData","onTableChange","tableState","displayData","onViewColumnsChange","changedColumn","pagination","responsive","setTableProps","padding","searchPlaceholder","tableBodyMaxHeight","columns","searchable","customBodyRenderLite","customFilterListOptions","filterType","logic","filters","some","filterList","renderValue","date_added","isBefore","sortDescFirst","Set","updated","sortThirdClickReset","ThemeProvider","overrides","MUIDataTable","paper","backgroundColor","MUIDataTableHeadCell","fixedHeader","MUIDataTableSelectCell","headerCell","MuiGrid","MUIDataTableToolbar","filterPaper","AUTHORS","PeopleIcon","GENRES","InsertDriveFileIcon","setTitleEndAdornment","genreInfoDialogOpen","setGenreInfoDialogOpen","fullScreen","TYPES","TitleIcon","enhanceEndpoints","addTagTypes","accountApi","getBrowsers","providesTags","forgetAndLogoutBrowser","invalidatesTags","getOtpStatus","modify2Fa","useGetBrowsersQuery","useForgetAndLogoutBrowserMutation","useGetOtpStatusQuery","useModify2FaMutation","$thisDevice","StyledTypography","ImageDiv","SavedBrowserDiv","BrowserLogoDiv","$image","CardContainer","BrowserLogo","Chrome","Firefox","Edge","Safari","BrowserCard","browser","is_active","is_current_session","is_saved","first_login","last_activity","ip","country_code","user_agent","prettifiedUserAgent","uaString","ua","UAParser","browserName","device","model","os","osName","osVersion","version","isMobile","prettifyUAString","getName","overflowWrap","Grid","GridContainer","Browsers","browsers","compareDesc","TwoFactor","otp","setOtp","secret","setSecret","otpStatus","href","SUBMODULES","BROWSERS","appDrawer","ListItemIcon","TWOFACTOR","useGetOrRefreshChannelQuery","getOrRefreshChannel","channel","CHANNELS","VideoDiv","StyledVideo","video","testingApi","throwHttpError","throwFetchError","queryFn","extraOptions","mutationTest","useThrowHttpErrorMutation","useThrowFetchErrorMutation","useMutationTestMutation","throwAsyncThunkReject","createAsyncThunk","throwAsyncThunkRejectWithValue","rejectWithValue","DIGITS_REGEX","LOWER_REGEX","UPPER_REGEX","SYMBOLS_REGEX","DIGITS","LOWER","UPPER","SYMBOLS","secureRandom","crypto","Uint32Array","getRandomValues","randint","floor_min","floor_max","choice","getSecureRandom","formatNumber","Intl","NumberFormat","maximumFractionDigits","maximumSignificantDigits","getEntropy","password","hasDigits","test","hasLowerCase","hasUpperCase","hasSymbols","totalSymbols","bitsPerChar","log2","totalEntropy","generatePassword","digits","lower","upper","symbols","charSet","generate","getSha1Hash","msgUint8","TextEncoder","encode","subtle","digest","hashBuffer","hashArray","Uint8Array","padStart","toUpperCase","generateUsername","vowels","cons","num_vowels","num_cons","i","substr","useHibpLookupMutation","hibpLookup","hash","TextFieldContainer","StyledIconButton","OptionsFormGroup","FormGroup","PasswordDetailGrid","GreenCheck","CheckIcon","GreyCross","ClearIcon","formatDecimal","useSendCommandMutation","sendCommand","command","StyledContainer","COMMANDS","gate_toggle","ac_off","ac_on_24","ac_on_25","ceiling_fan_on","ceiling_fan_off","dyson_fan_on","dyson_fan_off","TextFieldClearableInfo","info","Tooltip","arrow","enterTouchDelay","interactive","CleaveTextField","htmlRef","FieldUseWatch","fieldsToWatch","fields","useWatch","useGetSpyPriceQuery","getSpyPrice","explanatoryText","marked","FIELDS","emptyStringToUndefined","schema","portfolioValue","positive","spyPrice","hedgeRatio","delta","StyledTextFieldClearableInfo","StyledTextFieldRefresh","onRefresh","tooltipText","onOpen","StyledTextFieldClearableInfoCurrency","InputLabelProps","shrink","inputComponent","inputProps","numeral","prefix","rawValueTrimPrefix","rawValue","formatNoDecimals","formatDecimals","formatDollars","currency","currencyDisplay","listApi","getLists","createList","updateList","deleteList","getItems","list","tasklist","useGetListsQuery","useCreateListMutation","useUpdateListMutation","useDeleteListMutation","useGetItemsQuery","useCreateItemMutation","useUpdateItemMutation","useDeleteItemMutation","anchorEl","setAnchorEl","func","MenuItem","newTitle","prompt","primaryTypographyProps","currentTarget","updateBottomMargin","cm","lineCount","scrollPastEndPadding","lineSpace","parentNode","paddingBottom","off","setSize","on","change","CodeMirror","changeEnd","line","lastLine","defineOption","old","Init","MarkdownEditor","instance","setInstance","initialValue","setInitialValue","loaded","setLoaded","refresh","highlightFormatting","lineNumbers","lineWrapping","indentWithTabs","viewportMargin","Infinity","autoCloseBrackets","matchBrackets","styleSelectedText","styleActiveLine","autoRefresh","scrollPastEnd","editorDidMount","editor","ListItemEdit","useTheme","useMediaQuery","createItemStarted","startedTimeStamp","updateItemStarted","initialTitle","initialNotes","lastSavedTimeString","lastCreatedTimeString","created","newVal","listsPath","listsSlice","currentList","setCurrentList","selectCurrentList","ListItems","StyledButton","margin","MODULES","LISTS","menuName","onlySuperUser","element","setDrawerContent","setTitleContent","lists","isLoadingLists","refetchLists","refetch","skip","isFetchingGetItems","refetchItems","LITERATURE","refetchBooks","isFetchingBooks","refetchAuthors","isFetchingAuthors","refetchGenres","isFetchingGenres","refetchTypes","isFetchingTypes","literatureSubmodule","titleEndAdornment","DndProvider","backend","HTML5Backend","React","createElement","ACCOUNT","setSubmodule","PASSWORDS","lookupHibp","hashCount","dialogType","passwordSettings","usernameSettings","settings","setSettings","username","setUsername","setPassword","snackbarOpen","setSnackbarOpen","entropy","setEntropy","secondsToBruteforce","generatedPassword","seconds","checkHibp","passwordStr","copyToClipboard","clipboard","writeText","setTimeout","onPasswordChange","closeSettings","Slider","step","FormControl","anchorOrigin","vertical","horizontal","Number","isFinite","formatDistance","HOME_AUTOMATION","setSnackbar","setDisabled","InputLabel","Select","DVR","setSidebarName","setChannel","player","load","uuid","getChannelUrl","stream_uuid","shaka","polyfill","installAll","unload","destroy","switchChannel","videoEl","Player","isBrowserSupported","detail","ui","Overlay","getControls","autoPlay","OPTION_HEDGE_CALCULATOR","fulfilledTimeStamp","setTooltipText","c","shouldValidate","dangerouslySetInnerHTML","__html","TEST","mutationData","OuterContainer","ModulesContainer","ModuleSelect","modules","moduleKey","endIcon","StyledChip","StyledPopover","Popover","StyledSpan","NotificationMenu","notifications","Badge","badgeContent","transformOrigin","Fragment","disableTypography","Divider","OverlayScrollbarsWithMaxWidth","$width","AppNameDiv","TransparentDrawer","Drawer","$transparent","AppBarDrawer","drawerWidth","setDrawerOpen","sidebarName","mobile","closeAppBar","AppBarNetworkLoading","TransparentAppBar","MuiAppBar","DrawerContainer","flexShrink","ContentContainer","ContentDiv","AppBar","drawerContent","titleContent","appBarProps","useLayoutEffect","Toolbar","flex","SpriteShaderMaterial","shaderMaterial","uTime","uTexture","extend","ZoomShader","uniforms","tDiffuse","center","Vector2","strength","vertexShader","fragmentShader","UnrealBloomPass","RenderPass","ShaderPass","EffectComposer","showZoom","POINTS_COUNT","innerWidth","COLORS","fieldX","innerHeight","FullscreenDiv","Main","texture","useTexture","points","Vector3","cameraVec","composer","useThree","scene","gl","height","camera","zoomShader","timeFactor","positionArray","Float32Array","sizesArray","colorsArray","pointPosition","fieldY","Color","toArray","positions","sizes","colors","useFrame","mouse","lerp","y","attach","args","attachObject","array","itemSize","blending","depthTest","attachArray","Starfield","fov","$blur","InnerContainer","Spacer","Login","refetchOnMountOrArgChange","isError","save_browser","recaptchaRef","loginMessage","setLoginMessage","otpRequired","setOtpRequired","executeAsync","token","otp_required","reset","gutterBottom","inputMode","pattern","sitekey","RefreshSession","refetchOnReconnect","App","fallback","Loader","networkErrorMiddleware","next","isRejected","condition","warn","networkLoadingMiddleware","isPending","requestId","isAnyOf","isFulfilled","store","configureStore","appPath","notificationsPath","middleware","getDefaultMiddleware","concat","setupListeners","AlertSnackbarWithDialog","snackbarText","dialogTitle","dialogContent","dialogEnabled","whiteSpace","fontSize","NetworkError","formattedTimestamp","RandomBackgroundImage","$picIndex","getPicIndex","NUM_IMAGES","RandomBackground","picIndex","setPicIndex","listener","removeEventListener","resolve","ReactDOM","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.a6212cae.chunk.js","sourcesContent":["import {messageSW, Workbox} from \"workbox-window\";\nimport {useEffect, useRef, useState} from 'react';\nimport {Button, Snackbar} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport {useAsyncError} from \"../../shared/useAsyncError\";\nimport {isLocalhost, noop} from \"../../shared/util\";\n\n// https://developers.google.com/web/tools/workbox/modules/workbox-window#important_service_worker_lifecycle_moments\n\nconst hasServiceWorker = () => 'serviceWorker' in navigator;\n\n// Workbox() calls navigator.serviceWorker which is undefined in Firefox private browsing.\nconst wb = hasServiceWorker() ? new Workbox('./service-worker.js') : null;\n\nconst NoServiceWorker = () => {\n    const [sbOpen, setSbOpen] = useState(true);\n\n    return <Snackbar\n        open={sbOpen}\n        onClose={() => setSbOpen(false)}\n        autoHideDuration={3000}>\n        <Alert\n            severity={'info'}\n            onClose={() => setSbOpen(false)}>\n            {'load-service-worker is not supported in your browser'}\n        </Alert>\n    </Snackbar>\n};\n\nconst withBrowserCheck = Component => {\n    return hasServiceWorker()\n    ? Component\n    : NoServiceWorker;\n};\n\n\nconst ServiceWorkerMain = () => {\n\n    const intervalId = useRef();\n    const registration = useRef({});\n    const [sbOpen, setSbOpen] = useState(false);\n    const [details, setDetails] = useState({\n        text: '',\n        severity: 'info',\n        actions: undefined,\n        autoHideDuration: 3000,\n    });\n\n    const setError = useAsyncError();\n\n    const reloadPage = () => {\n        setSbOpen(false);\n        window.location.reload()\n    };\n\n    const onInstalled = (event) => {\n        //\n        if (!event.isUpdate) {\n            setSbOpen(true);\n            setDetails({\n                text: 'Site is now available offline.',\n                severity: 'info',\n                autoHideDuration: 3000,\n            });\n            console.log('Installed, isUpdate false');\n        } else\n            console.log('Installed, isUpdate true')\n    };\n\n    const onControlling = event => {\n        if (event.isUpdate)\n            console.log('Controlling, isUpdate false');\n        else\n            console.log('Controlling, isUpdate true')\n    };\n\n    const onActivated = event => {\n        if (event.isUpdate)\n            console.log('Activated, isUpdate false');\n        else\n            console.log('Activated, isUpdate true')\n    };\n\n    const onUpdate = () => {\n        /*Deactivates the previous service worker and starts running the new one, ready for requests\n        * Regardless of the user's decision, the next reload will result in a new page.\n        * The new sw instance must be messaged for this to work.\n        * This is obtained from 'registration' set during registration of the new sw.\n        * For some reason wb.messageSW messages the old SW instead.*/\n        if (registration.current?.waiting) {\n            //Prompt user\n            setSbOpen(true);\n            setDetails({\n                text: 'Site has been updated. Reload page?',\n                severity: 'info',\n                autoHideDuration: null,\n                actions: <>\n                    <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={() => setSbOpen(false)}\n                    >No</Button>\n                    <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={reloadPage}\n                    >Yes</Button>\n                </>\n            });\n\n            messageSW(registration.current.waiting, {type: 'SKIP_WAITING'});\n            clearInterval(intervalId.current);\n            console.log('Waiting for activation, newer version available');\n        }\n    };\n\n    const onError = error => {\n        setSbOpen(true);\n        setDetails({\n            text: `Service worker update failed: ${error.toString()}`,\n            autoHideDuration: null,\n            severity: 'error',\n        });\n        console.log('Service worker update failed: ', error)\n    };\n\n    const onLocalhost = () => {\n        setSbOpen(true);\n        setDetails({\n            text: 'On localhost, service worker registration skipped',\n            autoHideDuration: 3000,\n            severity: 'info'\n        });\n        console.log('On localhost, service worker registration skipped.')\n    };\n\n    useEffect(() => {\n\n        // Skip SW registration if on localhost\n        if (isLocalhost) {\n            onLocalhost();\n            return;\n        }\n\n\n        wb.addEventListener('controlling', onControlling);\n        wb.addEventListener('activated', onActivated);\n        wb.addEventListener('installed', onInstalled);\n        wb.addEventListener('waiting', onUpdate);\n        wb.addEventListener('externalwaiting', onUpdate); // Any other different version\n\n        // Throw errors during registration\n        wb.register().then(r => registration.current = r).catch(e => setError(e));\n\n        // Service worker updates are checked on initial load\n        intervalId.current = setInterval(() => {\n            console.log('Checking for service worker updates...');\n\n            // Show snackbar on update failure, rather than throwing error\n            wb.update().catch(onError)\n        }, 5 * 60 * 1000);\n\n        // eslint-disable-next-line\n    }, []);\n\n    return <Snackbar\n        open={sbOpen}\n        ClickAwayListenerProps={{onClickAway: noop}}\n        onClose={() => setSbOpen(false)}\n        autoHideDuration={details.autoHideDuration}>\n        <Alert\n            severity={details.severity}\n            action={details.actions}\n            onClose={() => setSbOpen(false)}>\n            {details.text}\n        </Alert>\n    </Snackbar>;\n};\n\nexport const LoadServiceWorker = withBrowserCheck(ServiceWorkerMain);","import { Button, TextField } from \"@material-ui/core\";\nimport { capitalize } from 'lodash';\nimport { useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport styled from \"styled-components\";\nimport { useAutosave } from './../../useAutosave';\nimport { DialogBlurResponsive } from '../DialogBlurResponsive';\n\nconst FooterRight = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n`;\n\nconst Footer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-left: 10px;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 5px 0;\n`;\n\n/*A generic item editor with useAutosave\nWill not trigger `updateItem` if value in first field of defaultFieldValues is blank*/\nexport const BaseItemEdit =\n    defaultFieldValues =>\n        function BaseItemEditComponent({\n            editingItem,\n            closeEdit,\n            context,\n            isItemEmpty,\n            itemIdField,\n            createItemMutation,\n            updateItemMutation,\n            deleteItemMutation,\n        }) {\n\n            const [createItem] = createItemMutation()\n            const [updateItem] = updateItemMutation()\n            const [deleteItem] = deleteItemMutation()\n            \n            const keys = useMemo(() => Object.keys(defaultFieldValues), [])\n\n            const useAutosaveOptions = useMemo(() => ({\n                id: editingItem[itemIdField], // if undefined, will create new item\n                updateItem: (id, data) => {\n                    if (!data[keys[0]]) return\n                    updateItem({ [itemIdField]: id, ...context, ...data })\n                },\n                createItem: data => createItem({ ...context, ...data }).unwrap().then(res => res[itemIdField]),\n                deleteItem: id => deleteItem({ ...context, [itemIdField]: id }),\n                itemIsEmpty: isItemEmpty,\n            }), [context, createItem, deleteItem, editingItem, isItemEmpty, itemIdField, keys, updateItem])\n\n\n            const { onChange, flush } = useAutosave(useAutosaveOptions)\n\n            const { register, getValues, setValue } = useForm({ defaultValues: editingItem[itemIdField] ? editingItem : defaultFieldValues });\n\n            keys.forEach(register)\n\n            const onClose = () => {\n                flush()\n                closeEdit()\n            }\n\n            return <DialogBlurResponsive\n                open\n                onClose={onClose}\n                footer={<Footer>\n                    <FooterRight>\n                        <Button\n                            variant={'text'}\n                            color={'primary'}\n                            onClick={onClose}>\n                            Close\n                        </Button>\n                    </FooterRight>\n                </Footer>}>\n                {keys.map((key, idx) => <StyledTextField\n                    label={capitalize(key)}\n                    multiline\n                    fullWidth\n                    name={key}\n                    key={key}\n                    defaultValue={editingItem[key]}\n                    autoFocus={idx === 0 && isItemEmpty(editingItem)}\n                    variant={'outlined'}\n                    onChange={e => {\n                        setValue(key, e.target.value);\n                        onChange(getValues())\n                    }}\n                />)}\n\n            </DialogBlurResponsive>\n        };\n","/**\n * Utility functions.\n * Larger functions should be in their own file.\n */\nimport removeAccents from \"remove-accents\"\nimport seedrandom from 'seedrandom'\nimport {\n    differenceInCalendarDays,\n    differenceInCalendarYears,\n    differenceInMinutes,\n    format,\n    formatDistanceToNow,\n    formatDistanceToNowStrict\n} from \"date-fns\";\nimport UAParser from \"ua-parser-js\";\nimport {isPlainObject} from \"@reduxjs/toolkit\";\n\n/**\n * Strip accents, empty spaces and lowercase a string (for comparison purposes)\n * undefined/null returns an empty string\n * @param {String} string\n */\nexport const sanitizeString = string =>\n    string ? removeAccents(string).trim().toLowerCase() : ''\n;\n\nexport const isEmpty = string => !Boolean(string?.trim());\n\n/**\n * Returns a seeded random number between min (inclusive) and max (exclusive)\n * @param min\n * @param max\n * @param seed optional, will use seeded RNG if present\n */\nexport const getRandomInt = (min, max, seed=undefined) => {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    let rng = seed ? seedrandom(seed) : Math.random;\n    return Math.floor(rng() * (max - min) + min)\n};\n\n/**\n * Days since Unix Epoch\n * Works properly so far (i.e. day count changes at 0000hrs of current locale)\n * @returns {number}\n */\nexport const getDaysSinceEpoch = () =>\n    differenceInCalendarDays(new Date(), new Date(0));\n\n/**\n * Returns formatDateToNow if within the same minute,\n * otherwise returns formatDistanceToNowStrict if within same calendar day,\n * otherwise returns date like 18 Apr if same calendar year,\n * otherwise like Apr 2021\n * @param date\n */\nexport const formatDistanceToNowPretty = date => {\n    if (differenceInMinutes(new Date(), date) < 1)\n        return formatDistanceToNow(date, {addSuffix: true});\n    if (differenceInCalendarDays(new Date(), date) < 1)\n        return formatDistanceToNowStrict(date, {addSuffix: true});\n    if (differenceInCalendarYears(new Date(), date) < 1)\n        return format(date, 'd MMM');\n    return format(date, 'MMM y')\n};\n\nexport const isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport const noop = () => {\n};\n\n/**\n * Cryptographically secure random number generator.\n * Assumes window.crypto exists.\n */\nexport const getSecureRandom = () => {\n    if (!window.crypto) throw new Error('window.crypto not supported on browser');\n\n    let arr = new Uint32Array(1);\n    const max = 2 ** 32;\n\n    /*Will generate random numbers between 0 and 1 (exclusive) with 32 bit maximum precision\n    * Rejection sampling.*/\n    const random = () => {\n        let val = crypto.getRandomValues(arr)[0] / max;\n        if (val >= 1) return random();\n        return val\n    };\n\n    /*Random integer between min (inclusive) and max (exclusive)*/\n    const randint = (min, max) => {\n        let floor_min = Math.floor(min);\n        let floor_max = Math.floor(max);\n        return Math.floor(random() * (floor_max - floor_min)) + floor_min\n    };\n\n    /*Select random element of an array*/\n    const choice = arr => arr[randint(0, arr.length)];\n\n    return {\n        random,\n        randint,\n        choice,\n    }\n};\n\nexport const prettifyUAString = uaString => {\n    let ua = UAParser(uaString);\n    let {\n        browser: {\n            name: browserName,\n        },\n        // if type is set, it is mobile\n        device: {model, type},\n        os: {name: osName, version: osVersion}\n    } = ua;\n\n    return {\n        name: `${browserName} on ${osName} ${osVersion}${model ? ` (${model})` : ''}`,\n        isMobile: Boolean(type),\n        browserName\n    }\n};\n\nexport const stripHtml = html => {\n   let doc = new DOMParser().parseFromString(html, 'text/html');\n   return doc.body.textContent || \"\";\n}\n\n/*Copied from RTKQ's fetchBaseQuery.\n* Will not affect non-objects such as classes.*/\nexport const stripUndefined = obj => {\n    if (!isPlainObject(obj)) {\n        return obj\n    }\n    const copy = {...obj}\n    for (const [k, v] of Object.entries(copy)) {\n        if (typeof v === 'undefined') delete copy[k]\n    }\n    return copy\n}\n\n/**\n * Joins 2 URLs. Will not modify/add trailing slashes if present/absent\n * */\nexport const joinUrl = (base, url) => {\n    if (!base) {\n        return url\n    }\n    if (!url) {\n        return base\n    }\n    return String(base).replace(/\\/$/, '') + '/' + String(url).replace(/^\\//)\n}\n\n/* Truncate string with ellipsis after 'len' characters */\nexport const truncateString = (string, len) => string.length < len ? string : `${string.slice(0, len)}...`\n\nexport const tanDegrees = degrees => Math.tan(degrees * Math.PI / 180)","import {useState} from 'react'\nimport {useCallback} from \"react\";\n\n/*Workaround to throw errors in callbacks to ErrorBoundaries*/\nexport const useAsyncError = () => {\n    const setError = useState(null)[1];\n\n    return useCallback(e => setError(() => {\n        if (e instanceof Error){ //Subclasses of Error also return true\n            throw e\n        } else {\n            throw new Error(e)\n        }\n\n    }), [setError])\n};","import {Component} from \"react\";\nimport {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    Snackbar,\n    styled as muiStyled\n} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\n\nconst StyledDialog = muiStyled(Dialog)(({theme}) => ({\n    /*As zIndex is set inline in Dialog, style must be overridden with !important*/\n    zIndex: `${theme.zIndex.snackbar + 1} !important`,\n}));\n\n/*Catch-all for any application errors*/\nexport class ErrorBoundary extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            error: false,\n            errorInfo: null,\n            dialogOpen: false,\n        };\n    }\n\n    static getDerivedStateFromError(error) {\n        return {error: error};\n    }\n\n    setDialogOpen = state => this.setState({dialogOpen: state});\n\n    componentDidCatch(error, errorInfo) {\n        /*Errors are not logged currently*/\n    }\n\n    render() {\n        return this.state.error\n            ? <>\n                <StyledDialog\n                    open={this.state.dialogOpen}\n                    onClose={() => this.setDialogOpen(false)}\n                    scroll={'body'}\n                >\n\n                    <DialogTitle>{this.state.error.toString()}</DialogTitle>\n\n                    <DialogContent>\n                        <DialogContentText>{this.state.errorInfo?.componentStack}</DialogContentText>\n                    </DialogContent>\n\n                    <DialogActions>\n                        <Button\n                            variant={'text'}\n                            color={'primary'}\n                            onClick={() => this.setDialogOpen(false)}\n                        >Close\n                        </Button>\n                    </DialogActions>\n\n                </StyledDialog>\n                <Snackbar open>\n                    <Alert\n                        severity={'error'}\n                        action={<>\n                            <Button\n                                variant={'text'}\n                                color={'primary'}\n                                onClick={() => this.setDialogOpen(true)}\n                            >Details</Button>\n                            <Button\n                                variant={'text'}\n                                color={'primary'}\n                                onClick={() => window.location.reload()\n                                }\n                            >Reload</Button>\n                        </>\n                        }>\n                        Application Error\n                    </Alert>\n                </Snackbar>\n            </>\n            : this.props.children\n    }\n\n}","import {unstable_createMuiStrictModeTheme as createMuiTheme} from \"@material-ui/core/styles\"; //todo replace with v5 when out\n\nexport const theme = createMuiTheme({\n    palette: {\n        type: \"dark\",\n        primary: {\n            main: '#90caf9',\n        },\n        secondary: {\n            main: '#f48fb1',\n        },\n    }\n});\n\nexport const OverlayScrollbarOptions = {\n    className: 'os-theme-light',\n    overflowBehavior: {\n        x: 'hidden'\n    },\n    scrollbars: {\n        autoHide: 'move',\n    }\n};","/*TODO Replace this file with typescript*/\n\nexport const NETWORK_ERROR = {\n    HTTP_ERROR: 1,\n    FETCH_ERROR: 2,\n}","import { stripHtml, stripUndefined } from \"../../shared/util\";\nimport { NETWORK_ERROR } from \"../constants\";\nimport { joinUrl } from \"../../shared/util\";\nimport { retry } from \"@reduxjs/toolkit/dist/query\";\n\nconst defaultValidateStatus = response =>\n    (response.status >= 200 && response.status <= 299)\n\n\n/*Parse body as JSON only if content-type is JSON*/\nconst responseHandler = response =>\n    response.headers.get('content-type')?.trim()?.startsWith('application/json') ?\n        response.json() :\n        response.text()\n\n/*Custom query which wraps fetch errors in NetworkError format.\n* Will consider 4xx/5xx statuses to be errors, regardless of login status.*/\nexport const baseQuery = ({\n    baseUrl,\n    defaultHeaders = {},\n    prepareHeaders = (x) => x,\n    fetchFn = fetch,\n    ...baseFetchOptions\n}) =>\n    async (arg = {}, { signal, getState }) => {\n        let {\n            url = '',\n            method = 'GET',\n            headers = new Headers({}),\n            body = undefined,\n            params = undefined,\n            validateStatus = defaultValidateStatus,\n        } = typeof arg == 'string' ? { url: arg } : arg\n        let config = {\n            ...baseFetchOptions,\n            method,\n            signal,\n            body,\n        }\n\n        config.headers = await prepareHeaders(\n            new Headers(stripUndefined({ ...defaultHeaders, ...headers })),\n            { getState }\n        )\n\n        config.body = JSON.stringify(body)\n\n        if (params) {\n            const divider = ~url.indexOf('?') ? '&' : '?'\n            const query = new URLSearchParams(stripUndefined(params))\n            url += divider + query\n        }\n\n        url = joinUrl(baseUrl, url)\n\n\n        const request = new Request(url, config)\n        const requestClone = request.clone()\n\n        try {\n            const response = await fetchFn(request)\n            const responseClone = response.clone()\n\n            const meta = { request: requestClone, response: responseClone }\n\n            const resultData = await responseHandler(response)\n\n            return validateStatus(response, resultData)\n                ? {\n                    data: resultData, //This is not wrapped in 'data' in the reducer!\n                    meta,\n                }\n                : {\n                    error: {\n                        method: request.method,\n                        url: request.url,\n                        text: typeof resultData === 'object' ? JSON.stringify(resultData, undefined, 2) : stripHtml(resultData),\n                        status: response.status,\n                        type: NETWORK_ERROR.HTTP_ERROR,\n\n                        /*Mainly for use by auth*/\n                        data: resultData\n                    },\n                    meta,\n                }\n        } catch (e) {\n            return {\n                error: {\n                    method: request.method,\n                    url: request.url,\n                    text: `${e.name}: ${e.message}`,\n                    type: NETWORK_ERROR.FETCH_ERROR\n                }\n            }\n        }\n    }\n\n/* baseQuery with retries ONLY on NETWORK_ERROR.FETCH_ERROR (Up to 5, exponential backoff) */\nexport const baseQueryWithRetry = (...baseQueryOptions) =>\n    retry(\n        (...args) =>\n            baseQuery(...baseQueryOptions)(...args)\n                .then(r => r.error && r.error.type !== NETWORK_ERROR.FETCH_ERROR ? retry.fail(r.error) : r),\n        { maxRetries: 5 }\n    )","/**\n * Base createApi.\n */\n\nimport { createApi } from \"@reduxjs/toolkit/dist/query/react\";\nimport { baseQueryWithRetry } from \"./baseQuery\";\n\nconst API_URL = 'https://api.nicholaslyz.com'\n\nexport const baseApi = createApi({\n    reducerPath: 'api',\n    baseQuery: baseQueryWithRetry({\n        baseUrl: API_URL,\n        credentials: \"include\",\n        defaultHeaders: { 'content-type': 'application/json' }\n    }),\n    endpoints: () => ({}),\n})","import {baseApi} from \"../../app/network-core/baseApi\";\n\nexport const hmailApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        checkIhisMail: build.query({\n            query: () => 'hmail/check-ihis-mail/'\n        }),\n        checkMohhMail: build.query({\n            query: () => 'hmail/check-mohh-mail/'\n        })\n    })\n})\n\nexport const {\n    useCheckIhisMailQuery,\n    useCheckMohhMailQuery,\n} = hmailApi","import {createSelector, createSlice, nanoid} from \"@reduxjs/toolkit\";\nimport {isPlainObject} from 'lodash'\n\nexport const notificationsSliceName = 'notifications'\n\nconst shape = [\n    'title',\n    'content',\n    'source',\n\n    /*Autogenerated if not already present*/\n    'id',\n    'timestamp',\n]\n\nconst prepareBatchNotification = (arg) => {\n    if (isPlainObject(arg)) {\n        return {\n            payload: [{\n                id: nanoid(),\n                timestamp: Date.now(),\n                ...arg\n            }]\n        }\n    }\n    if (!Array.isArray(arg))\n        throw new Error(`'${arg}' should be an array or object, but got ${typeof arg}`)\n\n    return {\n        payload: arg.map(e => ({\n            id: nanoid(),\n            timestamp: Date.now(),\n            ...e\n        }))\n    }\n}\n\nconst validateShape = (arg) => {\n    if (!arg.every(item => shape.every(e => Object.keys(item).includes(e))))\n        throw new Error(`Invalid notification shape: expected ${shape}, but got ${Object.keys(arg)}`)\n}\n\nexport const notificationSlice = createSlice({\n    name: notificationsSliceName,\n    initialState: [],\n    reducers: {\n        addNotifications: {\n            reducer: (state, {payload}) => {\n                validateShape(payload)\n                state.push(...payload)\n            },\n            prepare: prepareBatchNotification\n        },\n        removeNotification: (state, {payload: {id}}) => state.filter(e => e.id !== id),\n        removeNotificationsFromSource: (state, {payload}) => state.filter(e => e.source !== payload),\n    },\n\n})\n\nexport const {\n    addNotifications,\n    removeNotification,\n    removeNotificationsFromSource\n} = notificationSlice.actions\n\nexport const selectNotificationsSorted = createSelector(\n    state => state[notificationsSliceName],\n    items => items.slice().sort((a, b) => b.timestamp - a.timestamp)\n)","import {addNotifications, removeNotificationsFromSource} from \"../../app/notifications/notificationSlice\";\nimport {format, isToday, parseJSON} from \"date-fns\";\n\nexport const handleMailAction = (data, source) => dispatch => {\n    dispatch(removeNotificationsFromSource(source))\n    dispatch(addNotifications(data.map(e => {\n        let date = parseJSON(e.date)\n        return ({\n            title: e.title,\n            content: `${format(date, isToday(date) ? 'p' : 'd/M')} ` + [e.from.join(', '), e.preview].join(' - '),\n            source,\n            timestamp: date.getTime()\n        })\n    })))\n}","import { useCheckIhisMailQuery, useCheckMohhMailQuery } from \"./hmailApi\";\nimport { useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { handleMailAction } from \"./hmailActions\";\n\nconst CHECK_MAIL_FREQUENCY_MS = 30 * 1000;\nconst [IHIS, MOHH] = ['IHIS', 'MOHH']\n\nexport const Hmail = () => {\n\n    const dispatch = useDispatch()\n\n    /*This hook appears to be keep the same reference when the new data is identical to\n    the old data, and therefore cached data is returned, so useEffect calls do not run*/\n    const { data: ihisMail } = useCheckIhisMailQuery(undefined, { pollingInterval: CHECK_MAIL_FREQUENCY_MS })\n    const { data: mohhMail } = useCheckMohhMailQuery(undefined, { pollingInterval: CHECK_MAIL_FREQUENCY_MS })\n\n    useEffect(() => ihisMail &&\n        dispatch(handleMailAction(ihisMail, IHIS)),\n        [dispatch, ihisMail])\n\n    useEffect(() => mohhMail &&\n        dispatch(handleMailAction(mohhMail, MOHH)),\n        [dispatch, mohhMail])\n\n    return null\n}; ","import {baseApi} from \"../network-core/baseApi\";\n\nexport const authApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        checkLogin: build.query({\n            query: () => 'account/login/',\n        }),\n        login: build.mutation({\n            query: body => ({\n                url: 'account/login/',\n                method: 'POST',\n                body\n            })\n        }),\n        logout: build.mutation({\n            query: () => ({\n                url: 'account/logout/',\n                method: 'POST'\n            })\n        })\n    })\n})\n\nexport const {\n    useCheckLoginQuery,\n    useRecaptchaKeyQuery,\n    useLoginMutation,\n    useLogoutMutation,\n} = authApi","import { createSlice, isAllOf, isRejectedWithValue } from \"@reduxjs/toolkit\";\nimport { NETWORK_ERROR } from \"./constants\";\nimport { authApi } from \"./auth/authApi\";\n\nexport const appSliceName = 'app'\n\nconst initialState = {\n    module: null,\n    loginStatus: {\n        user: null,\n        expiry: null,\n        isSuperUser: false,\n        recaptchaKey: null,\n        loggedIn: false,\n    },\n    networkError: null,\n    pendingNetworkActions: []\n}\n\nconst handleLoginFulfilled = (state, {\n    payload: {\n        user,\n        expiry,\n        is_superuser: isSuperUser,\n        recaptcha_key: recaptchaKey\n    }\n\n}) => void (state.loginStatus = {\n    user,\n    expiry,\n    isSuperUser,\n    recaptchaKey,\n    loggedIn: true,\n})\n\nconst setNetworkErrorReducer = (state, action) => {\n\n    let {\n        method = 'Method not specified',\n        url = 'URL not specified',\n        text = '',\n        status = null, /*Must be specified if HTTP_ERROR*/\n        type,\n        timestamp,\n    } = action.payload\n\n    /*Type not specified:  rejected thunk with value which is NOT a NetworkError object*/\n    if (!type) {\n        state.networkError = {\n            method,\n            url,\n            text: JSON.stringify(action, undefined, 2),\n            status,\n            type,\n            timestamp\n        }\n        return\n    }\n\n    if (type === NETWORK_ERROR.HTTP_ERROR && typeof status !== 'number')\n        throw new Error(`NetworkError: 'status' must be a number if \n            'type' === HTTP_ERROR, but got ${status} instead`)\n\n    /*Ignore 401/403 errors if not logged in*/\n    if (!state.loginStatus.loggedIn &&\n        [401, 403].includes(status)) {\n        return\n    }\n    state.networkError = { method, url, text, status, type, timestamp }\n}\n\nexport const appSlice = createSlice({\n    name: appSliceName,\n    initialState,\n    reducers: {\n        setNetworkError: {\n            reducer: setNetworkErrorReducer,\n            prepare: action => ({\n                payload: {\n                    ...action,\n                    timestamp: new Date().getTime()\n                }\n            })\n        },\n        clearNetworkError: state => void (state.networkError = null),\n        setCurrentModule: (state, { payload }) => void (state.module = payload),\n        setAppBar: (state, { payload: { drawerOpen = false } }) => void (state.appBar.drawerOpen = drawerOpen),\n        addNetworkAction: (state, { payload }) => {\n            if (!state.pendingNetworkActions.includes(payload))\n                state.pendingNetworkActions.push(payload)\n        },\n        removeNetworkAction: (state, { payload }) => {\n            if (state.pendingNetworkActions.includes(payload))\n                state.pendingNetworkActions.splice(state.pendingNetworkActions.indexOf(payload), 1)\n        },\n    },\n    extraReducers: builder => builder\n        .addMatcher(authApi.endpoints.checkLogin.matchFulfilled, handleLoginFulfilled)\n        .addMatcher(isAllOf(authApi.endpoints.checkLogin.matchRejected, isRejectedWithValue),\n            (state, action) => {\n                let payload = action.payload\n                if (payload.type === NETWORK_ERROR.HTTP_ERROR && [401, 403].includes(payload.status))\n                    state.loginStatus.recaptchaKey = payload.data.recaptcha_key\n            })\n        .addMatcher(authApi.endpoints.login.matchFulfilled, handleLoginFulfilled)\n        .addMatcher(authApi.endpoints.logout.matchFulfilled, () => {\n            /*Not pure, but an exception here as I want to clear everything*/\n            localStorage.clear()\n            /*Page is refreshed on logout, to clear both Redux store and cached memory.*/\n            window.location.reload()\n        })\n\n})\n\nexport const {\n    setNetworkError,\n    clearNetworkError,\n    setCurrentModule,\n    setAppBar,\n    addNetworkAction,\n    removeNetworkAction\n} = appSlice.actions\n\nexport const selectLoginStatus = state => state[appSliceName].loginStatus\nexport const selectNetworkError = state => state[appSliceName].networkError\nexport const selectCurrentModule = state => state[appSliceName].module\nexport const selectPendingNetworkActions = state => state[appSliceName].pendingNetworkActions","import { joinUrl } from \"./util\";\nimport { nanoid } from '@reduxjs/toolkit';\n\nexport const BaseGetCreateSkeleton = queryArg => ({ isSkeleton: true, id: nanoid() })\n\n/**\n * Helper function to generate CRUD endpoints.\n * Can be used with GenericList.\n * \n * Assumes URL endpoints are of the form 'itemType/itemId/'\n * Will not pass any arguments to cache update logic\n * \n * Optimistic update and delete (create doesn't show a skeleton due to\n *  problems rendering a skeleton in tables (for now))\n * \n * No cache invalidation (cache is modified optimistically and rolled back if necessary)\n */\nexport const generateCrudApi = (url, api, {\n    get,\n    create,\n    update,\n    delete: _delete,\n    getCreateSkeleton = BaseGetCreateSkeleton\n}) => build => {\n\n    let obj = {}\n\n\n    if (!get)\n        throw new Error(`'get' must be supplied, but got ${typeof get}`)\n\n    obj[get] = build.query({\n        query: () => url\n    })\n\n\n    if (create) {\n\n        obj[create] = build.mutation({\n            query: data => ({\n                url,\n                method: 'POST',\n                body: data,\n            }),\n            onQueryStarted: (queryArg, { dispatch, queryFulfilled }) => {\n                /* Optimistically show skeleton if enabled*/\n                if (getCreateSkeleton) {\n                    let result = dispatch(api.util.updateQueryData(get, undefined, draft => {\n                        draft.unshift(getCreateSkeleton(queryArg))\n                    }))\n                    queryFulfilled.then(result.undo).catch(result.undo)\n                }\n\n                /* Update getItems with the newly created item on success*/\n                queryFulfilled\n                    .then(({ data }) => {\n                        dispatch(api.util.updateQueryData(get, undefined, draft => {\n                            draft.unshift(data);\n                        }));\n                    })\n            }\n        })\n    }\n\n    if (update) {\n\n        obj[update] = build.mutation({\n            query: ({ id, ...data }) => ({\n                url: joinUrl(url, id) + '/',\n                method: 'PUT',\n                body: data,\n            }),\n            /* Optimistically update the item, rollback if failure*/\n            onQueryStarted: ({ id, ...data }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(api.util.updateQueryData(get, undefined, draft => {\n                    let obj = draft.find(e => e.id === id)\n                    Object.assign(obj, data)\n                }))\n                queryFulfilled.catch(result.undo)\n            }\n        })\n    }\n\n    if (_delete) {\n        obj[_delete] = build.mutation({\n            query: ({ id }) => ({\n                url: joinUrl(url, id) + '/',\n                method: 'DELETE',\n            }),\n\n            /* Optimistically delete item */\n            onQueryStarted: ({ id }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(api.util.updateQueryData(get, undefined, draft => draft.filter(e => e.id !== id)))\n                queryFulfilled.catch(result.undo)\n            }\n        })\n    }\n\n    return obj\n}","import { baseApi } from './../../app/network-core/baseApi';\nimport { BaseGetCreateSkeleton, generateCrudApi } from '../../shared/generateCrudApi';\n\nconst generateStub = (name, getCreateSkeleton = BaseGetCreateSkeleton) => generateCrudApi(`literature/${name.toLowerCase()}s/`, baseApi, {\n    get: `get${name}s`,\n    create: `create${name}`,\n    update: `update${name}`,\n    delete: `delete${name}`,\n    getCreateSkeleton,\n})\n\n/* Exclude create method from generateCrudApi for book, for now, because of issues displaying skeletons */\nconst bookApi = generateStub('Book', null)\nconst authorApi = generateStub('Author')\n/* Exclude create method from generateCrudApi for book, for now, because of issues displaying skeletons */\nconst genreApi = generateStub('Genre', null)\nconst typeApi = generateStub('Type')\n\nconst literatureApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        searchBook: build.mutation({\n            query: q => ({\n                url: 'literature/search/',\n                params: {q}\n            }),\n            transformResponse: resp => resp.results\n        }),\n        googleBookInfo: build.mutation({\n            query: isbn => ({\n                url: 'literature/bookinfo/',\n                params: {isbn}\n            })\n        }),\n        goodreadsBookInfo: build.mutation({\n            query: ({workId, bookId}) => ({\n                url: 'literature/bookinfo/',\n                params: {work_id: workId, book_id: bookId}\n            })\n        }),\n        ...bookApi(build),\n        ...authorApi(build),\n        ...genreApi(build),\n        ...typeApi(build),\n    })\n})\n\nexport const {\n    useSearchBookMutation,\n    useGoodreadsBookInfoMutation,\n    useGoogleBookInfoMutation,\n\n    useGetBooksQuery,\n    useCreateBookMutation,\n    useUpdateBookMutation,\n    useDeleteBookMutation,\n\n    useGetAuthorsQuery,\n    useCreateAuthorMutation,\n    useUpdateAuthorMutation,\n    useDeleteAuthorMutation,\n\n    useGetGenresQuery,\n    useCreateGenreMutation,\n    useUpdateGenreMutation,\n    useDeleteGenreMutation,\n\n    useGetTypesQuery,\n    useCreateTypeMutation,\n    useUpdateTypeMutation,\n    useDeleteTypeMutation,\n\n} = literatureApi","/**\n * Schemas for Yup validation, default field values, transformations before submission and other utility functions\n */\n\nimport * as yup from \"yup\";\nimport {formatISO, parseISO} from \"date-fns\";\nimport {trim, isNumber, isEqual, pick} from 'lodash'\n\n/*\nThis is the schema AFTER hydrating to user-viewable input (id, date_added etc are stripped).\n\nSchema keys here are equal to those server-side\n*/\nconst BOOK_SCHEMA = {\n    authors: {\n        yupSchema: yup.array(\n            yup.object({\n                name: yup.string(),\n                id: yup.number().required(),\n                notes: yup.string()\n            }))\n            .ensure(),\n        defaultValue: [],\n        transformToServer: val => val.map(e => e.id),\n        transformFromServer: (val, {authors}) => val.map(id => authors.find(e => e.id === id))\n    },\n    genres: {\n        yupSchema: yup.array(\n            yup.object({\n                name: yup.string(),\n                id: yup.number().required(),\n                notes: yup.string()\n            }))\n            .ensure(),\n        defaultValue: [],\n        transformToServer: val => val.map(e => e.id),\n        transformFromServer: (val, {genres}) => val.map(id => genres.find(e => e.id === id))\n    },\n    type: {\n        yupSchema: yup.object({\n            name: yup.string(),\n            id: yup.number().required(),\n            notes: yup.string()\n        }).typeError('Required'),\n        defaultValue: null,\n        transformToServer: val => val.id,\n        transformFromServer: (val, {types}) => types.find(e => e.id === val)\n    },\n    title: {\n        yupSchema: yup.string().required(),\n        defaultValue: '',\n    },\n    description: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    read_next: {\n        yupSchema: yup.bool(),\n        defaultValue: false,\n    },\n    date_read: {\n        /*v3 KeyboardDatePicker will return 'Invalid Date' as a string for invalid input, causing typeError\n        * Apparently will return null if left blank\n        * This value is modified on submission, to ISO8601\n        * Necessary to check if validated date is not null prior to modifying to ISO8601*/\n        yupSchema: yup.date().nullable().typeError('Date must be in dd/mm/yyyy format'),\n        defaultValue: null,\n        transformToServer: val => val ? formatISO(val, {representation: \"date\"}) : null,\n        transformFromServer: val => val ? parseISO(val) : null // date could be null\n    },\n    image_url: {\n        yupSchema: yup.string().url(),\n        defaultValue: '',\n    },\n    published: {\n        yupSchema: yup.number().integer().nullable().transform((val, origVal) => trim(origVal) === '' ? null : val)\n            .typeError('Must be a valid year'),\n        defaultValue: '',\n        /* isNumber checks are needed because 0 is falsy*/\n        transformFromServer: val => isNumber(val) ? val : ''\n    },\n    google_id: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n        transformToServer: val => trim(val) || null,\n        transformFromServer: val => val || '',\n    },\n    goodreads_book_id: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n        transformToServer: val => trim(val) || null,\n        transformFromServer: val => val || ''\n    },\n    series: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    series_position: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    rating: {\n        yupSchema: yup.number().min(0).max(5).nullable().transform((val, origVal) => trim(origVal) === '' ? null : val),\n        defaultValue: '',\n        /* isNumber checks are needed because 0 is falsy*/\n        transformToServer: val => isNumber(val) ? Math.round(val * 10) / 10 : null, //val is guaranteed to be either number or null here\n        transformFromServer: val => isNumber(val) ? val : ''\n    },\n    my_review: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n    notes: {\n        yupSchema: yup.string(),\n        defaultValue: '',\n    },\n};\n\nexport const BOOK_FIELDS = Object.fromEntries(Object.keys(BOOK_SCHEMA).map(e => [e, e]));\n\nexport const YUP_SCHEMA = yup.object(Object.fromEntries(Object.entries(BOOK_SCHEMA)\n    .map(([k, v]) => [k, v.yupSchema]))).noUnknown();\n\nexport const DEFAULT_BOOK_VALUES = Object.fromEntries(Object.entries(BOOK_SCHEMA)\n    .map(([k, v]) => [k, v.defaultValue]));\n\nexport const transformToServer = data => Object.fromEntries(\n    Object.entries(data)\n        .map(([k, v]) =>\n            /*This is NOT the same as\n            * BOOK_SCHEMA[k].transformToServer?.(v) ?? v\n            *\n            * The above code will return v if transformToServer(v) === null, which is not intended behavior\n            * */\n            [k, BOOK_SCHEMA[k].transformToServer ?\n                BOOK_SCHEMA[k].transformToServer(v) :\n                v]\n        ));\n\nexport const transformFromServer = (data, dataTypes) => Object.fromEntries(\n    Object.entries(data).map(([k, v]) => [\n        /*See above for explanation why nullish coalescing/optional chaining is not used here*/\n        k, BOOK_SCHEMA[k]?.transformFromServer ?\n            BOOK_SCHEMA[k].transformFromServer(v, dataTypes) :\n            v])\n);\n\n/**\n * Verify if user had made changes to the fields\n * @param originalData - from server\n * @param userData - data from UI after transformation\n * @returns {boolean}\n */\nexport const isBookDataEqual = (originalData, userData) =>\n    isEqual(pick(originalData, Object.keys(BOOK_FIELDS)), userData);","\nimport { createSlice } from '@reduxjs/toolkit';\nimport { BOOK_FIELDS } from './schema';\n\nexport const literaturePath = 'literature'\n\n\nconst initialState = {\n    submodule: null,\n    displayedColumns: {\n        [BOOK_FIELDS.image_url]: true,\n        [BOOK_FIELDS.title]: true,\n        [BOOK_FIELDS.authors]: true,\n        [BOOK_FIELDS.genres]: true,\n    }\n}\n\nexport const literatureSlice = createSlice({\n    name: literaturePath,\n    initialState,\n    reducers: {\n        setLiteratureSubmodule: (state, { payload }) => void (state.submodule = payload),\n        setDisplayedColumn: {\n            reducer: (state, {payload: { column, display }}) => void (state.displayedColumns[column] = display),\n            prepare: (column, display) => ({ payload: { column, display } })\n        }\n    }\n})\n\nexport const {\n    setLiteratureSubmodule,\n    setDisplayedColumn\n} = literatureSlice.actions\n\nexport const selectLiteratureSubmodule = state => state[literaturePath].submodule\nexport const selectDisplayedColumns = state => state[literaturePath].displayedColumns","import styled from 'styled-components'\nimport { Fab } from '@material-ui/core'\nimport AddIcon from '@material-ui/icons/Add';\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\nexport const AddButton = props => (\n  <StyledFab color={'primary'} {...props}>\n    <AddIcon />\n  </StyledFab>\n)","import { debounce } from 'lodash';\nimport { useCallback, useRef } from \"react\";\n\n/**\n * Autosave hook.\n * Saves items via updateItem on debounced intervals.\n * Calls createItem if id is not provided.\n * Optionally deletes item on flush.\n * \n * Note: provided functions must be memoized, otherwise\n * the debounced onChange function will not be referentially stable,\n * and cause unnecessary re-renders\n * \n * Provides:\n * onChange: data => void\n * flush: () => void (flush all pending debounced onChange callbacks)\n * \n * Required props:\n * updateItem: (id, data) => Promise || void\n * \n * Required if id is null:\n * createItem: (data) => id: Promise<String>\n * \n * Optional, delete item if empty, and only on flush():\n * deleteItem: (id) => Promise || void\n * \n * Required if deleteItem is provided:\n * itemIsEmpty: data => Boolean\n */\nexport const useAutosave = ({\n    id = null,\n    createItem,\n    updateItem,\n    deleteItem,\n    itemIsEmpty = () => false,\n    wait = 1000,\n    maxWait,\n}) => {\n\n    /* Validate arguments */\n    if (typeof updateItem !== 'function') {\n        throw new Error(`updateItem must be a function, but got ${typeof updateItem}`)\n    } else if (!id && typeof createItem !== 'function') {\n        throw new Error(`createItem must be provided if id is null/undefined, but got ${typeof createItem}`)\n    } else if (!!deleteItem && typeof deleteItem !== 'function') {\n        throw new Error(`deleteItem must be a function, but got ${typeof deleteItem}`)\n    } else if (!!deleteItem && typeof itemIsEmpty !== 'function') {\n        throw new Error(`itemIsEmpty must be provided with deleteItem, but got ${typeof itemIsEmpty}`)\n    }\n\n    /* Store a copy of the item's id (updated on props change via useEffect) */\n    const state = useRef({\n        id,\n        data: null,\n        pendingData: false,\n        creationInProgress: false,\n        flushing: false\n    })\n\n    /* Update item (or delete, if flushing) */\n    const updateOrDelete = useCallback((id, data) => {\n        if (state.current.flushing && itemIsEmpty(data)) {\n            deleteItem(id)\n            state.current.data = null // Clear data so that a second deleteItem won't be called\n        } else {\n            updateItem(id, data)\n        }\n    }, [deleteItem, itemIsEmpty, updateItem])\n\n    const _onChange = useCallback(async data => {\n        state.current.data = data\n\n        if (state.current.id) {\n\n            /* id was supplied or item was created, update*/\n            updateOrDelete(state.current.id, data)\n\n        } else if (state.current.creationInProgress) {\n\n            /* Flag data for update later when id is available */\n            state.current.pendingData = true\n\n        } else {\n            /* New item, and it is empty, and we are flushing:\n            don't create the item */\n            if (state.current.flushing && itemIsEmpty(data)) return\n\n            /* id is null, and creation has not yet occurred - create item */\n            state.current.creationInProgress = true\n            let newId = await createItem(data)\n            state.current.creationInProgress = false\n            state.current.id = newId\n\n            /* Execute and clear pendingData if any*/\n            if (state.current.pendingData) {\n                updateOrDelete(newId, state.current.data)\n                state.current.pendingData = false\n            }\n        }\n    }, [createItem, itemIsEmpty, updateOrDelete])\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    const onChange = useCallback(\n        debounce(_onChange, wait, Object.assign({}, maxWait ? { maxWait } : undefined)),\n        [_onChange, wait, maxWait]\n    )\n\n    const flush = useCallback(() => {\n\n        state.current.flushing = true\n        onChange.flush()\n\n        /* Bail if item doesn't exist, e.g. flush() was called on a\n         new item where id = null and _onChange wasn't called */\n        if (!id && !state.current.id) return\n\n        /* onChange.flush() will not execute deleteItem if no changes are in the queue.\n        This manually checks and fires a delete if necessary. */\n        if (state.current.data && itemIsEmpty(state.current.data)) {\n            deleteItem(state.current.id)\n        }\n    }, [deleteItem, id, itemIsEmpty, onChange])\n\n    return {\n        onChange,\n        flush\n    }\n}","import styled from \"styled-components\";\nimport { OverlayScrollbarsComponent } from \"overlayscrollbars-react\";\nimport { Dialog } from \"@material-ui/core\";\nimport { OverlayScrollbarOptions, theme } from \"../../app/theme\";\n\nconst StyledDialog = styled(Dialog)`\n\n  .MuiDialog-paper {\n    width: min(100vw, 600px);\n    box-shadow: 0px 0px 17px 12px rgba(0,0,0,0.71);\n  }\n\n  // Start from top of screen regardless of content height\n  .MuiDialog-container {\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n  }\n\n  .MuiDialog-paper {\n      background: black;\n  }\n\n  @supports (backdrop-filter: blur(5px)) {\n    .MuiDialog-paper {\n      backdrop-filter: blur(5px);\n      background: none;\n    }\n  }\n\n  // Reduce margins when on mobile\n  ${theme.breakpoints.down('sm')} {\n\n    // Extend width\n    .MuiDialog-paperWidthFalse {\n      max-width: calc(100% - 32px);\n    }\n\n    // Extend height\n    .MuiDialog-container {\n      height: 100%;\n    }\n\n    .MuiDialog-paper {\n      // Keep taskbar visible\n      margin: 48px 0 0;\n\n      // Fill up screen\n      max-height: initial;\n    }\n\n  }\n`;\n\nconst StyledOverlayScrollbarsComponent = styled(OverlayScrollbarsComponent)`\n  .os-viewport {\n    overscroll-behavior: contain;\n  }\n`;\n\n/* Dialog with overlayscrollbars (does not scroll footer component)*/\nexport const DialogBlurResponsive = ({\n  children,\n  footer,\n  fullscreen = false,\n  ...props }) =>\n\n  <StyledDialog\n    maxWidth={false}\n    disableScrollLock\n    disablePortal\n    $fullscreen={fullscreen}\n    {...props}>\n\n    <StyledOverlayScrollbarsComponent\n      options={OverlayScrollbarOptions}\n      className={'os-host-flexbox'}>\n      {children}\n    </StyledOverlayScrollbarsComponent>\n\n    {footer}\n\n  </StyledDialog>;","import { ListItemText } from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\n\n/* A skeleton with a line for title and notes */\nexport const ItemSkeleton = () => <ListItemText\n  primary={<Skeleton animation={'wave'} width={'min(80%, 300px)'} />}\n  secondary={<Skeleton animation={'wave'} width={'min(60%, 240px)'} />} />;\n","import styled from \"styled-components\";\n\nexport const BACKGROUND_COLOR = `background: rgba(0, 0, 0, 0.6)`;\n\n//For use with already dark backgrounds\nexport const BACKGROUND_COLOR_LIGHT = `background: rgba(0, 0, 0, 0.3)`;\nexport const BACKGROUND_BOX_SHADOW = `box-shadow: 0 0 10px 5px rgba(0, 0, 0, 0.6)`;\n\nexport const BackgroundScreen = styled.div`\n  ${BACKGROUND_COLOR};\n`;\n\nexport const BackgroundScreenRounded = styled(BackgroundScreen)`\n  border-radius: 5px;\n  ${BACKGROUND_BOX_SHADOW};\n`;","import { ListItem } from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport { theme } from '../../../app/theme'\nimport { BACKGROUND_COLOR } from \"../backgroundScreen\";\n\nexport const StyledListItem = styled(ListItem)`\n  ::before {\n    margin-left: -16px;\n    content: '';\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    z-index: -1;\n    ${({ $hideBackground }) => $hideBackground ? '' : BACKGROUND_COLOR};\n  }\n\n  ${theme.breakpoints.up('md')} {\n    ${({ $reserveSpace }) => $reserveSpace ? 'padding-right: 48px' : 'padding-right: 16px'};\n  }\n  \n  .MuiListItem-container:hover & {\n    padding-right: 48px;\n    \n    // Highlight entire item even when secondary action is hovered\n    background-color: rgba(255, 255, 255, 0.08);\n  }\n`;","import { ListItemSecondaryAction } from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport { theme } from \"../../../app/theme\";\n\n/* A ListItemSecondaryAction which will appear on hover for desktops,\nand always appear for mobile screens. */\nexport const StyledListItemSecondaryAction = styled(ListItemSecondaryAction)`\n  ${theme.breakpoints.up('md')}  {\n    display: none;\n  }\n\n  .MuiListItem-container:hover & {\n    display: block;\n  }\n`;\n","import { Button, Dialog, DialogActions, DialogTitle, IconButton, ListItemText } from \"@material-ui/core\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport React, { useState } from 'react';\nimport { truncateString } from '../../util';\nimport { ItemSkeleton } from \"./ItemSkeleton\";\nimport { StyledListItem } from \"./StyledListItem\";\nimport { StyledListItemSecondaryAction } from \"./StyledListItemSecondaryAction\";\n\n/**\n * A ListItem component which can show title, notes and a delete button on hover.\n * Will ask for confirmation on delete.\n */\nexport const BaseListItem = ({\n    primaryTextKey = 'title',\n    secondaryTextKey = 'notes'\n\n}) => function GeneratedBaseListItem({\n    context,\n    deleteItemMutation,\n    itemIdField,\n    isSkeleton,\n    item,\n    setEditingItem }) {\n\n        const [deleteItem] = deleteItemMutation()\n        const [dialogOpen, setDialogOpen] = useState(false)\n\n        /* Avoid destructuring item if it's a skeleton */\n        if (isSkeleton(item)) {\n            return <StyledListItem>\n                <ItemSkeleton />\n            </StyledListItem>\n        }\n\n        const { [primaryTextKey]: primaryText, [secondaryTextKey]: secondaryText } = item\n        const closeDialog = () => setDialogOpen(false)\n\n        return <>\n            <Dialog\n                open={dialogOpen}\n                onClose={closeDialog}>\n                <DialogTitle>Delete '{truncateString(primaryText, 30)}' ?</DialogTitle>\n                <DialogActions>\n                    <Button onClick={() => deleteItem({ [itemIdField]: item[itemIdField], ...context })} color={'primary'}>Delete</Button>\n                    <Button onClick={closeDialog}>Cancel</Button>\n                </DialogActions>\n            </Dialog>\n            <StyledListItem\n                button\n                onClick={() => setEditingItem(item)}\n                $reserveSpace={true}>\n\n                <ListItemText\n                    primary={primaryText}\n                    secondary={secondaryText}\n                    secondaryTypographyProps={{ noWrap: true }} />\n                <StyledListItemSecondaryAction>\n                    <IconButton\n                        edge={'end'}\n                        onClick={e => {\n                            e.stopPropagation();\n                            setDialogOpen(true)\n                        }}>\n                        <DeleteIcon />\n                    </IconButton>\n                </StyledListItemSecondaryAction>\n\n            </StyledListItem>\n        </>\n    }","import { List } from \"@material-ui/core\";\nimport { forwardRef } from 'react';\nimport { Virtuoso } from 'react-virtuoso/dist';\nimport styled from 'styled-components';\nimport { BaseListItem } from './BaseListItem';\n\nconst StyledDiv = styled.div`\n  max-width: 800px;\n  height: 100%;\n`;\n\nconst DefaultItem = BaseListItem({ primaryTextKey: 'name', secondaryTextKey: 'notes' })\n\nexport const BaseList = ({ Item = DefaultItem }={}) => ({\n    context,\n    deleteItemMutation,\n    items,\n    itemIdField,\n    isSkeleton,\n    loading,\n    setEditingItem,\n}) => {\n\n    if (loading) return (\n        <List\n            disablePadding\n            dense>\n            {[...Array(3)].map((_, idx) => <Item\n                context={context}\n                deleteItemMutation={deleteItemMutation}\n                itemIdField={itemIdField}\n                key={idx}\n                isSkeleton={() => true}\n                setEditingItem={setEditingItem} />\n            )}\n        </List>\n    )\n\n    const itemsArray =\n        items.map(e => (\n            <Item\n                context={context}\n                deleteItemMutation={deleteItemMutation}\n                itemIdField={itemIdField}\n                key={e[itemIdField]}\n                isSkeleton={isSkeleton}\n                item={e}\n                setEditingItem={setEditingItem} />)\n        );\n\n    return (\n        <StyledDiv>\n            <Virtuoso\n                totalCount={items.length}\n                itemContent={idx => itemsArray[idx]}\n                components={{\n                    List: forwardRef(({ children, ...props }, ref) =>\n                        <List\n                            disablePadding\n                            dense\n                            ref={ref}\n                            {...props}>\n                            {children}\n                        </List>)\n                }} />\n        </StyledDiv>\n    )\n}","import { useState } from 'react';\nimport { AddButton } from './../AddButton';\nimport { BaseItemEdit } from './BaseItemEdit';\nimport { BaseList } from './BaseList';\n\n/* Can't be passed as a default option, otherwise it will continuously trigger re-renders */\nconst DefaultItemEdit = BaseItemEdit({ name: '', notes: '' })\nconst DefaultList = BaseList()\n\n/**\n * Note: assumes API endpoints take objects as arguments\n * \n * context: argument passed (via spread) to all query/mutation requests\n * defaultItemValues: Object containing all fields (except id) and their default values.\n * Received as a prop on new item addition, and \n * used by BaseItemEdit to determine how many fields to render.\n * \n * List: renderer for list and items.\n * ItemEdit: renderer for editing items. \n * isItemEmpty: used by BaseItemEdit's useAutosave to determine if item should be deleted on close\n * itemIdField: field used by objects and api submission for id\n * isSkeleton: whether temporary object returned by api should be marked as a skeleton.\n * Passed to List \n * \n * \n * */\nexport const GenericList = ({\n  getItemsQuery,\n  createItemMutation,\n  updateItemMutation,\n  deleteItemMutation,\n\n  defaultItemValues,\n  context,\n\n  List = DefaultList,\n  ItemEdit = DefaultItemEdit,\n  isItemEmpty = e => !e.name && !e.notes,\n  itemIdField = 'id',\n  isSkeleton = e => !!e.isSkeleton,\n}) => {\n\n  const { data: items, isFetching } = getItemsQuery(context)\n  const [editingItem, setEditingItem] = useState(null)\n  const loading = isFetching || !items\n\n  return <>\n    {!loading && <AddButton\n      onClick={() => setEditingItem(defaultItemValues)} />}\n\n    {editingItem && <ItemEdit\n      editingItem={editingItem}\n      closeEdit={() => void setEditingItem(null)}\n      context={context}\n      isItemEmpty={isItemEmpty}\n      itemIdField={itemIdField}\n      createItemMutation={createItemMutation}\n      updateItemMutation={updateItemMutation}\n      deleteItemMutation={deleteItemMutation} />}\n\n    <List\n      context={context}\n      updateItemMutation={updateItemMutation}\n      deleteItemMutation={deleteItemMutation}\n      items={items}\n      itemIdField={itemIdField}\n      isSkeleton={isSkeleton}\n      loading={loading}\n      setEditingItem={setEditingItem}/>\n  </>\n}","import {styled as muiStyled} from \"@material-ui/core/styles\";\nimport {Backdrop, CircularProgress, Typography} from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport {BackgroundScreen} from \"./backgroundScreen\";\n\nconst StyledBackdrop = muiStyled(Backdrop)(({theme}) => ({\n    // To cover the app drawer\n    zIndex: theme.zIndex.drawer + 1,\n}));\n\nconst FlexContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-around;\n  height: 100px;\n`;\n\nconst FlexBackgroundScreen = styled(BackgroundScreen)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 100%;\n`;\n\n/**\n * A fullscreen loading backdrop element\n * @param open\n * @param message\n * @param showSpinner\n * @param fullscreen\n * @returns {JSX.Element}\n * @constructor\n */\nexport const Loading = ({\n                            open = true,\n                            message = 'Loading...',\n                            showSpinner = true,\n                            fullscreen = true\n                        }) => {\n\n    let content = <FlexContainer>\n        {showSpinner ? <CircularProgress color=\"inherit\" size={30}/> : null}\n        <Typography variant={'body1'} display={\"block\"}>{message}</Typography>\n    </FlexContainer>;\n\n    if (!open) return null;\n\n    return fullscreen ?\n        <StyledBackdrop open={open}>\n            {content}\n        </StyledBackdrop>\n        : <FlexBackgroundScreen>\n            {content}\n        </FlexBackgroundScreen>;\n\n};","import {useMemo, useState} from \"react\";\nimport {flow} from \"lodash\";\nimport {noop, sanitizeString} from \"../util\";\nimport {matchSorter} from \"match-sorter\";\nimport TextField from \"@material-ui/core/TextField\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport Chip from \"@material-ui/core/Chip\";\nimport styled from 'styled-components'\nimport {Autocomplete} from \"@material-ui/lab\";\nimport PropTypes from 'prop-types'\n\nconst StyledCircularProgress = styled(CircularProgress)`\n  cursor: default;\n`;\nconst propTypes = {\n    createOption: PropTypes.func,\n    getOptionLabel: PropTypes.func,\n    getOptionSelected: PropTypes.func,\n    getValue: PropTypes.func, // Required if multiple=true (to get the current state in a callback)\n    maxOptionsToShow: PropTypes.number,\n    multiple: PropTypes.bool,\n    onChange: PropTypes.func.isRequired,\n    options: PropTypes.array.isRequired,\n    renderProps: PropTypes.object, // error state, helper text\n    value: PropTypes.any\n};\n\n/**\n * 'getOptions' is unnecessary - 'options' should update on creation automatically\n */\nexport const AutocompleteWithCreate = ({\n                                           createOption,\n                                           error, // Not used\n                                           getOptionLabel = e => e,\n                                           getOptionSelected = (a, b) => a === b,\n                                           getValue,\n                                           helperText, // Not used\n                                           maxOptionsToShow = 10,\n                                           multiple = false,\n                                           onChange,\n                                           options,\n                                           renderProps,\n                                           value,\n                                           ...props\n                                       }) => {\n\n        let [loading, setLoading] = useState(false);\n\n        // Optimization for filtering through option labels\n        const sanitizedOptionLabels = useMemo(() => options.map(flow(getOptionLabel, sanitizeString)), [options, getOptionLabel]);\n\n        /* Needed for getting option label for single autocomplete when option is being added (i.e. _name is set)*/\n        const _getOptionLabel = option => getOptionLabel(option) ?? option._name;\n\n        /* Needed to detect options with _name (e.g. currently being added),\n         * otherwise when creating an option while another is being created,\n         * useAutocomplete returns 'remove-option' instead*/\n        const _getOptionSelected = (option, value) =>\n            getOptionSelected(option, value) ||\n            /*An option is currently being created.\n            * Ternary is needed because undefined === undefined*/\n            value._name ? value._name === option._name : false;\n\n        const filterOptions = (options, state) => {\n            let input = state.inputValue;\n            //matchSorter already removes accents, spaces and converts to lowercase\n            let filtered = input ? matchSorter(options, input, {keys: [getOptionLabel]}) : options;\n\n            /*Suggest adding option ONLY if input is NOT blank,\n            NOT in existing options (comparing with diacritics stripped),\n            AND createOption is provided*/\n            if (createOption &&\n                input &&\n                !sanitizedOptionLabels.includes(input)) {\n                createOption && filtered.push({\n                    _name: state.inputValue.trim(),\n                    _isNew: true,\n                    _justAdded: true,\n                })\n            }\n\n            return maxOptionsToShow ? filtered.slice(0, maxOptionsToShow) : filtered //todo add 'Scroll for more' functionality\n        };\n\n        const renderInput = params => <TextField\n            {...params}\n            {...renderProps}\n            InputProps={{\n                ...params.InputProps,\n                ...renderProps?.InputProps,\n                endAdornment:\n                    <>\n                        {loading && <CircularProgress size={20}/>}\n                        {params.InputProps.endAdornment}\n                    </>\n            }}\n        />;\n\n        const renderTags = (tagValue, getTagProps) => tagValue.map((option, index) => {\n                let {onDelete, ...rest} = getTagProps({index});\n                return <Chip\n                    {...rest}\n                    size={\"small\"}\n                    variant={option._isNew ? 'outlined' : 'default'}\n                    onDelete={option._isNew ? noop : onDelete} // onDelete must be set for deleteIcon to appear, but I don't want it to actually delete a newly added option.\n                    deleteIcon={option._isNew ? <StyledCircularProgress size={16}/> : null}\n                    label={option._isNew ?\n                        `Adding ${option._name}...` :\n                        getOptionLabel(option)}\n                />\n            }\n        );\n\n        const onOptionChange = (event, newValue) => {\n            /* A click will never trigger a 'create-option' event.\n             * Only Enter will. So it's useless relying on that.\n             *\n             * The component must be controlled, or else book search\n             * will not be able to add authors.*/\n\n\n            if (multiple) {\n\n                // Find the options with _justAdded === true, call createOption for it and remove the flag\n                let el = newValue.find(e => e._justAdded);\n                if (el) {\n                    el._justAdded = false;\n                    createOption(el._name)\n                        .then(obj => {\n                            // Get current state and then replace new option with server created object (it now has id)\n                            onChange(getValue().map(e => e._name === el._name ? obj : e))\n                        })\n\n                }\n\n            } else if (newValue && newValue._justAdded) {\n\n                // New option added to single value autocomplete (will be disabled while loading)\n                setLoading(true);\n                createOption(newValue._name)\n                    .then(obj => {\n                        // Input is disabled while this is happening\n                        onChange(obj);\n                        setLoading(false)\n                    })\n            }\n\n            /*No new options were created.\n            * Setting newValue here will result in some options having _name, _justAdded, _isNew properties.\n            * Submission is prevented while in such a state, by Yup schema validation.*/\n            onChange(newValue)\n        };\n\n        return <Autocomplete\n            clearOnBlur // Used together with freeSolo\n            disabled={!multiple && loading}\n            filterOptions={filterOptions}\n            freeSolo // This fixes the 'none of the options match with ...' error\n            getOptionLabel={_getOptionLabel}\n            getOptionSelected={_getOptionSelected}\n            loading={loading}\n            multiple={multiple}\n            onChange={onOptionChange}\n            options={options}\n            renderInput={renderInput}\n            renderOption={option => option._isNew ? `Add '${option._name}'` : getOptionLabel(option)}\n            renderTags={renderTags}\n            value={value}\n            {...props}\n        />\n    }\n;\n\nAutocompleteWithCreate.propTypes = propTypes;","import TextField from \"@material-ui/core/TextField\";\nimport {InputAdornment} from \"@material-ui/core\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\n\nexport const TextFieldClearable = ({onChange, ...props}) =>\n    <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n;","import {TextField} from \"@material-ui/core\";\nimport {useEffect, useRef, useState} from \"react\";\nimport styled from \"styled-components\";\n\nconst StyledTextField = styled(TextField)`\n  \n  ${({$ellipsis}) => $ellipsis ? `\n  .MuiInputBase-input {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }`: null}\n`;\n\n/*TextField which switches to multiline when focused, and singleline with ellipsis otherwise.*/\nexport const TextFieldMultilineEllipsis = ({onBlur, onFocus, ...props}) => {\n    const [focused, setFocused] = useState(false);\n    const [focusPos, setFocusPos] = useState(0);\n    const inputRef = useRef();\n\n    useEffect(() => {\n        if (!focused) return\n        inputRef.current.focus() // Required to focus on the new textarea\n        inputRef.current.setSelectionRange(focusPos, focusPos); // Maintain original cursor position\n    }, [focusPos, focused]);\n\n    return <StyledTextField\n        {...props}\n        $ellipsis={!focused}\n        multiline={focused}\n        inputRef={inputRef}\n        onFocus={e => {\n            setFocused(true)\n            e.target.selectionStart && setFocusPos(e.target.selectionStart)\n        }}\n        onBlur={() => setFocused(false)}\n    />\n};","import {\n    ListItem,\n    ListItemText\n} from \"@material-ui/core\"\nimport NoteIcon from '@material-ui/icons/Note'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nconst NumberCircle = styled.span`\n  margin: auto 5px;\n  border: 2px solid rgba(255, 255, 255, 0.4);\n  padding: 3px;\n  border-radius: 20%;\n  font-weight: lighter;\n`\n\n/*Recursively sort Genre objects*/\nexport const recursiveSort = (arr, compareFn, childrenKey = 'children') => {\n    let mapped = arr.map(e => e[childrenKey].length ? {\n        ...e,\n        [childrenKey]: recursiveSort(e[childrenKey], compareFn, childrenKey)\n    } : e)\n    return mapped.sort(compareFn)\n}\n\n/*Get array of ancestors, from top level to direct parent*/\nexport const getAncestors = (e, genres) => {\n    let arr = []\n    let currentEl = e\n    while (currentEl.parent) {\n        // eslint-disable-next-line no-loop-func\n        let parent = genres.find(p => p.id === currentEl.parent);\n        arr.unshift(parent.name)\n        currentEl = parent\n    }\n    return arr\n}\n\n/*Add extra contextual information to the genres object*/\nexport const mapGenres = (e, genres) => {\n    let ancestors = getAncestors(e, genres)\n    return ({\n        ...e,\n        ancestors, /*for display*/\n        fullName: [...ancestors, e.name].join(' '), /*for sorting*/\n    })\n}\n\n/*Will also get book counts for each genre, with each parent's including the sum of their children*/\nexport const getTreeDataFromGenres = (setEditingItem) => (genres, books) => {\n    let genreMap = new Map();\n    let root = [];\n    let bookCountForGenre = {};\n\n    /*Get count of books for each genre*/\n    books.forEach(e => e.genres.forEach(id => id in bookCountForGenre ?\n        bookCountForGenre[id] += 1 :\n        bookCountForGenre[id] = 1));\n\n    /*Clone genres, add React-Sortable-Tree specific props*/\n    genres.forEach(e => genreMap.set(e.id, {\n        ...e,\n        expanded: true,\n        children: [],\n        bookCount: bookCountForGenre[e.id] ?? 0,\n        title: ({ node }) => <ListItem\n            disableGutters\n            dense\n            onClick={() => setEditingItem(node)}\n            button>\n            <NumberCircle>{node.bookCount}</NumberCircle>\n            <ListItemText primary={`${node.name}`} />\n            {node.notes &&\n                <NoteIcon />}\n        </ListItem>\n    }));\n\n    let addCount = (v, numToAdd) => {\n        if (!v.parent)\n            return;\n        let parent = genreMap.get(v.parent);\n        parent.bookCount += numToAdd;\n        addCount(parent, numToAdd);\n    };\n\n    /* Start creating the tree\n     * Also add descendent counts*/\n    genreMap.forEach(v => {\n        if (v.parent) {\n            genreMap.get(v.parent).children.push(v);\n            addCount(v, v.bookCount);\n        } else {\n            root.push(v);\n        }\n    });\n\n    return root;\n};\n","import DateFns from '@date-io/date-fns';\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport {\n    Button,\n    Checkbox,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    FormControlLabel,\n    FormHelperText,\n    IconButton,\n    Snackbar,\n    Typography\n} from \"@material-ui/core\";\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\nimport { Alert } from \"@material-ui/lab\";\nimport { KeyboardDatePicker } from \"@material-ui/pickers/DatePicker\";\nimport { MuiPickersUtilsProvider } from \"@material-ui/pickers/MuiPickersUtilsProvider\";\nimport { isEmpty } from \"lodash\";\nimport React, { useCallback, useState } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\nimport styled from \"styled-components\";\nimport { AutocompleteWithCreate } from \"../../shared/components/AutocompleteWithCreate\";\nimport { DialogBlurResponsive } from \"../../shared/components/DialogBlurResponsive\";\nimport { TextFieldClearable } from \"../../shared/components/textFieldClearable\";\nimport { TextFieldMultilineEllipsis } from \"../../shared/components/textFieldMultilineEllipsis\";\nimport { useCreateAuthorMutation, useCreateBookMutation, useCreateGenreMutation, useCreateTypeMutation, useGetAuthorsQuery, useGetGenresQuery, useGetTypesQuery, useUpdateBookMutation } from './literatureApi';\nimport {\n    BOOK_FIELDS,\n    DEFAULT_BOOK_VALUES,\n    isBookDataEqual,\n    transformFromServer,\n    transformToServer,\n    YUP_SCHEMA\n} from \"./schema\";\nimport { mapGenres } from \"./utils\";\n\nconst FieldContainer = styled.div`\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);\n  grid-template-areas: \n    \"${BOOK_FIELDS.title} ${BOOK_FIELDS.title}\"\n    \"${BOOK_FIELDS.authors} ${BOOK_FIELDS.type}\"\n    \"${BOOK_FIELDS.description} ${BOOK_FIELDS.description}\"\n    \"${BOOK_FIELDS.genres} ${BOOK_FIELDS.read_next}\"\n    \"${BOOK_FIELDS.rating} ${BOOK_FIELDS.date_read} \"\n    \"${BOOK_FIELDS.image_url} ${BOOK_FIELDS.published}\"\n    \"${BOOK_FIELDS.google_id} ${BOOK_FIELDS.goodreads_book_id}\"\n    \"${BOOK_FIELDS.series} ${BOOK_FIELDS.series_position}\"\n    \"${BOOK_FIELDS.my_review} ${BOOK_FIELDS.my_review}\"\n    \"${BOOK_FIELDS.notes} ${BOOK_FIELDS.notes}\";\n  gap: 20px 10px;\n  margin: 10px;\n`;\n\nconst ButtonFlexDiv = styled.div`\n  display: flex;\n  justify-content: flex-end;\n`;\n\nexport const AddBook = ({\n    bookData,\n    onClose,\n    setAddedSnackbar\n}) => {\n\n    /* Books.js will prevent AddBook.js displaying until these queries have loaded initially,\n    so they're guaranteed to be defined */\n    const { data: authors } = useGetAuthorsQuery()\n    const { data: genres } = useGetGenresQuery()\n    const { data: types } = useGetTypesQuery()\n\n    const [createBook] = useCreateBookMutation()\n    const [updateBook] = useUpdateBookMutation()\n    const [createAuthor] = useCreateAuthorMutation()\n    const [createGenre] = useCreateGenreMutation()\n    const [createType] = useCreateTypeMutation()\n\n    const {\n        handleSubmit,\n        control,\n        getValues,\n        setValue,\n        formState: {\n            isDirty\n        },\n        watch\n    } = useForm({\n        resolver: yupResolver(YUP_SCHEMA),\n        defaultValues: isEmpty(bookData) ? DEFAULT_BOOK_VALUES : transformFromServer(bookData, {\n            authors,\n            genres,\n            types\n        }),\n        mode: 'onTouched',\n    });\n\n    const [errorSnackbar, setErrorSnackbar] = useState(false);\n    const [saveDialog, setSaveDialog] = useState(false);\n    const [infoDialog, setInfoDialog] = useState(false);\n\n    const sortedGenres = genres.map(e => mapGenres(e, genres)).sort((a, b) => a.fullName.localeCompare(b.fullName))\n\n    const onSubmit = handleSubmit(\n        data => {\n            if (!isDirty ||\n                /*Untouched form, guaranteed no changes*/\n\n                /*Editing book, no actual changes made*/\n                (!isEmpty(bookData) && isBookDataEqual(bookData, transformToServer(data)))) {\n                setAddedSnackbar({ message: 'No changes were detected' });\n                onClose();\n                return\n            }\n\n            let transformedData = transformToServer(data);\n\n            if (isEmpty(bookData) || !('id' in bookData)) {\n                /*User is adding book*/\n                createBook(transformedData)\n                    .unwrap()\n                    .then(() => {\n                        setAddedSnackbar({ message: 'Book added' });\n                    })\n                onClose()\n            } else {\n                /* Changes were made in editing book*/\n                updateBook({ id: bookData['id'], ...transformedData })\n                    .unwrap()\n                    .then(() => {\n                        setAddedSnackbar({ message: 'Changes saved' });\n                    })\n                }\n                onClose()\n        },\n        () => {\n            setErrorSnackbar(true)\n        });\n\n\n    const handleDiscard = () => isDirty ?\n        setSaveDialog(true) :\n        onClose(); //Untouched form\n\n\n    const footer = <ButtonFlexDiv>\n        <IconButton\n            tabIndex={-1}\n            onClick={() => setInfoDialog(true)}>\n            <InfoOutlinedIcon />\n        </IconButton>\n        <Button onClick={handleDiscard}>Discard</Button>\n        <Button onClick={onSubmit} color={'primary'}> Save </Button>\n    </ButtonFlexDiv>;\n\n    const StandardField = useCallback(({ Component, name, label, getComponentProps = () => ({}), ...props }) =>\n        <Controller\n            control={control}\n            name={name}\n            render={controllerProps => {\n                const { field: { ref, ...field }, fieldState: { error } } = controllerProps\n                return <Component\n                    error={Boolean(error)}\n                    label={label}\n                    helperText={error?.message}\n                    size={'small'}\n                    style={{ gridArea: field.name }}\n                    variant={'outlined'}\n                    {...props}\n                    {...field}\n                    {...getComponentProps({ ...controllerProps, label })} />\n            }} />, [control])\n\n    return <>\n        <Dialog\n            open={saveDialog}\n            onClose={() => setSaveDialog(false)}>\n            <DialogTitle>Discard changes?</DialogTitle>\n            <DialogActions>\n                <Button onClick={() => {\n                    setAddedSnackbar({ message: 'Changes discarded' });\n                    onClose()\n                }}> Discard </Button>\n                <Button onClick={() => setSaveDialog(false)} color={'primary'}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <Dialog\n            open={infoDialog}\n            onClose={() => setInfoDialog(false)}>\n            <DialogTitle>Notes on fields</DialogTitle>\n            <DialogContent>\n                <DialogContentText component={'div'}>\n                    Series:\n                    <ul>\n                        <li>For new ones I wish to read, just store the first book.</li>\n                        <li>If I like it, add just the next book (read_next=true)</li>\n                        <li>As I complete each book in the series, it is added.</li>\n                        <li>If I don't like it halfway, I don't add any further books (i.e. the series is left\n                            hanging)\n                        </li>\n                        <li>Series which I have completed should have all books added.</li>\n                    </ul>\n\n                    Authors with many works:\n                    <ul>\n                        <li>The anthology is listed, if I plan to read it</li>\n                        <li>All works I have read/wish to read are also listed.</li>\n                        <li>I could also make comments in the author object's notes.</li>\n                    </ul>\n\n                    Unknown read date\n                    <ul>\n                        <li>put as 01/01/2000</li>\n                    </ul>\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button\n                    onClick={() => setInfoDialog(false)}>\n                    Close\n                </Button>\n            </DialogActions>\n\n        </Dialog>\n        <Snackbar\n            open={errorSnackbar}\n            onClose={() => setErrorSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                severity={'error'}\n                onClose={() => setErrorSnackbar(false)}>\n                Check errors before submitting\n            </Alert>\n        </Snackbar>\n        <DialogBlurResponsive\n            open\n            footer={footer}\n            onClose={handleDiscard}>\n            <FieldContainer>\n\n                <StandardField\n                    name={BOOK_FIELDS.title}\n                    label={'Title'}\n                    Component={TextFieldMultilineEllipsis} />\n\n                <StandardField\n                    name={BOOK_FIELDS.authors}\n                    label={'Authors'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={name => createAuthor({ name }).unwrap()}\n                    filterSelectedOptions\n                    getComponentProps={({ field: { name }, fieldState: { error }, label }) => ({\n                        getValue: () => getValues(name),\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error ? 'Creating author(s)...' : null\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    multiple={true}\n                    options={authors}\n                />\n\n                <StandardField\n                    name={BOOK_FIELDS.type}\n                    label={'Type'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={name => createType({ name }).unwrap()}\n                    filterSelectedOptions\n                    getComponentProps={({field: { name }, fieldState: { error }, label }) => ({\n                        getValue: () => getValues(name),\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error?.message\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    maxOptionsToShow={0}\n                    multiple={false}\n                    options={types} />\n\n                <StandardField\n                    name={BOOK_FIELDS.description}\n                    label={'Description'}\n                    Component={TextFieldMultilineEllipsis} />\n\n                {/*todo Very hacky. Write this better*/}\n                <StandardField\n                    name={BOOK_FIELDS.genres}\n                    label={'Genres'}\n                    Component={AutocompleteWithCreate}\n\n                    autoComplete\n                    autoHighlight\n                    createOption={name => createGenre({ name }).unwrap()}\n                    filterSelectedOptions\n                    getComponentProps={({ field: { name }, fieldState: { error }, label }) => ({\n                        getValue: () => getValues(name),\n                        renderProps: {\n                            label,\n                            variant: 'outlined',\n                            error: Boolean(error),\n                            helperText: error ? 'Creating genre(s)...' : null\n                        }\n                    })}\n                    getOptionLabel={e => e.name}\n                    getOptionSelected={(option, value) => option.id === value.id}\n                    groupBy={e => e.ancestors?.length ? e.ancestors.join(' > ') : ''}\n                    maxOptionsToShow={0}\n                    multiple={true}\n                    options={sortedGenres}\n                    renderOption={e => e.ancestors?.length ?\n                        <Typography style={{ marginLeft: '20px' }}>{e.name}</Typography> : (e.name || `Add '${e._name}'`)}\n\n                />\n\n                <Controller\n                    name={BOOK_FIELDS.read_next}\n                    control={control}\n                    render={({\n                        field: { onChange, value, ...field },\n                        fieldState: { error },\n                    }) => <>\n                            <FormControlLabel\n                                {...field}\n                                checked={value}\n                                control={<Checkbox />}\n                                label={'Read next?'}\n                                labelPlacement={'end'}\n                                onChange={e => {\n                                    setValue(BOOK_FIELDS.date_read, DEFAULT_BOOK_VALUES[BOOK_FIELDS.date_read])\n                                    onChange(e)\n                                }}\n                                style={{ gridArea: field.name }}\n                            />\n                            <FormHelperText\n                                error={Boolean(error)}>\n                                {error?.message}\n                            </FormHelperText>\n                        </>} />\n\n                <StandardField\n                    name={BOOK_FIELDS.rating}\n                    label={'Rating'}\n                    Component={TextFieldClearable} />\n\n                <MuiPickersUtilsProvider utils={DateFns}>\n                    <StandardField\n                        name={BOOK_FIELDS.date_read}\n                        label={'Date Read'}\n                        Component={KeyboardDatePicker}\n\n                        autoOk\n                        disabled={watch(BOOK_FIELDS.read_next)}\n                        disableFuture\n                        format={'dd/MM/yyyy'}\n                        placeholder={'dd/mm/yyyy'}\n                        inputVariant={'outlined'}\n                    />\n\n                </MuiPickersUtilsProvider>\n\n                <StandardField\n                    name={BOOK_FIELDS.image_url}\n                    label={'Image URL'}\n                    Component={TextFieldClearable}\n                    type={'url'} />\n\n                <StandardField\n                    name={BOOK_FIELDS.published}\n                    label={'Year Published'}\n                    Component={TextFieldClearable} />\n\n                <StandardField\n                    name={BOOK_FIELDS.google_id}\n                    label={'Google ID'}\n                    Component={TextFieldClearable} />\n\n                <StandardField\n                    name={BOOK_FIELDS.goodreads_book_id}\n                    label={'Goodreads ID'}\n                    Component={TextFieldClearable} />\n\n                <StandardField\n                    name={BOOK_FIELDS.series}\n                    label={'Series Name'}\n                    Component={TextFieldClearable} />\n\n                <StandardField\n                    name={BOOK_FIELDS.series_position}\n                    label={'Series Position'}\n                    Component={TextFieldClearable} />\n\n                <StandardField\n                    name={BOOK_FIELDS.my_review}\n                    label={'My Review'}\n                    Component={TextFieldMultilineEllipsis}\n                    placeholder={'Not good, read others, highlight specific chapters, etc'} />\n\n                <StandardField\n                    name={BOOK_FIELDS.notes}\n                    label={'Notes'}\n                    Component={TextFieldMultilineEllipsis}\n                    placeholder={'Specific edition, comments on metadata, somebody recommended me, want to buy etc'} />\n\n            </FieldContainer>\n        </DialogBlurResponsive>\n    </>\n};\n","import styled from \"styled-components\";\nimport { capitalize } from \"lodash\"\nimport { Button, Card, CardActionArea, CardActions, CardContent, CircularProgress, Typography } from \"@material-ui/core\";\nimport { useEffect, useState } from \"react\";\n\n\nconst StyledCard = styled(Card)`\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst StyledCardContent = styled(CardContent)`\n  height: 100%;\n`;\n\nconst Description = styled(CardContent)`\n  display: ${({ $empty }) => $empty ? 'flex' : 'block'};\n  justify-content: center;\n  align-items: center;\n  overflow-y: auto;\n  height: ${({ $maxHeight }) => `${$maxHeight}px` || 'initial'};\n`;\n\nconst StyledActionArea = styled(CardActionArea)`\n  height: 100%;\n`;\n\nconst Image = styled.img`\n  height: 200px;\n`\n\nconst ImageContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 10px 0;\n  height: 200px;\n`;\nconst Title = styled(Typography)`\n  line-height: 1rem;\n`;\n\nconst Authors = styled(Typography)`\n  font-style: italic;\n`;\n\nexport const BookResult = ({ onSearchResultClick, result, searchLoading }) => {\n  let { authors = [], from, image_url, published, title, description } = result;\n\n  const [detailView, setDetailView] = useState(false);\n  const [maxHeight, setMaxHeight] = useState();\n  const [loading, setLoading] = useState(false);\n\n  const onClick = () => {\n    setLoading(true);\n    onSearchResultClick(result)\n  };\n\n  useEffect(() => void setDetailView(false), [result]);\n\n  return <StyledCard>\n    <StyledActionArea onClick={() => setDetailView(!detailView)}>\n      {detailView ?\n        <Description $maxHeight={maxHeight} $empty={!Boolean(description)}>\n          <Typography variant={'body2'}>{description ? description : 'No description provided'}</Typography>\n        </Description> :\n        <StyledCardContent ref={ref => ref && setMaxHeight(ref.offsetHeight)}>\n          <Typography align={'right'} color={'textSecondary'} variant={'body2'}>{capitalize(from)}</Typography>\n          <ImageContainer>{image_url ?\n            <Image src={image_url} alt={''} /> :\n            <Typography variant={'body2'}>No cover</Typography>}</ImageContainer>\n          <Title align={'center'} variant={'subtitle2'}>{title} {published ? `(${published})` : null}</Title>\n          <Authors align={'center'} variant={'body2'}>{authors.length ? authors.reduce((acc, cur) => acc + `, ${cur}`) : ''}</Authors>\n        </StyledCardContent>}\n    </StyledActionArea>\n    <CardActions>\n      <Button onClick={onClick} disabled={searchLoading}>Select</Button>\n      {loading && <CircularProgress size={20} />}\n    </CardActions>\n  </StyledCard>\n};\n","import { Button, CircularProgress, TextField } from \"@material-ui/core\";\nimport SearchIcon from '@material-ui/icons/Search';\nimport { Autocomplete } from \"@material-ui/lab\";\nimport { mergeWith } from \"lodash\";\nimport { matchSorter } from \"match-sorter\";\nimport styled from \"styled-components\";\nimport { DialogBlurResponsive } from \"../../shared/components/DialogBlurResponsive\";\nimport { sanitizeString } from \"../../shared/util\";\nimport { BookResult } from \"./BookResult\";\nimport { useCreateAuthorMutation, useGetAuthorsQuery, useGetBooksQuery, useGoodreadsBookInfoMutation, useGoogleBookInfoMutation, useSearchBookMutation } from './literatureApi';\nimport { BOOK_FIELDS, DEFAULT_BOOK_VALUES } from \"./schema\";\n\nconst BookResults = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  grid-auto-rows: 1fr;\n  gap: 10px 10px;\n  margin: 10px 0;\n`;\n\nconst StyledForm = styled.form`\n  padding: 10px 0;\n`;\n\nconst Footer = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nexport const SearchBooks = ({ closeSearch, setBookData }) => {\n\n    const { data: authors = [] } = useGetAuthorsQuery()\n    const { data: books = [] } = useGetBooksQuery()\n\n    /* Mutation, because I don't want cached results\n    (data is reset to undefined on trigger() for mutations) */\n    const [search, { data: searchResults, isLoading: searchLoading }] = useSearchBookMutation()\n    // These methods get 'published', 'series_name', 'series_position', 'description'\n    const [getGoogleBookInfo, { isLoading: googleBookInfoLoading }] = useGoogleBookInfoMutation()\n    const [getGoodreadsBookInfo, { isLoading: goodreadsBookInfoLoading }] = useGoodreadsBookInfoMutation()\n    const [createAuthor] = useCreateAuthorMutation()\n\n    /* Get book description from results, and add new authors \n    Returns filled book template for use in AddBooks*/\n    /* TODO Note: Goodreads is getting deprecated...*/\n    const getBookInfoAndCreateAuthors = async book => {\n        const {\n            from,\n            goodreads_work_id: workId,\n            goodreads_book_id: bookId,\n            ISBN_10,\n            ISBN_13\n        } = book;\n\n        const searchMutation = from === 'google' ?\n            // Use ISBN_13 if available, otherwise ISBN_10\n            getGoogleBookInfo(ISBN_13 || ISBN_10) :\n            getGoodreadsBookInfo({ workId, bookId })\n\n        const apiBookInfo = await searchMutation.unwrap()\n\n        //Prefer api values (srcVal) over existing values (objVal)\n        const mergedBook = mergeWith({}, book, apiBookInfo, (objVal, srcVal) => srcVal || objVal);\n\n        const existingAuthors = []; // [] of {id, name, notes}\n        const authorsToCreate = []; // [] of String\n\n        mergedBook.authors.forEach(mergedBookAuthor => {\n            /* Check if authors in the book result already exist */\n            const author = authors.find(existingAuthor => sanitizeString(existingAuthor.name) === sanitizeString(mergedBookAuthor));\n            if (author) {\n                // Author already exists\n                existingAuthors.push(author)\n            } else {\n                // Author doesn't exist, to create\n                authorsToCreate.push(mergedBookAuthor)\n            }\n        });\n\n        const createdAuthors = await Promise.all(authorsToCreate.map(name => createAuthor({ name }).unwrap()))\n\n        /* Generate a book template from default values */\n        const bookTemplate = Object.assign({}, DEFAULT_BOOK_VALUES);\n\n        /* Then copy selected truthy properties from mergedBook */\n        [\n            BOOK_FIELDS.description,\n            BOOK_FIELDS.google_id,\n            BOOK_FIELDS.goodreads_book_id,\n            BOOK_FIELDS.image_url,\n            BOOK_FIELDS.published,\n            BOOK_FIELDS.title,\n            BOOK_FIELDS.series,\n            BOOK_FIELDS.series_position\n        ].forEach(e => mergedBook[e] && (bookTemplate[e] = mergedBook[e]));\n\n        bookTemplate[BOOK_FIELDS.authors] = [...existingAuthors, ...createdAuthors].map(e => e.id);\n        return bookTemplate\n    }\n\n    const onSearch = e => {\n        e.preventDefault();\n        search(e.target.elements.search.value)\n    };\n\n    const onSearchResultClick = book => {\n        getBookInfoAndCreateAuthors(book)\n            .then(r => {\n                setBookData(r);\n                closeSearch()\n            })\n    };\n\n    const footer = <Footer>\n        <Button\n            onClick={() => {\n                setBookData({});\n                closeSearch()\n            }}>\n            Add manually\n        </Button>\n        <Button\n            onClick={closeSearch}\n            color={'primary'}>\n            Close\n        </Button>\n    </Footer>;\n\n    return <>\n        <DialogBlurResponsive\n            open\n            onClose={closeSearch}\n            footer={footer}>\n            <StyledForm onSubmit={onSearch}>\n                <Autocomplete\n                    autoComplete\n                    filterSelectedOptions\n                    filterOptions={(options, state) => state.inputValue ?\n                        matchSorter(options, state.inputValue.trim()).slice(0, 3) : []}\n                    freeSolo\n                    options={books.map(e => e.title)}\n                    renderInput={params => <TextField\n                        {...params}\n                        autoFocus\n                        disabled={searchLoading}\n                        fullWidth\n                        InputProps={{\n                            ...params.InputProps,\n                            startAdornment: <SearchIcon />,\n                            endAdornment: <>\n                                {searchLoading && <CircularProgress size={25} />}\n                                {params.InputProps.endAdornment}\n                            </>\n                        }}\n                        label={'Search'}\n                        name={'search'}\n                        variant={'outlined'}\n                    />}\n                />\n            </StyledForm>\n            {searchResults && <BookResults>\n                {searchResults.map((result, idx) => {\n                    return <BookResult\n                        result={result}\n                        onSearchResultClick={onSearchResultClick}\n                        searchLoading={googleBookInfoLoading || goodreadsBookInfoLoading}\n                        key={idx}\n                    />\n                })}\n            </BookResults>}\n        </DialogBlurResponsive>\n    </>\n};","import { Checkbox, Fab, FormControlLabel, Snackbar, TableContainer, TextField } from \"@material-ui/core\";\nimport { ThemeProvider, unstable_createMuiStrictModeTheme as createMuiTheme } from '@material-ui/core/styles'; //todo replace with v5 when out\nimport AddIcon from \"@material-ui/icons/Add\";\nimport ErrorOutlineOutlinedIcon from '@material-ui/icons/ErrorOutlineOutlined';\nimport { Alert, Autocomplete } from \"@material-ui/lab\";\nimport { isBefore, parseISO, subMonths, subWeeks, subYears } from 'date-fns';\nimport { matchSorter } from \"match-sorter\";\nimport MUIDataTable, { debounceSearchRender } from \"mui-datatables\";\nimport { useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Waypoint } from 'react-waypoint';\nimport styled from 'styled-components';\nimport { BACKGROUND_COLOR } from \"../../shared/components/backgroundScreen\";\nimport { formatDistanceToNowPretty } from \"../../shared/util\";\nimport { Loading } from '../../shared/components/Loading';\nimport { AddBook } from \"./AddBook\";\nimport { useDeleteBookMutation, useGetAuthorsQuery, useGetBooksQuery, useGetGenresQuery, useGetTypesQuery } from './literatureApi';\nimport { selectDisplayedColumns, setDisplayedColumn } from './literatureSlice';\nimport { BOOK_FIELDS } from \"./schema\";\nimport { SearchBooks } from \"./SearchBooks\";\n\nconst StyledTableContainer = styled(TableContainer)`\n  ${BACKGROUND_COLOR};\n`;\n \nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\n// TODO books in a series should be collapsible\n\n/**\n * Book search, addition, table view/sort\n */\nexport const Books = () => {\n\n    const dispatch = useDispatch()\n    const displayedColumns = useSelector(selectDisplayedColumns)\n\n    /* I have to set a default value, because useMemo below cannot be called conditionally */\n    const { data: books = [], isLoading: booksLoading } = useGetBooksQuery()\n    const { data: authors = [], isLoading: authorsLoading } = useGetAuthorsQuery()\n    const { data: genres = [], isLoading: genresLoading } = useGetGenresQuery()\n    const { data: types = [], isLoading: typesLoading } = useGetTypesQuery()\n    const [deleteBook] = useDeleteBookMutation()\n\n    const [searchBookOpen, setSearchBookOpen] = useState(false);\n    const [bookData, setBookData] = useState(null);\n    const [addedSnackbar, setAddedSnackbar] = useState(null);\n    const [filteredItemsLength, setFilteredItemsLength] = useState();\n    const [numBooksToShow, setNumBooksToShow] = useState(10);\n\n    const loading = booksLoading || authorsLoading || genresLoading || typesLoading\n\n    const dateOptions = useMemo(() => [\n        {\n            name: 'All',\n            date: new Date(0),\n        },\n        {\n            name: 'Last week',\n            date: subWeeks(new Date(), 1)\n        },\n        {\n            name: 'Last month',\n            date: subMonths(new Date(), 1)\n        },\n        {\n            name: 'Last year',\n            date: subYears(new Date(), 1)\n        }\n    ], [])\n\n    const options = useMemo(() => ({\n        count: numBooksToShow,\n        customFooter: () =>\n            <Waypoint\n                bottomOffset={-400}\n                scrollableAncestor={'window'}\n                onEnter={() => setNumBooksToShow(row => row + 10)}> \n                <tfoot /> \n            </Waypoint>,\n        customSearchRender: debounceSearchRender(200),\n        draggableColumns: {\n            enabled: true,\n        },\n        onFilterChange: () => setNumBooksToShow(20),\n        onRowClick: (rowData, { dataIndex }) =>\n            setBookData(books[dataIndex]),\n        onRowsDelete: (rowsDeleted, data, newTableData) => rowsDeleted.data.forEach(e => deleteBook({ id: books[e.dataIndex].id })),\n        onTableChange: (action, tableState) => setFilteredItemsLength(tableState.displayData.length),\n        onViewColumnsChange: (changedColumn, action) =>\n            dispatch(setDisplayedColumn(changedColumn, action === 'add')),\n        pagination: false,\n        responsive: 'simple',\n        setTableProps: () => ({\n            padding: 'none',\n            size: 'small',\n        }),\n        searchPlaceholder: `Search ${books.length} items`,\n        tableBodyMaxHeight: '100%'\n    }), [books, deleteBook, dispatch, numBooksToShow]);\n\n    const columns = useMemo(() => [\n        {\n            label: 'Cover',\n            name: BOOK_FIELDS.image_url,\n            options: {\n                filter: false,\n                searchable: false,\n                sort: false,\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.image_url] ?\n                    <img alt={''} src={books[dataIndex][BOOK_FIELDS.image_url]} style={{ maxHeight: '80px' }} /> : null,\n            },\n        },\n        {\n            label: 'Title',\n            name: BOOK_FIELDS.title,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Authors',\n            name: BOOK_FIELDS.authors,\n            options: {\n                customBodyRenderLite: dataIndex =>\n                    books[dataIndex][BOOK_FIELDS.authors]\n                        .map(id => authors.find(authors => authors.id === id)?.name)\n                        .join(', '),\n                customFilterListOptions: {\n                    render: val => val.map(e => `Author: ${e.name}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => el.includes(e.id)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options,\n                                    state.inputValue,\n                                    { keys: ['name'] }\n                                ).slice(0, 10)}\n                            getOptionLabel={option => option.name}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={authors}\n                            renderInput={params => <TextField {...params} label={'Author'} />}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Genres',\n            name: BOOK_FIELDS.genres,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.genres]\n                    .map(id => genres.find(genres => genres.id === id)?.name).join(', '),\n                customFilterListOptions: {\n                    render: val => val.map(e => `Genre: ${e.name}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => el.includes(e.id)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options,\n                                    state.inputValue,\n                                    { keys: ['name'] }\n                                )}\n                            getOptionLabel={option => option.name}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={genres}\n                            renderInput={params => <TextField {...params} label={'Genre'} />}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Type',\n            name: BOOK_FIELDS.type,\n            options: {\n                customBodyRenderLite: dataIndex => types.find(type => type.id === books[dataIndex][BOOK_FIELDS.type])?.name,\n                customFilterListOptions: {\n                    render: v => `Type: ${types.find(type => type.id === v).name}`\n                },\n                filterOptions: {\n                    renderValue: v => types.find(type => type.id === v).name,\n                },\n                filterType: 'multiselect',\n            }\n        },\n        {\n            label: 'Description',\n            name: BOOK_FIELDS.description,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Date added',\n            name: 'date_added', // date_added is not in BOOK_FIELDS\n            options: {\n                customBodyRenderLite: dataIndex => formatDistanceToNowPretty(parseISO(books[dataIndex].date_added)), // date_added is not in BOOK_FIELDS\n                customFilterListOptions: {\n                    render: v => `Date Added: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && isBefore(parseISO(el), filters[0].date),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Date Added'} />}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        },\n        {\n            label: 'Read Next',\n            name: BOOK_FIELDS.read_next,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.read_next] ?\n                    <ErrorOutlineOutlinedIcon color={'secondary'} /> : '',\n                customFilterListOptions: {\n                    render: () => 'Read Next'\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !el,\n                    display: (filterList, onChange, index, column) =>\n                        <FormControlLabel\n                            control={<Checkbox\n                                checked={Boolean(filterList[index][0])}\n                                onChange={e => onChange(e.target.checked ? [true] : [], index, column)}\n                            />}\n                            label={'Read Next'} />\n                },\n                filterType: 'custom',\n                searchable: false,\n            }\n        },\n        {\n            label: 'Date Read',\n            name: BOOK_FIELDS.date_read,\n            options: {\n                customBodyRenderLite: dataIndex => books[dataIndex][BOOK_FIELDS.date_read] ?\n                    formatDistanceToNowPretty(parseISO(books[dataIndex][BOOK_FIELDS.date_read])) : '',\n                customFilterListOptions: {\n                    render: v => `Date Read: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && (isBefore(parseISO(el), filters[0].date) || !Boolean(el)),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Date Read'} />}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        },\n\n        {\n            label: 'Published',\n            name: BOOK_FIELDS.published,\n            options: {\n                filter: false,\n                sortDescFirst: true\n            },\n        },\n        {\n            label: 'Series',\n            name: BOOK_FIELDS.series,\n            options: {\n                customBodyRenderLite: dataIndex => {\n                    let row = books[dataIndex];\n                    return row[BOOK_FIELDS.series] ? `${row[BOOK_FIELDS.series]} #${row[BOOK_FIELDS.series_position]}` : ''\n                },\n                customFilterListOptions: {\n                    render: v => v.map(e => `Series: ${e}`)\n                },\n                filterType: 'custom',\n                filterOptions: {\n                    logic: (el, filters) => filters.length && !filters.some(e => e === el),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            filterSelectedOptions\n                            filterOptions={(options, state) =>\n                                matchSorter(options, state.inputValue,)}\n                            multiple\n                            onChange={(event, value) => {\n                                onChange(value, index, column)\n                            }}\n                            options={[...new Set(books.map(e => e[BOOK_FIELDS.series]).filter(e => Boolean(e)))]}\n                            renderInput={params => <TextField {...params} label={'Series'} />}\n                            value={filterList[index]}\n                        />\n                },\n            }\n        },\n        {\n            label: 'Rating',\n            name: BOOK_FIELDS.rating,\n            options: {\n                searchable: false,\n            }\n        },\n        {\n            label: 'My Review',\n            name: BOOK_FIELDS.my_review,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Notes',\n            name: BOOK_FIELDS.notes,\n            options: {\n                filter: false,\n            }\n        },\n        {\n            label: 'Updated',\n            name: 'updated',\n            options: {\n                customBodyRenderLite: dataIndex => formatDistanceToNowPretty(parseISO(books[dataIndex].updated)),\n                customFilterListOptions: {\n                    render: v => `Updated: ${v[0].name}`\n                },\n                filterOptions: {\n                    logic: (el, filters) => filters.length && isBefore(parseISO(el), filters[0].date),\n                    display: (filterList, onChange, index, column) =>\n                        <Autocomplete\n                            autoComplete\n                            autoHighlight\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.name === val.name}\n                            onChange={(event, value) =>\n                                onChange(value ? [value] : [], index, column)}\n                            options={dateOptions}\n                            renderInput={params => <TextField {...params} label={'Updated'} />}\n                            value={filterList[index].length ? filterList[index][0] : dateOptions[0]}\n                        />\n                },\n                filterType: 'custom',\n                searchable: false,\n                sortDescFirst: true,\n            },\n        }\n    ].map(e => ({\n        ...e,\n        options: {\n            ...e.options,\n            display: !!displayedColumns[e.name],\n            sortThirdClickReset: true,\n        }\n    })), [authors, books, dateOptions, displayedColumns, genres, types]);\n\n    if (loading) return <Loading fullscreen={false} />\n\n    return <>\n        <StyledFab color={'primary'} onClick={() => setSearchBookOpen(true)}>\n            <AddIcon />\n        </StyledFab>\n\n        {bookData &&\n            <AddBook\n                bookData={bookData}\n                onClose={() => setBookData(null)}\n                setAddedSnackbar={setAddedSnackbar} />}\n\n        {searchBookOpen &&\n            <SearchBooks\n                closeSearch={() => setSearchBookOpen(false)}\n                setBookData={setBookData} />}\n\n        <Snackbar\n            open={Boolean(addedSnackbar)}\n            onClose={() => setAddedSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                severity={'success'}\n                onClose={() => setAddedSnackbar(false)}>\n                {addedSnackbar?.message}\n            </Alert>\n        </Snackbar>\n        <StyledTableContainer>\n            <ThemeProvider theme={theme => createMuiTheme({\n                ...theme,\n                overrides: {\n                    MUIDataTable: {\n                        paper: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MUIDataTableHeadCell: {\n                        fixedHeader: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MUIDataTableSelectCell: {\n                        headerCell: {\n                            backgroundColor: 'transparent'\n                        }\n                    },\n                    MuiGrid: {},\n                    MUIDataTableToolbar: {\n                        filterPaper: {\n                            maxWidth: 'calc(100% - 32px) !important',\n                        }\n\n                    }\n                }\n            })}>\n\n                <MUIDataTable\n                    columns={columns}\n                    data={books}\n                    options={options}\n                    title={`${filteredItemsLength || books.length} items`}\n                />\n            </ThemeProvider>\n        </StyledTableContainer>\n    </>\n\n};\n","import { DialogBlurResponsive } from \"../../shared/components/DialogBlurResponsive\";\nimport React, { useMemo, useState } from \"react\";\nimport { Button, Dialog, DialogActions, DialogTitle, TextField, Typography } from \"@material-ui/core\";\nimport styled from \"styled-components\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport { Autocomplete } from \"@material-ui/lab\";\nimport { mapGenres } from \"./utils\";\nimport { useGetGenresQuery } from \"./literatureApi\";\n\nconst FormContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n`;\n\nconst StyledFooter = styled.div`\n  display: flex;\n  align-content: flex-end;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 10px 0;\n`;\n\nconst StyledDiv = styled.div`\n  flex: 1\n`;\n/*Todo consider using 'genres' as an object instead of array for improved performance*/\nexport const GenreEdit = ({\n    editingItem: { id, name, notes, parent },\n    closeEdit,\n    isItemEmpty,\n    itemIdField,\n    createItemMutation,\n    updateItemMutation,\n    deleteItemMutation,\n}) => {\n\n    const { data: genres } = useGetGenresQuery()\n    const [createGenre] = createItemMutation()\n    const [updateGenre] = updateItemMutation()\n    const [deleteGenre] = deleteItemMutation()\n\n    const [deleteDialog, setDeleteDialog] = useState(false)\n    const [saveDialog, setSaveDialog] = useState(false)\n\n    const genresWithNull = useMemo(() => {\n        let arr = [\n            {\n                ancestors: [],\n                fullName: '<Top Level>',\n                id: null,\n                name: '<Top Level>',\n                parent: null\n            },\n            ...genres.map(e => mapGenres(e, genres)),\n        ].sort((a, b) => a.fullName.localeCompare(b.fullName))\n\n        /* Don't allow a genre to have itself as the parent */\n        let ownIdx = arr.findIndex(e => e.id === id)\n        if (ownIdx !== -1) arr.splice(ownIdx, 1)\n        return arr\n    }, [genres, id])\n\n    const {\n        control,\n        handleSubmit,\n        formState: {\n            isDirty\n        },\n    } = useForm({\n        defaultValues: {\n            name,\n            notes,\n            parent: genresWithNull.find(e => e.id === parent) || genresWithNull[0],\n        }\n    });\n\n\n\n    const onCloseCheckDirty = () => isDirty ? setSaveDialog(true) : closeEdit()\n    const parseData = ({ parent, ...data }) => ({ parent: parent.id, ...data })\n    const onSubmit = () => {\n        handleSubmit(data => id ?\n            updateGenre({ id, ...parseData(data) }) :\n            createGenre(parseData(data))\n        )()\n        closeEdit()\n    }\n\n    const footer = (\n        <StyledFooter>\n            <StyledDiv />\n            {id && <Button onClick={() => setDeleteDialog(true)}>Delete</Button>}\n            <Button onClick={onSubmit} color={'primary'}>Submit</Button>\n        </StyledFooter>\n    )\n\n\n    return <>\n        <Dialog\n            open={saveDialog}\n            onClose={() => setSaveDialog(false)}>\n            <DialogTitle>Discard changes?</DialogTitle>\n            <DialogActions>\n                <Button onClick={closeEdit} color={'primary'}>Discard</Button>\n                <Button onClick={() => setSaveDialog(false)}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <Dialog\n            open={deleteDialog}\n            onClose={() => setDeleteDialog(false)}>\n            <DialogTitle>Delete '{name}'?</DialogTitle>\n            <DialogActions>\n                <Button\n                    onClick={() => {\n                        deleteGenre({ id })\n                        closeEdit()\n                    }}\n                    color={'primary'}>\n                    Delete\n                </Button>\n                <Button onClick={() => setDeleteDialog(false)}>Cancel</Button>\n            </DialogActions>\n        </Dialog>\n        <DialogBlurResponsive\n            open\n            onClose={onCloseCheckDirty}\n            footer={footer}>\n\n            <FormContainer>\n\n                <Controller\n                    name={'name'}\n                    control={control}\n                    render={({ field: { ref, ...field } }) =>\n                        <StyledTextField\n                            {...field}\n                            autoFocus\n                            label={'Name'}\n                            variant={'outlined'} />} />\n\n                <Controller\n                    name={'notes'}\n                    control={control}\n                    render={({ field: { ref, ...field } }) =>\n                        <StyledTextField\n                            {...field}\n                            label={'Notes'}\n                            variant={'outlined'} />} />\n\n                <Controller\n                    name={'parent'}\n                    control={control}\n                    render={({ field: { ref, onChange, ...field } }) =>\n                        <Autocomplete\n                            {...field}\n                            disableClearable\n                            getOptionLabel={e => e.name}\n                            getOptionSelected={(opt, val) => opt.id === val.id}\n                            groupBy={e => e.ancestors.length ? e.ancestors.join(' > ') : ''}\n                            onChange={(event, value) => onChange(value)}\n                            options={genresWithNull}\n                            renderInput={params => <TextField label={'Parent'} {...params} variant={'outlined'} />}\n                            renderOption={e => e.ancestors.length ?\n                                <Typography style={{ marginLeft: '20px' }}>{e.name}</Typography> : e.name}\n                        />} />\n\n            </FormContainer>\n\n        </DialogBlurResponsive>\n    </>\n};","import { Fab } from \"@material-ui/core\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport React, { useEffect, useState } from \"react\";\nimport { SortableTreeWithoutDndContext as SortableTree } from 'react-sortable-tree';\nimport 'react-sortable-tree/style.css';\nimport styled from 'styled-components';\nimport { BACKGROUND_COLOR } from \"../../shared/components/backgroundScreen\";\nimport { Loading } from \"../../shared/components/Loading\";\nimport { useGetBooksQuery } from \"./literatureApi\";\nimport { getTreeDataFromGenres, recursiveSort } from \"./utils\";\n\n\nconst StyledSortableTree = styled(SortableTree)`\n\n  .rst__lineHalfHorizontalRight::before,\n  .rst__lineFullVertical::after,\n  .rst__lineHalfVerticalTop::after,\n  .rst__lineHalfVerticalBottom::after,\n  .rst__lineChildren::after {\n    background-color: white;\n  }\n\n  .rst__rowContents {\n    background-color: transparent;\n    border: none;\n    box-shadow: none;\n  }\n\n  .rst__moveHandle {\n    width: 20px;\n    border: none;\n    box-shadow: none;\n    background-color: transparent;\n  }\n`\n\nconst StyledFab = styled(Fab)`\n  position: fixed;\n  z-index: 1;\n  bottom: 20px;\n  right: 20px;\n`;\n\n\nconst Container = styled.div`\n  ${BACKGROUND_COLOR};\n`\n\nexport const GenreTreeView = ({\n    updateItemMutation,\n    items: genres,\n    loading,\n    setEditingItem,\n}) => {\n\n    const [treeState, setTreeState] = useState([])\n\n    const { data: books } = useGetBooksQuery()\n    const [updateGenre] = updateItemMutation()\n\n    /* Set tree state */\n    useEffect(() => {\n        if (!genres || !books) return\n        setTreeState(recursiveSort(getTreeDataFromGenres(setEditingItem)(genres, books), (a, b) => a.name.localeCompare(b.name)))\n    }, [books, genres, setEditingItem])\n\n    /* TODO Why can't I update name/notes and parent simultaneously? */\n    const onMoveNode = ({\n        node: { title, id, children, parent, ...data },\n        nextParentNode\n    }) => {\n        if (parent === (nextParentNode ? nextParentNode.id : null)) return\n        updateGenre({ id, parent: nextParentNode && nextParentNode.id, ...data })\n    }\n\n    if (loading || !genres || !books) return (\n        <Loading fullscreen={false} />\n    )\n\n    return (\n        <Container>\n            <StyledFab color={'primary'} onClick={() => setEditingItem(true)}>\n                <AddIcon />\n            </StyledFab>\n            \n                <StyledSortableTree\n                    canDrop={({ prevParent, nextParent }) => prevParent?.id !== nextParent?.id}\n                    getNodeKey={({ node }) => node.id}\n                    onChange={setTreeState}\n                    onMoveNode={onMoveNode}\n                    rowHeight={35}\n                    treeData={treeState}\n                    isVirtualized={false}\n                />\n            \n        </Container>\n    )\n}\n\n\n","import HomeIcon from '@material-ui/icons/Home';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\nimport PeopleIcon from '@material-ui/icons/People';\nimport TitleIcon from '@material-ui/icons/Title';\nimport { GenericList } from '../../shared/components/GenericList/GenericList';\nimport { Books } from \"./Books\";\nimport { Genres } from './Genres';\nimport { useCreateAuthorMutation, useCreateTypeMutation, useDeleteAuthorMutation, useDeleteTypeMutation, useGetAuthorsQuery, useGetTypesQuery, useUpdateAuthorMutation, useUpdateTypeMutation } from './literatureApi';\n\nexport const submodules = {\n    BOOKS: {\n        name: 'Books',\n        Icon: HomeIcon,\n        jsx: Books,\n    },\n    AUTHORS: {\n        name: 'Authors',\n        Icon: PeopleIcon,\n        jsx: GenericList,\n        props: {\n            getItemsQuery: useGetAuthorsQuery,\n            createItemMutation: useCreateAuthorMutation,\n            updateItemMutation: useUpdateAuthorMutation,\n            deleteItemMutation: useDeleteAuthorMutation,\n            defaultItemValues: { name: '', notes: '' }\n        }\n    },\n    GENRES: {\n        name: 'Genres',\n        Icon: InsertDriveFileIcon,\n        jsx: Genres\n    },\n    TYPES: {\n        name: 'Types',\n        Icon: TitleIcon,\n        jsx: GenericList,\n        props: {\n            getItemsQuery: useGetTypesQuery,\n            createItemMutation: useCreateTypeMutation,\n            updateItemMutation: useUpdateTypeMutation,\n            deleteItemMutation: useDeleteTypeMutation,\n            defaultItemValues: { name: '', notes: '' }\n        }\n    }\n}","import { Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, IconButton } from \"@material-ui/core\";\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport { useEffect, useState } from \"react\";\nimport { GenericList } from \"../../shared/components/GenericList/GenericList\";\nimport { GenreEdit } from './GenreEdit';\nimport { GenreTreeView } from \"./GenreTreeView\";\nimport { useCreateGenreMutation, useDeleteGenreMutation, useGetGenresQuery, useUpdateGenreMutation } from \"./literatureApi\";\n\n\nexport const Genres = ({ setTitleEndAdornment }) => {\n\n    const [genreInfoDialogOpen, setGenreInfoDialogOpen] = useState(false);\n\n    useEffect(() => {\n        setTitleEndAdornment(<>\n            <IconButton onClick={() => setGenreInfoDialogOpen(true)}>\n                <InfoOutlinedIcon />\n            </IconButton>\n        </>)\n        return () => setTitleEndAdornment(null)\n    }, [setTitleEndAdornment])\n\n    return <>\n        <Dialog\n            fullScreen={false}\n            disableScrollLock\n            open={genreInfoDialogOpen}\n            onClose={() => setGenreInfoDialogOpen(false)}>\n            <DialogTitle>Genre Notes</DialogTitle>\n            <DialogContent>\n                <DialogContentText component={'div'}>\n                    A book can belong to multiple tags e.g.\n                    <ul>\n                        <li>Fahrenheit 451 belongs to 'Science Fiction', 'Dystopian'</li>\n                    </ul>\n\n                    Books can be tagged with both a tag as well as its parent:\n                    searching for the parent tag will also include all child tags\n\n                    <ul>\n                        <li>If a tag is deleted/modified, it is deleted/modified on all books</li>\n                        <li>A parent tag cannot be deleted if it has children</li>\n                    </ul>\n\n                    Also, book counts by genre will not add up to the total number of books. This is because\n                    some books can belong to two top-level genres, for example Finance and Programming.\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button color={'primary'} onClick={() => setGenreInfoDialogOpen(false)}>Close</Button>\n            </DialogActions>\n        </Dialog>\n        <GenericList\n            getItemsQuery={useGetGenresQuery}\n            createItemMutation={useCreateGenreMutation}\n            updateItemMutation={useUpdateGenreMutation}\n            deleteItemMutation={useDeleteGenreMutation}\n            defaultItemValues={{ name: '', notes: '' }}\n            List={GenreTreeView}\n            ItemEdit={GenreEdit}\n        />\n    </>\n}","\nimport { baseApi } from './../../app/network-core/baseApi';\n\nbaseApi.enhanceEndpoints({\n    addTagTypes: ['otpStatus', 'browsers']\n})\n\nconst accountApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        getBrowsers: build.query({\n            query: () => 'account/browsers/',\n            providesTags: ['browsers']\n        }),\n        forgetAndLogoutBrowser: build.mutation({\n            query: id => ({\n                url: `account/browsers/${id}/`,\n                method: 'DELETE'\n            }),\n            invalidatesTags: ['browsers']\n        }),\n\n        getOtpStatus: build.query({\n            query: () => 'account/twofactor/',\n            providesTags: ['otpStatus']\n        }),\n\n        modify2Fa: build.mutation({\n            query: data => ({\n                url: 'account/twofactor/',\n                method: 'POST',\n                body: data\n            }),\n            invalidatesTags: ['otpStatus']\n        })\n    })\n})\n\nexport const {\n    useGetBrowsersQuery,\n    useForgetAndLogoutBrowserMutation,\n    useGetOtpStatusQuery,\n    useModify2FaMutation,\n} = accountApi","import { Button, Card, CardActionArea, CardActions, CardContent, Chip, Typography } from \"@material-ui/core\";\nimport DesktopWindowsIcon from \"@material-ui/icons/DesktopWindows\";\nimport PhoneIphoneIcon from \"@material-ui/icons/PhoneIphone\";\nimport PublicIcon from '@material-ui/icons/Public';\nimport { getName } from \"country-list\";\nimport { format, parseJSON } from \"date-fns\";\nimport { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { theme } from \"../../app/theme\";\nimport ChromeLogo from '../../shared/static/browserLogos/chrome.png';\nimport EdgeLogo from '../../shared/static/browserLogos/edge.png';\nimport FirefoxLogo from '../../shared/static/browserLogos/firefox.png';\nimport SafariLogo from '../../shared/static/browserLogos/safari.png';\nimport { formatDistanceToNowPretty, prettifyUAString } from \"../../shared/util\";\n\nconst StyledCard = styled(Card)`\n  outline: ${props => props.$thisDevice ? '2px solid ' + theme.palette.primary.main : 'none'};\n`;\n\nconst StyledTypography = styled(Typography)`\n  margin: 10px 0;\n`;\n\nconst ImageDiv = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst SavedBrowserDiv = styled.div`\n  width: 100%;\n  height: 32px;\n  display: flex;\n  justify-content: flex-end;\n`;\n\nconst BrowserLogoDiv = styled.div`\n  background: no-repeat url(${props => props.$image}) center/contain;\n  margin: 0 6px;\n  width: 32px;\n  height: 32px\n`;\n\nconst CardContainer = styled.div`\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst BrowserLogo = {\n    Chrome: ChromeLogo,\n    Firefox: FirefoxLogo,\n    Edge: EdgeLogo,\n    Safari: SafariLogo,\n};\n\nexport const BrowserCard = ({\n                                browser: {\n                                    id,\n                                    is_active,\n                                    is_current_session,\n                                    is_saved,\n                                    first_login,\n                                    last_activity,\n                                    ip,\n                                    country_code,\n                                    user_agent,\n                                },\n                                forgetAndLogoutBrowser,\n                            }) => {\n\n    const prettifiedUserAgent = prettifyUAString(user_agent);\n    const browserName = prettifiedUserAgent.browserName;\n    const [detailView, setDetailView] = useState(false);\n\n    return <>\n        <StyledCard $thisDevice={is_current_session} key={id}>\n            <CardContainer>\n                <CardActionArea onClick={() => setDetailView(!detailView)}>\n                    <CardContent>\n                        {detailView ?\n                            <>\n                                <Typography variant={'body1'}>First Login</Typography>\n                                <Typography variant={'body2'}\n                                            color={'textSecondary'}>{format(parseJSON(first_login), 'PPpp')}</Typography>\n                                <Typography variant={'body1'}>Last Activity</Typography>\n                                <Typography variant={'body2'}\n                                            color={'textSecondary'}>{format(parseJSON(last_activity), 'PPpp')}</Typography>\n                                <Typography variant={'body1'}>User-Agent</Typography>\n                                <Typography variant={'body2'} color={'textSecondary'}>{user_agent}</Typography>\n\n                            </> :\n                            <>\n                                <ImageDiv>\n                                    {prettifiedUserAgent.isMobile ? <PhoneIphoneIcon/> : <DesktopWindowsIcon/>}\n                                    {browserName in BrowserLogo ? <BrowserLogoDiv $image={BrowserLogo[browserName]}/> :\n                                        <PublicIcon/>}\n                                    <SavedBrowserDiv>\n                                        {is_saved && <Chip label={'Saved'} color={'primary'}/>}\n                                    </SavedBrowserDiv>\n                                </ImageDiv>\n\n                                <StyledTypography variant={'body1'}>{prettifiedUserAgent.name}</StyledTypography>\n                                <Typography variant={'body2'}>{getName(country_code)}</Typography>\n                                <Typography variant={'body2'} style={{overflowWrap: 'break-word'}}>{ip}</Typography>\n                                <StyledTypography variant={'body2'}\n                                                  color={'textSecondary'}>{formatDistanceToNowPretty(parseJSON(last_activity))}</StyledTypography>\n                            </>\n                        }\n                    </CardContent>\n                </CardActionArea>\n                <CardActions>\n                    {(is_active || is_saved) ?\n                        <Button color={'primary'}\n                                onClick={() => forgetAndLogoutBrowser(id)}>\n                            {is_active ? 'Logout' : 'Forget'}\n                        </Button> :\n                        null}\n                </CardActions>\n            </CardContainer>\n        </StyledCard>\n    </>\n};","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAALN0lEQVRYhYWXeVBT1wLGj6/2tf/0ddqZNx2XmhtsXZqEXW2n8/qc9lWrkntvkpuAUERxAUXFBTfCEhXclVWQAoJLtaXzurl1sSq5WQDZgiA3CSGIS12rVluLJPd7f4RE1Fd7/krmzpzvd77vO+fcS8ifDABDDMBQ/39tx91XGUtPLGtxVNOWThttar+h5Fsf0HzDA8ZsucWYzwi0+eTXtOXEKrbhWOjguQw4PfRphWcMLfCc/3fs2TtBKtPlYpXp4jWGd4Pmu0DzdtB8J5R8O5RGG5TGRih5C5T8GdCmH8CYj3lVli8tmubDiTUDc9Wg5jkAQ/5SfPCq1eZfclWmayJrvALWeAkq/pKXNfZ6WL7HS5tcIs3bQZvOQ2lqF5V8i0gb6zw0b/TQph/AWr8E13AAMS3lrlkdxcyg+f/2l+LaVozgTHea1cabUNXegJq//lDFXxVZ/gpY/hJYvheMsQe00YUABH8OSmMzlMY6MOaT0NR/5dE1ftof01yGuLYCzO7c/olfpwY1z/2p+MzGvnGc6e4tde1tcMY7fWr+tqiuvQlV7XWojFfB8j43WL4XDO8GbewCzQug+Q4ojW1Q8mfBWn4C1/AVopsPIM5W5pl1Lq9/zvnNmO/ccMovboDhkRP+zGe1YgRnundLXXsXGuPdh+ra21DX/gJ17S2oam+Arb0K1vgzWONlMMaLYPgeMMZu0LxjwIV20HwjVNaT0J79EjNb9uPjthLMPr8Tc4XcvgXOLCx067/z6wIYQgYXgzPdb/aLa4x3wZl+BWe+B87yKzSW21Cbb0Ftvg6WvwLG6IvhEYCvlLTpLNR1P0LX+F/EtlZjVnsxEju3Yb5jPRa6MvpSelYh9fKqzQMuDA1Yz5nv5apr74Az3evTWu5DfeYXRB29iKk1dnxwsA0fHLRhyhcdmHHcCaa2FyrrFbCmXtC1g3vQDsZUD03994hu+gJxtr1I6CjEXGELkrqykdKzRlx6cYW47FIqVlxfERaIILrxj9Fq/o7ImX8Fc/K6OLmiBWGGH/BW2hGMX3EE41cexVtpRyFbdQSKdUcQkXMC/640IepHAay1GzQvQDnQAcZsgab+OKKbP0OcrQKzO/Ixz74Jya5MLLmwCisuL+tPu5KC1VcXHwkAqPmbuzXmW/jPofMPZauPY8zSo5Ct/Qkh2SaEbbQiLLcO4ZvqEL7JivAcE0INpyBfcwwhGd+K739mERlL58AuaAJjNkJTfwTRTYcQZyvD7I5dmGfPwUKXHksupGHF5aVYfS0Zq68lY+3N1AlEa7n7qsZ67fp7FU0YnXxElK09gxBDHUI3NiF8kw0RW9sRub0DkTs6ELnjHCK3tyJya6N3wlarJ2zjGcjTvsV7lSc9jKXFqzRawZhPQVP/FaKbDiDOVoqEjh2YZ9+IZFc6lvSsxPJLS7Hq6kLPqp8XIu1qSgGJabsR+/5hG4KSjnkVGRaErG9CWG47IrY5ELnThQl53ZiY78bEwh5MKnTj7aJuz6QCBybuOocJ2xt/m7DV8rtizQlM/vQHsHW1Htr0HdR1X0DXWIXY1mLMat+GRGEDkrrSkeJOQ2pvKlZcXuxdfmkRll1OsZFpJ85Xy9NPQbbG6glZb0PYJjvCt7kQsb0bkTu6EbnLjQl5bkzMd+Ptol7P27svYlJBt+udkgvad4uE4e+U2kdEbLZoQw3fu6d9fxys5RuPynoI2rPlmNlSgPhzWzDnvAHzHeuQ7EpDijsVS3sXi0t7FyG1N+U2mVRgtY1PsyDY0O4NzXUgbHMXwrd0IXyrCxHbXT6Ind2YkH/BO7GgB/J1p7oIIS89fY66Xn7/0FEXbf4MKmu1l2soQUzzTsTZcpHQkYVEYS0WOFYi2ZWKRd2LkeJeiBT3wj9IcFbdDbnehpAcpxia40RorvMpiIgd3ZhYcNHz5oLP8RJRqwghZLLh9IsAhgAYMrnq9IuEEPLh11+rlMZqsJYyj7o+H7rGLZjZsh7xbemY3bEKc4VlmO9YgqSuRWKSMwlJrgW3iULf+ntwtoCQ9Q6EbHDgaYguROZdFMctPYZh72X8NnbxN8MDp9jgE40QMvPcodcY8+57tCkPbN02kWtYj+gmPWJtqxF/bjlmdyxBYucizLMne+fZ52K+I7GOBGcJ9xXZdgQb7Ah+EmKTE+Hb3Ag2tIjDP9yAUUzB/fEfHxj25wDlr7HmrfdoUw4Yi0FU16+DtjENMc2piLOlIL4tCQnt8zCnI7F/zvlZmOtMWE4U2c6fFVkCFAaHGGxwPA6R40D4VjdGzzmEEVM2ixLNHgTF7I8khBCD4dG1uqCx7HlCCGEbNugYcyZY81oPY04Da1kGTX0KdI1JiGmei9jW2fi4Lb4/vm0mEtpjupZgyQtEkeU8K88UoMi2e31ODILI7UKw4RxGRu3A63RhP8VVICj2wBpCCIlY0Pj84NVrm9f9k7GmORnzMrCWxR7GnAzGPA8q62xoGuKha5opxrTo+mY2axDbqkaCoHuXEEKIItNRJs8UoMh0eBRZAgIQBjtCc7vxVhqPEVM3QaLZ45XqqjA6Zl+XXxTAEO3A9appXMyylgVgzIlgLAlgrfFelSXGo7JwHnWdyqupp8E1KKFrYn6LbddMDVxGwQYnJ88QIM+0e+WZdgQgsgWE5nRjTMp3GPHRZlBcBYKi9/dLddUI0h3IJoQQmbbm74Nd0NTPSlDVR7eq6jR9rJWGyhoFlXUGVNbpUNVH3eQa6E8+Pq8eFhAnhJBJhlv/kOuFK/KMTsgz7KLCD5ElIGRjN95MOooR07aC0lYiKHq/KNXtE31OHPRvx6HamsffcGKbp0u4phn/4pqUUVyTMkrbHPWO1qV9+VFnFjz/2BGi0DvyZHoBiozOh/IMAYpMO+SZnQje4MKYhScwcto2UNq9CIreB2l0tZfSVkGq3Ysg3b5E/xyTDaeHTjte+MLgcj45JlcZXnxy5xBCCAnL6ZbI9UK/TN8JeYYg+iIRoFjfhXHLagcAKn0AumpQuiovpa2ElKuElNtb80Z09egnxbSoec5w2jDUAPIYEMXmUdSUTeMCEJMNvhcSWaZ9vSy9E/IMoU+u74Q8oxOKLAdka1vxOp0PiXoPpNHVPgBtFaTaKpHSVnooTTmkXIVHypV/LtWWc+PVFRKZwdcNvzNjYyqHB9GFMyi6oHTUR1swcsrGbP+zx6yQ64WzsvROKPTCQ5kfItsJafwhvB6VB6muahDAXki5CgRpyvspzSeQqstAqfZAqt7TR7GlbootaabY4iaKKeqSMIW/S5QFkMzYhdc/2tL6VAzaGt9LaURuzzCZ3n5Dlt4J+QCEIsuJ8SvrMXLGDlBceQDAF0EFKE05KE25GKQu66fUZR5KVQoJWwIJUwwJUwSKLoSELvBKlPmQTN9xTTI1z7cLnuyKP4oQg2uMTG+/IVvXCZle6JPpBVGR5cQb874NlFGq8wFQAYBHDlCqPaJEVeKl2N1eCVvsoeiiBxJlASTK/JtSOn9swPr/29IBiIjcnmH+OPyRyDPtYlD8YR8EVwGptgpSrjIAQAUASiFhS0UpW/KQYoog8TnQOJYuGv5M8SchCCFEluHYIE+3ewYigTzT7h2d+KVn5PRt3lF0kegrYCWkXKUo5T7xSjVlHkpd6qUGIqCYYo+ELtowuJDPFPcPfycIISTU4KbkekeBPN1+Va4XIM9yYtxyC6RxBzGKLsSoqHyMogt9guxuSNjdoJjiqxRTXDCOLaUCc2r/z+fYswaAIYPdUGy+8EpwZleMIkPYqzB0twZnO2+8tabpwdiUnx68Offrm0GzDtukuopqibokdlRsySuDV/2sr+L/AQcz2f3oSSi0AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","import { Typography } from \"@material-ui/core\";\nimport { compareDesc, parseJSON } from \"date-fns\";\nimport styled from 'styled-components';\nimport { useForgetAndLogoutBrowserMutation, useGetBrowsersQuery } from \"./accountApi\";\nimport { BrowserCard } from \"./BrowserCard\";\n\nconst Grid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  grid-auto-rows: 1fr;\n  gap: 20px 20px;\n  margin: 20px;\n`;\nconst GridContainer = styled.div`\n  max-width: 1000px;\n`;\n\nexport const Browsers = () => {\n\n    const [forgetAndLogoutBrowser] = useForgetAndLogoutBrowserMutation()\n    const { data: browsers } = useGetBrowsersQuery()\n\n    return <GridContainer>\n        <Typography variant={'h5'} style={{ marginLeft: '10px' }}>Active Browsers</Typography>\n        <Grid>\n            {browsers && browsers\n                .filter(e => e.is_active)\n                .sort((a, b) => compareDesc(parseJSON(a.last_activity), parseJSON(b.last_activity)))\n                .map(browser => <BrowserCard\n                    key={browser.id}\n                    browser={browser}\n                    forgetAndLogoutBrowser={forgetAndLogoutBrowser}\n                />)}\n        </Grid>\n\n        <Typography variant={'h5'} style={{ marginLeft: '10px' }}>Inactive Browsers</Typography>\n\n        <Grid>\n            {browsers && browsers\n                .filter(e => !e.is_active)\n                .sort((a, b) => compareDesc(parseJSON(a.last_activity), parseJSON(b.last_activity)))\n                .map(browser => <BrowserCard\n                    key={browser.id}\n                    browser={browser}\n                    forgetAndLogoutBrowser={forgetAndLogoutBrowser}\n                />)}\n        </Grid>\n    </GridContainer>\n};","import { Button, TextField, Typography } from \"@material-ui/core\";\nimport { parseJSON } from \"date-fns\";\nimport QRCode from \"qrcode.react\";\nimport { useState } from \"react\";\nimport { formatDistanceToNowPretty } from \"../../shared/util\";\nimport { useModify2FaMutation, useGetOtpStatusQuery } from \"./accountApi\";\n\nexport const TwoFactor = () => {\n\n    const [otp, setOtp] = useState('');\n    const [secret, setSecret] = useState();\n\n    const { data: otpStatus } = useGetOtpStatusQuery()\n    const [modify2Fa] = useModify2FaMutation()\n\n    const register = () =>\n        modify2Fa({ action: 'register' })\n            .unwrap()\n            .then(r => setSecret(r['otpauth_url']));\n\n    const enable = () => modify2Fa({ action: 'enable', otp })\n\n    const disable = () => modify2Fa({ action: 'disable', otp })\n\n    if (!otpStatus) return null\n\n    return <>\n        {secret && <a href={secret}><QRCode value={secret} /></a>}\n        <Typography variant={'body1'}>OTP is {otpStatus['2fa_enabled'] ? 'enabled' : 'disabled'}.</Typography>\n        <Typography\n            variant={'body1'}>Created: {otpStatus['created'] && formatDistanceToNowPretty(parseJSON(otpStatus['created']))}</Typography>\n        <Button color={'primary'} variant={'contained'} onClick={register}>Register</Button>\n        <Button color={'primary'} variant={'contained'} onClick={enable}>Enable</Button>\n        <Button color={'secondary'} variant={'contained'} onClick={disable}>Disable</Button>\n        <TextField\n            value={otp}\n            onChange={e => setOtp(e.target.value)}\n        />\n    </>\n};","import { List, ListItem, ListItemIcon, ListItemText, Typography } from \"@material-ui/core\";\nimport PublicIcon from '@material-ui/icons/Public';\nimport VpnKeyIcon from '@material-ui/icons/VpnKey';\nimport { useEffect, useState } from \"react\";\nimport { BackgroundScreen } from \"../../shared/components/backgroundScreen\";\nimport { Browsers } from \"./Browsers\";\nimport { TwoFactor } from \"./TwoFactor\";\n\nconst SUBMODULES = {\n    BROWSERS: {\n        name: 'Browsers',\n        appDrawer: <>\n            <ListItemIcon>\n                <PublicIcon />\n            </ListItemIcon>\n            <ListItemText primary={'Browsers'} />\n        </>,\n        jsx: <Browsers />\n    },\n    TWOFACTOR: {\n        name: '2FA Settings',\n        appDrawer: <>\n            <ListItemIcon>\n                <VpnKeyIcon />\n            </ListItemIcon>\n            <ListItemText primary={'2FA Settings'} />\n        </>,\n        jsx: <TwoFactor />\n    }\n};\n\nexport const Account = ({ setTitleContent, setDrawerContent }) => {\n    const [submodule, setSubmodule] = useState(Object.keys(SUBMODULES)[0]);\n\n    useEffect(() => {\n        setDrawerContent(<List disablePadding>\n            {Object.entries(SUBMODULES).map(([k, v]) =>\n                <ListItem key={k}\n                    button\n                    onClick={() => setSubmodule(k)}\n                >{v.appDrawer}</ListItem>)}\n        </List>)\n    }, [setDrawerContent])\n\n    useEffect(() => {\n        setTitleContent(<Typography variant={'h6'}>{SUBMODULES[submodule].name}</Typography>)\n    }, [setTitleContent, submodule])\n\n    return <BackgroundScreen>\n        {SUBMODULES[submodule].jsx}\n    </BackgroundScreen>\n};","\nimport { FILES_URL } from '../../app/urls';\nimport { baseApi } from './../../app/network-core/baseApi';\n\nconst dvrApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        getOrRefreshChannel: build.query({\n            query: channel => ({\n                url: 'dvr/',\n                params: { channel }\n            })\n        }),\n    })\n})\n\nexport const {\n    useGetOrRefreshChannelQuery\n} = dvrApi\n\nexport const getChannelUrl = (uuid, channel) =>\n`${FILES_URL}/dvr_stream/${uuid}/${channel}.mpd`;","import { List, ListItem, ListItemText, Typography } from \"@material-ui/core\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport 'shaka-player/dist/controls.css';\nimport shaka from 'shaka-player/dist/shaka-player.ui';\nimport styled from 'styled-components';\nimport { getChannelUrl, useGetOrRefreshChannelQuery } from \"./dvrApi\";\n\nconst CHANNELS = [\n    'CAM_1',\n    'CAM_2',\n    'CAM_5',\n];\n\nconst REFRESH_INTERVAL = 10_000;\n\nconst VideoDiv = styled.div`\n  width: min(100%, 1280px)\n`;\n\nconst StyledVideo = styled.video`\n  width: 100%;\n  height: 100%;\n`;\n\nexport const Dvr = ({ setDrawerContent, setTitleContent, setSidebarName }) => {\n\n    const [channel, setChannel] = useState(CHANNELS[0]);\n    const player = useRef();\n\n    const { data } = useGetOrRefreshChannelQuery(channel, { pollingInterval: REFRESH_INTERVAL })\n\n    useEffect(() => {\n        if (data) {\n            player.current?.load(getChannelUrl(data.stream_uuid, channel))\n        }\n    }, [channel, data]);\n\n    // Initialize polyfills (required)\n    useEffect(() => {\n        shaka.polyfill.installAll();\n        return () => {\n            if (player.current) {\n                player.current.unload();\n                player.current.destroy()\n            }\n        }\n    }, []);\n\n    useEffect(() => {\n        setDrawerContent(<List>\n            {CHANNELS.map(channel =>\n                <ListItem\n                    key={channel}\n                    button\n                    onClick={() => switchChannel(channel)}>\n                    <ListItemText primary={channel} />\n                </ListItem>)}\n        </List>)\n    }, [setDrawerContent])\n\n    useEffect(() => {\n        setTitleContent(<Typography variant={'h6'}>{channel}</Typography>)\n    }, [setTitleContent, channel])\n\n    // Init and attach to video element\n    const attachPlayer = videoEl => {\n        /*Do not reinitialize video element if a null element is passed, or player already exists*/\n        if (!videoEl || player.current) return;\n        if (!shaka.Player.isBrowserSupported()) {\n            console.error('Shaka player not supported');\n            return\n        }\n\n        player.current = new shaka.Player(videoEl);\n        player.current.addEventListener('error', e => console.error('Shaka player error: ', e.detail));\n\n        /* Set up video controls\n        videoEl.parentNode is guaranteed to have been mounted, if videoEl itself was mounted*/\n        let ui = new shaka.ui.Overlay(player.current, videoEl.parentNode, videoEl);\n        let controls = ui.getControls();\n        controls.addEventListener('UIError', e => console.error('Shaka UI error: ', e.detail))\n    };\n\n    const switchChannel = channel =>\n        void player.current?.unload()\n            .then(setChannel(channel));\n\n\n    return <VideoDiv data-shaka-player-container>\n        <StyledVideo\n            data-shaka-player\n            ref={attachPlayer}\n            id=\"video\"\n            autoPlay />\n    </VideoDiv>\n};","import { baseApi } from \"../../app/network-core/baseApi\";\nimport { baseQueryWithRetry } from \"../../app/network-core/baseQuery\";\n\n\nexport const testingApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        throwHttpError: build.mutation({\n            query: status => ({\n                url: 'test/',\n                params: {status}\n            })\n        }),\n        throwFetchError: build.mutation({\n            queryFn: (arg, api, extraOptions) =>\n                baseQueryWithRetry({\n                    baseUrl: 'https://dummy.nicholaslyz.com',\n                    credentials: \"include\"\n                })(arg, api, extraOptions)\n        }),\n        mutationTest: build.mutation({\n            query: () => 'test/mutationTest/'\n        })\n    })\n})\n\nexport const {\n    useThrowHttpErrorMutation,\n    useThrowFetchErrorMutation,\n    useMutationTestMutation,\n} = testingApi","import {createAsyncThunk} from \"@reduxjs/toolkit\";\n\nexport const throwAsyncThunkReject = createAsyncThunk('testing/asyncThunkReject', async () => {\n    throw new Error('Testing: AsyncThunkReject')\n})\n\nexport const throwAsyncThunkRejectWithValue = createAsyncThunk('testing/asyncThunkRejectWithValue', async(arg, {rejectWithValue}) => {\nreturn rejectWithValue('Testing: AsyncThunkRejectWithValue')\n})","import {Button} from \"@material-ui/core\";\nimport {useMutationTestMutation, useThrowFetchErrorMutation, useThrowHttpErrorMutation} from \"./testingApi\";\nimport {useDispatch} from \"react-redux\";\nimport {throwAsyncThunkReject, throwAsyncThunkRejectWithValue} from \"./util\";\nimport styled from 'styled-components'\nimport {clearNetworkError} from \"../../app/appSlice\";\n\nconst StyledDiv = styled.div`\n  display: grid;\n  grid-gap: 20px;\n  max-width: 300px;\n  padding: 10px;\n`\n\nexport const Testing = () => {\n\n    const dispatch = useDispatch()\n    const [throwHttpError] = useThrowHttpErrorMutation()\n    const [throwFetchError] = useThrowFetchErrorMutation()\n    const [mutationTest, {data: mutationData}] = useMutationTestMutation()\n\n    return <StyledDiv>\n        <Button variant={'contained'} onClick={() => throwHttpError(401)}>Throw 401 error</Button>\n        <Button variant={'contained'} onClick={() => throwHttpError(500)}>Throw 500 error</Button>\n        <Button variant={'contained'} onClick={() => throwFetchError()}>Throw fetch error</Button>\n        <Button variant={'contained'} onClick={() => dispatch(throwAsyncThunkReject())}>\n            Throw asyncThunkReject\n        </Button>\n        <Button variant={'contained'} onClick={() => dispatch(throwAsyncThunkRejectWithValue())}>\n            Throw asyncThunkRejectWithValue\n        </Button>\n        <Button variant={'contained'} onClick={() => mutationTest()}>Mutation Test - Current Data: {JSON.stringify(mutationData)}</Button>\n        <Button variant={'contained'} onClick={() => dispatch(clearNetworkError())}>Clear</Button>\n    </StyledDiv>\n}","import {getSecureRandom} from \"../../shared/util\";\nimport {formatDistance} from \"date-fns\";\n\nconst DIGITS_REGEX = /\\d/;\nconst LOWER_REGEX = /[a-z]/;\nconst UPPER_REGEX = /[A-Z]/;\nconst SYMBOLS_REGEX = /[!@#$%^&*]/;\n\n\nconst DIGITS = '0123456789';\nconst LOWER = 'abcdefghijklmnopqrstuvwxyz';\nconst UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst SYMBOLS = '!@#$%^&*';\n\nconst secureRandom = getSecureRandom();\nconst formatNumber = new Intl.NumberFormat(undefined, {\n    maximumFractionDigits: 0,\n    maximumSignificantDigits: 3,\n});\n\n/*Gets the entropy in bits for a password, assuming it is completely random*/\nexport const getEntropy = password => {\n\n    let hasDigits = DIGITS_REGEX.test(password);\n    let hasLowerCase = LOWER_REGEX.test(password);\n    let hasUpperCase = UPPER_REGEX.test(password);\n    let hasSymbols = SYMBOLS_REGEX.test(password);\n\n    let totalSymbols =\n        (hasDigits ? 10 : 0) +\n        (hasLowerCase ? 26 : 0) +\n        (hasUpperCase ? 26 : 0) +\n        (hasSymbols ? SYMBOLS.length : 0);\n\n    let bitsPerChar = Math.log2(totalSymbols);\n    let totalEntropy = bitsPerChar * password.length;\n\n    return {\n        length: password.length,\n        hasDigits,\n        hasLowerCase,\n        hasUpperCase,\n        hasSymbols,\n        bitsPerChar,\n        totalEntropy,\n    }\n\n};\n\nexport const generatePassword = ({length = 10, digits = true, lower = true, upper = true, symbols = true} = {}) => {\n\n    if (length < 4) throw new Error('Password length is too short');\n\n    let charSet =\n        (digits ? DIGITS : '') +\n        (lower ? LOWER : '') +\n        (upper ? UPPER : '') +\n        (symbols ? SYMBOLS : '');\n\n    const generate = () => {\n        let password = '';\n        while (password.length < length)\n            password += secureRandom.choice(charSet);\n        return password\n    };\n\n    let password = generate();\n\n    /*Ensure generated password meets criteria*/\n    while ((digits && !DIGITS_REGEX.test(password)) ||\n    (lower && !LOWER_REGEX.test(password)) ||\n    (upper && !UPPER_REGEX.test(password)) ||\n    (symbols && !SYMBOLS_REGEX.test(password))) {\n        password = generate()\n    }\n    return password\n};\n\nwindow.test = generatePassword;\n\nexport const getSha1Hash = async message => {\n    const msgUint8 = new TextEncoder().encode(message);                            // encode as (utf-8) Uint8Array\n    const hashBuffer = await crypto.subtle.digest('SHA-1', msgUint8);    // hash the message\n    const hashArray = Array.from(new Uint8Array(hashBuffer));                      // convert buffer to byte array\n    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();       // convert bytes to hex string\n};\n\nexport const generateUsername = ({length = 8} = {}) => {\n\n    const vowels = ['a', 'e', 'i', 'o', 'u'];\n    const cons = ['b', 'c', 'd', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'r', 's', 't', 'u', 'v', 'w', 'tr', 'cr', 'br', 'fr', 'th', 'dr', 'ch', 'ph', 'wr', 'st', 'sp', 'sw', 'pr', 'sl', 'cl'];\n\n    const num_vowels = vowels.length;\n    const num_cons = cons.length;\n    let password = '';\n\n    for (let i = 0; i < length; i++) {\n        password += cons[Math.floor(secureRandom.random() * num_cons)] + vowels[Math.floor(secureRandom.random() * num_vowels)];\n    }\n\n    return password.substr(0, length);\n};\n\nexport const formatLargeDuration = seconds => {\n    if (seconds < 3.154e+7) {\n        return formatDistance(new Date(0), new Date(seconds * 1000))\n    }\n    if (seconds > 4.4e+17) {\n        return 'longer than the age of the Universe'\n    }\n    return formatNumber.format(seconds / 3.154e+7) + ' years';\n};","import {baseApi} from \"../../app/network-core/baseApi\";\n\n\n\nconst passwordToolsApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        hibpLookup: build.mutation({\n            query: hash => ({\n                url: 'passwords/lookup/',\n                params: {hash}\n            })\n        })\n    })\n})\n\nexport const {useHibpLookupMutation} = passwordToolsApi","import {useCallback, useEffect, useState} from \"react\";\nimport {\n    Button,\n    Checkbox,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    FormControl,\n    FormControlLabel,\n    FormGroup,\n    IconButton,\n    Slider,\n    Snackbar,\n    TextField,\n    Tooltip,\n    Typography\n} from \"@material-ui/core\";\nimport {formatLargeDuration, generatePassword, generateUsername, getEntropy, getSha1Hash} from \"./passwordUtil\";\nimport styled from 'styled-components'\nimport {BACKGROUND_COLOR} from \"../../shared/components/backgroundScreen\";\nimport ReplayIcon from '@material-ui/icons/Replay';\nimport \"@fontsource/jetbrains-mono\"\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\nimport {Alert} from \"@material-ui/lab\";\nimport {debounce} from 'lodash'\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport CheckIcon from '@material-ui/icons/Check';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport {useHibpLookupMutation} from \"./passwordToolsApi\";\n\nconst Container = styled.div`\n  display: flex;\n  max-width: 600px;\n  flex-direction: column;\n  padding: 10px;\n  ${BACKGROUND_COLOR};\n`;\n\nconst StyledTextField = styled(TextField)`\n  .MuiInputBase-input {\n    font-family: \"JetBrains Mono\", monospace\n  }\n\n  margin: 10px 0;\n`;\n\nconst TextFieldContainer = styled.div`\n  display: flex;\n  align-items: flex-start;\n`;\n\nconst StyledIconButton = styled(IconButton)`\n  margin-top: 14px;\n`;\n\nconst OptionsFormGroup = styled(FormGroup)`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst PasswordDetailGrid = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  justify-items: start;\n  gap: 10px 10px;\n  align-items: center;\n  margin: 5px 0 15px;\n`;\n\nconst GreenCheck = styled(CheckIcon)`\n  color: chartreuse;\n  margin-right: 10px;\n`;\n\nconst GreyCross = styled(ClearIcon)`\n  color: grey;\n  margin-right: 10px;\n`;\n\n\nconst formatNumber = new Intl.NumberFormat(undefined, {maximumFractionDigits: 0});\nconst formatDecimal = new Intl.NumberFormat(undefined, {maximumFractionDigits: 2});\n\nconst DEFAULT_USERNAME_LENGTH = 10;\nconst DEFAULT_PASSWORD_LENGTH = 24;\n\nexport const PasswordTools = () => {\n    const [lookupHibp, {isLoading, data}] = useHibpLookupMutation()\n    const {count: hashCount} = data ?? {}\n\n    const [settings, setSettings] = useState({\n        dialogOpen: false,\n        dialogType: null,\n        passwordSettings: {\n            length: DEFAULT_PASSWORD_LENGTH,\n            digits: true,\n            lower: true,\n            upper: true,\n            symbols: true\n        },\n        usernameSettings: {\n            length: DEFAULT_USERNAME_LENGTH\n        }\n    });\n\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [snackbarOpen, setSnackbarOpen] = useState(false);\n    const [entropy, setEntropy] = useState({});\n\n    let secondsToBruteforce = (2 ** entropy.totalEntropy / (200 * 10 ** 18));\n\n    useEffect(() => {\n        if (!password) return;\n\n        let generatedPassword = generatePassword(settings.passwordSettings);\n        setPassword(generatedPassword);\n        setEntropy(getEntropy(generatedPassword))\n        // eslint-disable-next-line\n    }, [settings.passwordSettings]);\n\n    useEffect(() => {\n        setUsername(generateUsername(settings.usernameSettings))\n    }, [settings.usernameSettings]);\n\n    // eslint-disable-next-line\n    const checkHibp = useCallback(debounce(\n        passwordStr =>\n            getSha1Hash(passwordStr)\n                .then(lookupHibp), 500), []);\n\n    const copyToClipboard = text => navigator.clipboard.writeText(text)\n        .then(() => {\n            if (snackbarOpen) {\n                setSnackbarOpen(false);\n                setTimeout(() => setSnackbarOpen(true), 100)\n            } else\n                setSnackbarOpen(true);\n        });\n\n    const onPasswordChange = text => {\n        setPassword(text);\n        checkHibp(text);\n        setEntropy(getEntropy(text))\n    };\n\n    const closeSettings = () => setSettings(current => ({...current, dialogOpen: false}));\n\n    return <>\n        <Dialog open={settings.dialogOpen} onClose={closeSettings}>\n            <DialogTitle\n                style={{zIndex: 1}}>{settings.dialogType === 'username' ? 'Username' : 'Password'} Options</DialogTitle>\n            <DialogContent>\n                {settings.dialogType === 'username' && <>\n                    Length: {settings.usernameSettings.length}\n                    <Slider value={settings.usernameSettings.length}\n                            step={1}\n                            min={6}\n                            max={24}\n                            onChange={(e, value) =>\n                                setSettings(current => ({\n                                    ...current,\n                                    usernameSettings: {\n                                        length: value\n                                    }\n                                }))}/>\n                </>}\n                {settings.dialogType === 'password' && <>\n                    Length: {settings.passwordSettings.length}\n                    <Slider value={settings.passwordSettings.length}\n                            step={1}\n                            min={6}\n                            max={64}\n                            onChange={(e, value) =>\n                                setSettings(current => ({\n                                    ...current,\n                                    passwordSettings: {\n                                        ...current.passwordSettings,\n                                        length: value\n                                    }\n                                }))}/>\n                    <FormControl>\n                        <OptionsFormGroup>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.lower}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         lower: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'a-z'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.upper}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         upper: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'A-Z'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.digits}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         digits: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'0-9'}/>\n                            <FormControlLabel control={<Checkbox checked={settings.passwordSettings.symbols}\n                                                                 onChange={e => setSettings(current => ({\n                                                                     ...current,\n                                                                     passwordSettings: {\n                                                                         ...current.passwordSettings,\n                                                                         symbols: e.target.checked\n                                                                     }\n                                                                 }))}/>}\n                                              label={'!@#$%^&*'}/>\n                        </OptionsFormGroup>\n                    </FormControl>\n                </>}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={closeSettings}>Close</Button>\n            </DialogActions>\n        </Dialog>\n        <Snackbar\n            anchorOrigin={{vertical: 'top', horizontal: 'center'}}\n            open={snackbarOpen}\n            autoHideDuration={3000}\n            onClose={() => setSnackbarOpen(false)}>\n            <Alert severity=\"success\" variant={'filled'}>Copied</Alert>\n        </Snackbar>\n        <Container>\n            <TextFieldContainer>\n                <StyledTextField\n                    variant={'outlined'}\n                    label={'Random Username'}\n                    value={username}\n                    fullWidth\n                    onChange={e => setUsername(e.target.value)}\n                    InputProps={{\n                        endAdornment:\n                            <>\n                                <IconButton onClick={() => copyToClipboard(username)}>\n                                    <FileCopyIcon/>\n                                </IconButton>\n                                <IconButton\n                                    onClick={() => setUsername(generateUsername(settings.usernameSettings))}>\n                                    <ReplayIcon/>\n                                </IconButton>\n                            </>\n                    }}\n                />\n                <StyledIconButton onClick={() => setSettings(current => ({\n                    ...current,\n                    dialogOpen: true,\n                    dialogType: 'username'\n                }))}><SettingsIcon/></StyledIconButton>\n            </TextFieldContainer>\n            <TextFieldContainer>\n                <StyledTextField\n                    variant={'outlined'}\n                    label={'Type a password'}\n                    value={password}\n                    fullWidth\n                    error={!isLoading && Boolean(hashCount)}\n                    helperText={isLoading ? 'Checking...' :\n                        password === '' ? 'Type a password to check, or generate one' :\n                            hashCount > 0 ? `Password cracked ${formatNumber.format(hashCount)} times` :\n                                'Password has not been cracked'}\n                    onChange={e => onPasswordChange(e.target.value)}\n                    InputProps={{\n                        endAdornment:\n                            <>\n                                <IconButton onClick={() => copyToClipboard(password)}>\n                                    <FileCopyIcon/>\n                                </IconButton>\n                                <IconButton\n                                    onClick={() => onPasswordChange(generatePassword(settings.passwordSettings))}>\n                                    <ReplayIcon/>\n                                </IconButton>\n                            </>\n                    }}\n                />\n                <StyledIconButton onClick={() => setSettings(current => ({\n                    ...current,\n                    dialogOpen: true,\n                    dialogType: 'password'\n                }))}><SettingsIcon/></StyledIconButton>\n            </TextFieldContainer>\n            <PasswordDetailGrid>\n                <Typography variant={'body1'} color={entropy.hasLowerCase ? 'textPrimary' : 'textSecondary'}>Lowercase\n                    letters </Typography>\n                {entropy.hasLowerCase ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'} color={entropy.hasUpperCase ? 'textPrimary' : 'textSecondary'}>Uppercase\n                    letters</Typography>\n                {entropy.hasUpperCase ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'}\n                            color={entropy.hasDigits ? 'textPrimary' : 'textSecondary'}>Digits</Typography>\n                {entropy.hasDigits ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'} color={entropy.hasSymbols ? 'textPrimary' : 'textSecondary'}>Symbols\n                    (@#...)</Typography>\n                {entropy.hasSymbols ? <GreenCheck/> : <GreyCross/>}\n\n                <Typography variant={'body1'}>Entropy\n                    <Tooltip\n                        arrow\n                        enterTouchDelay={100}\n                        interactive\n                        title={'A measure of how secure the password is. 128 bits is recommended for most people.'}>\n                        <IconButton tabIndex={-1}>\n                            <InfoOutlinedIcon/>\n                        </IconButton>\n                    </Tooltip>\n                </Typography>\n                <Typography\n                    variant={'body1'}>{entropy.totalEntropy && (formatDecimal.format(entropy.totalEntropy) + ' bits')}</Typography>\n\n                <Typography variant={'body1'}>Time to crack\n                    <Tooltip\n                        arrow\n                        enterTouchDelay={100}\n                        interactive\n                        title={'Based on the current Bitcoin hashrate (200 EH/s)'}>\n                        <IconButton tabIndex={-1}>\n                            <InfoOutlinedIcon/>\n                        </IconButton>\n                    </Tooltip>\n                </Typography>\n                <Typography\n                    variant={'body1'}>{Number.isFinite(secondsToBruteforce) && formatLargeDuration(secondsToBruteforce)}</Typography>\n            </PasswordDetailGrid>\n\n\n        </Container>\n\n    </>\n};","import {baseApi} from \"../../app/network-core/baseApi\";\n\n\nconst homeAutomationApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        sendCommand: build.mutation({\n            query: command => ({\n                url: 'home-automation/send',\n                method: 'POST',\n                body: {command}\n            })\n        })\n    })\n})\n\nexport const {useSendCommandMutation} = homeAutomationApi","import {Button, FormControl, InputLabel, MenuItem, Select, Snackbar} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport React, {useState} from \"react\";\nimport styled from 'styled-components'\nimport {BACKGROUND_COLOR} from \"../../shared/components/backgroundScreen\";\nimport {useSendCommandMutation} from \"./homeAutomationApi\";\n\nconst StyledContainer = styled.form`\n  display: flex;\n  max-width: 600px;\n  height: 200px;\n  justify-content: space-between;\n  flex-direction: column;\n  padding: 20px;\n  ${BACKGROUND_COLOR};\n`;\n\nexport const COMMANDS = {\n    gate_toggle: 'Gate: Toggle',\n    ac_off: 'AC: Off',\n    ac_on_24: 'AC: On @ 24°C',\n    ac_on_25: 'AC: On @ 25°C',\n    ceiling_fan_on: 'Ceiling Fan: On',\n    ceiling_fan_off: 'Ceiling Fan: Off',\n    dyson_fan_on: 'Dyson Fan: On',\n    dyson_fan_off: 'Dyson Fan: Off',\n};\n\nexport const HomeAutomation = () => {\n    const [sendCommand] = useSendCommandMutation()\n\n    const [snackbar, setSnackbar] = useState();\n    const [disabled, setDisabled] = useState(false);\n\n    const handleSubmit = e => {\n        e.preventDefault();\n        setDisabled(true);\n        setTimeout(() => setDisabled(false), 2000);\n        sendCommand(e.target.command.value).unwrap().then(() => setSnackbar(true));\n    };\n\n    return <>\n        <Snackbar\n            anchorOrigin={{vertical: 'top', horizontal: 'center'}}\n            open={snackbar}\n            onClose={() => setSnackbar(false)}\n            autoHideDuration={3000}>\n            <Alert\n                variant={'filled'}\n                severity={'success'}>\n                Command sent\n            </Alert>\n        </Snackbar>\n        <StyledContainer\n            onSubmit={handleSubmit}>\n\n            <FormControl>\n                <InputLabel>Command</InputLabel>\n                <Select\n                    defaultValue={Object.entries(COMMANDS)[0][0]}\n                    name={'command'}\n                    required>\n                    {Object.entries(COMMANDS).map(([k, v]) => <MenuItem value={k} key={k}>{v}</MenuItem>)}\n                </Select>\n            </FormControl>\n            <Button\n                disabled={disabled}\n                variant={'contained'}\n                color={'primary'}\n                type={'submit'}>\n                Send command\n            </Button>\n        </StyledContainer>\n    </>\n};","import InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\nimport {IconButton, InputAdornment, Tooltip} from \"@material-ui/core\";\nimport TextField from \"@material-ui/core/TextField\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\n\n/*Textfield with clear and info buttons*/\nexport const TextFieldClearableInfo = ({info, onChange, ...props}) => {\n\n    return <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    {info && <InputAdornment position={'end'}>\n                        <Tooltip\n                            arrow\n                            enterTouchDelay={100}\n                            interactive\n                            title={info}>\n                            <IconButton tabIndex={-1}>\n                                <InfoOutlinedIcon/>\n                            </IconButton>\n                        </Tooltip>\n                    </InputAdornment>}\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n};","import {TextFieldClearableInfo} from \"../../shared/components/textFieldClearableInfo\";\nimport Cleave from \"cleave.js/react\";\nimport React from \"react\";\n\nconst CleaveTextField = ({inputRef, ...props}) =>\n    <Cleave\n        htmlRef={inputRef}\n        {...props}\n    />;\n\n/*Textfield with clear and info buttons, and currency formatting\n* Permanently shrunk*/\nexport const TextFieldClearableInfoCurrency = ({info, onChange, InputProps, ...props}) => {\n\n    return <TextFieldClearableInfo\n        {...props}\n        info={info}\n        InputLabelProps={{ shrink: true }}\n        InputProps={{\n            ...InputProps,\n            inputComponent: CleaveTextField,\n            inputProps: {\n                options: {\n                    numeral: true,\n                    prefix: '$',\n                    rawValueTrimPrefix: true,\n                }\n            },\n            onChange: e => onChange(e.target.rawValue)\n        }}\n        onChange={onChange}\n    />\n};","import {useWatch} from \"react-hook-form\";\nimport React from \"react\";\n\n/*Isolate rendering of an array of fields (convenience)*/\nexport const FieldUseWatch = ({control, fieldsToWatch, Component}) => {\n    const fields = useWatch({\n        control,\n        name: fieldsToWatch,\n    });\n    return <Component fields={fields}/>\n};","import { baseApi } from \"../../app/network-core/baseApi\";\nimport { baseQueryWithRetry } from \"../../app/network-core/baseQuery\";\n\n/*API Key from dnsproxy@gmail.com*/\nconst ENDPOINT = 'https://finnhub.io/api/v1/quote?symbol=SPY&token=c10sd6n48v6pp7chu95g';\n\nconst optionHedgeCalculatorApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        getSpyPrice: build.query({\n            queryFn: (arg, api) => baseQueryWithRetry({\n                baseUrl: ENDPOINT,\n            })(arg, api),\n        })\n    })\n})\n\nexport const {useGetSpyPriceQuery} = optionHedgeCalculatorApi","import marked from 'marked'\n\n\nexport const explanatoryText = marked(`\nThis calculates a 1:1 put spread (not the 1:1.1 as described in *The Options Edge*)\n\nRehedge in first month ONLY if SPY has moved > 3% from the previous month.\n\n|                   |                                                      |\n|-------------------|------------------------------------------------------|\n| Hedge instrument: | Long 1 year ATM SPY puts, short 3m 8.6% OTM SPY puts |\n| Beta of DPYA:     | 0.99                                                 |\n| Beta of IWDP:     | 0.99                                                 |\n| Beta of IWDA:     | 0.89                                                 |\n| Portfolio Beta:   | 1 (since I'm only hedging CSPX and IWDA)             |\n`)","import {Typography} from \"@material-ui/core\";\nimport React, {useEffect, useState} from \"react\";\nimport {yupResolver} from '@hookform/resolvers/yup'\nimport styled from 'styled-components'\nimport {Controller, useForm} from \"react-hook-form\";\nimport {BACKGROUND_COLOR} from \"../../shared/components/backgroundScreen\";\nimport * as yup from 'yup'\nimport {trim} from \"lodash\";\nimport {TextFieldClearableInfo} from \"../../shared/components/textFieldClearableInfo\";\nimport {TextFieldRefreshLoading} from \"./textFieldRefreshLoading\";\nimport {formatDistanceToNowStrict} from 'date-fns'\nimport {TextFieldClearableInfoCurrency} from \"./TextFieldClearableInfoCurrency\";\nimport {FieldUseWatch} from \"./FieldUseWatch\";\nimport {useGetSpyPriceQuery} from \"./optionHedgeCalculatorApi\";\nimport {explanatoryText} from './explanatoryText'\n\nconst FIELDS = {\n    portfolioValue: 'portfolioValue',\n    spyPrice: 'spyPrice',\n    hedgeRatio: 'hedgeRatio',\n    delta: 'delta',\n};\n\nconst emptyStringToUndefined = (val, origVal) => trim(origVal) === '' ? undefined : val;\n\nconst schema = yup.object({\n    portfolioValue: yup.number().positive().required().transform(emptyStringToUndefined),\n    spyPrice: yup.number().positive().required().transform(emptyStringToUndefined),\n    hedgeRatio: yup.number().positive().max(1).required().transform(emptyStringToUndefined),\n    delta: yup.number().positive().max(1).required().transform(emptyStringToUndefined)\n});\n\nconst Container = styled.div`\n  ${BACKGROUND_COLOR};\n  max-width: 600px;\n`;\n\nconst StyledTypography = styled(Typography)`\n  p {\n      margin: 0 0 10px;\n  }\n`;\n\nconst StyledTextFieldClearableInfo = styled(TextFieldClearableInfo)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\nconst StyledTextFieldRefresh = styled(TextFieldRefreshLoading)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\nconst StyledTextFieldClearableInfoCurrency = styled(TextFieldClearableInfoCurrency)`\n  margin: 10px;\n  width: min(300px, calc(100vw - 20px));\n`;\n\n\n\nconst formatNoDecimals = new Intl.NumberFormat(undefined, {maximumFractionDigits: 0});\nconst formatDecimals = new Intl.NumberFormat(undefined, {maximumFractionDigits: 1});\nconst formatDollars = new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: 'USD',\n    currencyDisplay: 'symbol'\n});\n\nexport const OptionHedgeCalculator = () => {\n    const {refetch, isFetching, data, fulfilledTimeStamp} = useGetSpyPriceQuery()\n\n    const [tooltipText, setTooltipText] = useState('');\n\n    const {\n        control,\n        setValue,\n    } = useForm({\n        mode: 'onTouched',\n        resolver: yupResolver(schema),\n        defaultValues: {\n            [FIELDS.portfolioValue]: '',\n            [FIELDS.spyPrice]: '',\n            [FIELDS.hedgeRatio]: 0.47,\n            [FIELDS.delta]: '',\n        }\n    });\n\n    useEffect(() => void (data && setValue(FIELDS.spyPrice, data.c, {shouldValidate: true})), [data, setValue, fulfilledTimeStamp])\n\n\n    return <Container>\n        <StyledTypography variant={'body1'} dangerouslySetInnerHTML={{__html: explanatoryText}}></StyledTypography>\n\n        <Controller\n            name={FIELDS.portfolioValue}\n            control={control}\n            render={({\n                         field: {ref, ...field},\n                         fieldState: {error}\n                     }) =>\n                <StyledTextFieldClearableInfoCurrency\n                    {...field}\n                    error={Boolean(error)}\n                    helperText={error?.message}\n                    info={'Take beta of IWDA to be 0.89 and exclude bonds e.g. AGGU'}\n                    label={'Beta-weighted Portfolio Value (USD)'}\n                    variant={'outlined'}\n                />}/>\n\n        <Controller\n            name={FIELDS.spyPrice}\n            control={control}\n            render={({\n                         field: {ref, ...field},\n                         fieldState: {error}\n                     }) =>\n                <StyledTextFieldRefresh\n                    {...field}\n                    error={Boolean(error)}\n                    helperText={error?.message}\n                    label={'SPY Price'}\n                    loading={isFetching}\n                    onOpen={() => setTooltipText(fulfilledTimeStamp ? 'Last updated ' + formatDistanceToNowStrict(new Date(fulfilledTimeStamp), {addSuffix: true}) : '')}\n                    onRefresh={refetch}\n                    tooltipText={tooltipText}\n                    variant={'outlined'}/>}/>\n\n\n        <FieldUseWatch\n            control={control}\n            fieldsToWatch={[FIELDS.spyPrice]}\n            Component={({fields: [spyPrice]}) => <Typography variant={'body1'}>\n                Strike price for short 8.6% delta OTM, 90-day\n                put: {formatNoDecimals.format(0.914 * spyPrice)}\n            </Typography>}/>\n\n        <Controller\n            name={FIELDS.hedgeRatio}\n            control={control}\n            render={({\n                         field: {ref, ...field},\n                         fieldState: {error}\n                     }) =>\n                <StyledTextFieldClearableInfo\n                    {...field}\n                    error={Boolean(error)}\n                    info={'% of portfolio value to hedge using put options (via delta equivalent amount)'}\n                    helperText={error?.message}\n                    label={'Hedge Ratio'}\n                    variant={'outlined'}/>}/>\n\n\n        <FieldUseWatch\n            control={control}\n            fieldsToWatch={[FIELDS.hedgeRatio, FIELDS.portfolioValue]}\n            Component={({fields: [hedgeRatio, portfolioValue]}) =>\n                <Typography variant={'body1'}>\n                    Notional amount to hedge: {formatDollars.format(portfolioValue * hedgeRatio)}\n                </Typography>}/>\n\n        <Controller\n            name={FIELDS.delta}\n            control={control}\n            render={({\n                         field: {ref, ...field},\n                         fieldState: {error}\n                     }) =>\n                <StyledTextFieldClearableInfo\n                    {...field}\n                    error={Boolean(error)}\n                    info={'Delta of each spread with OTM 8.6% put sold, per option e.g. 0.250'}\n                    label={'Delta'}\n                    helperText={error?.message}\n                    variant={'outlined'}/>}/>\n\n        <FieldUseWatch\n            control={control}\n            fieldsToWatch={[FIELDS.portfolioValue, FIELDS.hedgeRatio, FIELDS.delta, FIELDS.spyPrice]}\n            Component={({fields: [portfolioValue, hedgeRatio, delta, spyPrice]}) =>\n                <Typography variant={'body1'}>\n                    Number of spreads required (i.e. standard option contracts):\n                    {formatDecimals.format(portfolioValue * hedgeRatio / (delta * spyPrice * 100))}\n                </Typography>}\n        />\n\n    </Container>\n};\n\n/*Testing case:\n*\n* Beta-weighted portfolio value in USD: 1000000\n* Current price of SPY: 300\n* OTM Put Strike to sell: 274.2\n* Hedge ratio: 0.47\n* Notional amount: 470000.0\n* Delta of 8.6% OTM put spread: 0.21\n* Number of spreads required (i.e. option contracts): 74.60317460317461\n* */","import TextField from \"@material-ui/core/TextField\";\nimport {CircularProgress, IconButton, InputAdornment, Tooltip} from \"@material-ui/core\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport CachedIcon from '@material-ui/icons/Cached';\nimport {noop} from \"../../shared/util\";\nimport React from \"react\";\n\nexport const TextFieldRefreshLoading = ({onChange, onRefresh, loading, tooltipText = '', onOpen = noop, ...props}) => {\n\n    return <TextField\n        {...props}\n        onChange={onChange}\n        InputProps={{\n            ...props.InputProps,\n            endAdornment:\n                <InputAdornment position={'end'}>\n                    {props.value &&\n                    <ClearIcon style={{cursor: 'pointer'}} onClick={() => onChange('')}/>}\n                    <InputAdornment position={'end'}>\n                        <Tooltip\n                            onOpen={onOpen}\n                            arrow\n                            enterTouchDelay={100}\n                            interactive\n                            title={tooltipText}>\n                            <IconButton onClick={onRefresh}>\n                                {loading ? <CircularProgress size={20}/> : <CachedIcon/>}\n                            </IconButton>\n                        </Tooltip>\n                    </InputAdornment>\n                    {props.InputProps?.endAdornment}\n                </InputAdornment>\n        }}\n    />\n};","import { nanoid } from '@reduxjs/toolkit';\nimport { baseApi } from \"../../app/network-core/baseApi\";\n\nbaseApi.enhanceEndpoints({\n    addTagTypes: ['lists', 'items']\n})\n\n/* Optimistic updates for update and delete operations */\nconst listApi = baseApi.injectEndpoints({\n    endpoints: build => ({\n        getLists: build.query({\n            query: () => `tasks/tasklists/`,\n            providesTags: ['lists']\n        }),\n\n        createList: build.mutation({\n            query: ({ title }) => ({\n                url: `tasks/tasklists/`,\n                method: 'POST',\n                body: { title }\n            }),\n\n            /* TODO Invalidate cache for now since I'm not sure if lists are sorted\n            alphabetically by the server. Optimistically create in the future */\n            invalidatesTags: ['lists']\n        }),\n\n        updateList: build.mutation({\n            query: ({ id, title }) => ({\n                url: `tasks/tasklists/${id}/`,\n                method: 'PUT',\n                body: { id, title }\n            }),\n\n            /* Optimistically update */\n            onQueryStarted: ({ id, ...data }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(listApi.util.updateQueryData('getLists', undefined, draft => {\n                    let obj = draft.find(e => e.id === id)\n                    Object.assign(obj, data)\n                }))\n                queryFulfilled.catch(result.undo)\n            }\n        }),\n\n        deleteList: build.mutation({\n            query: ({ id }) => ({\n                url: `tasks/tasklists/${id}/`,\n                method: 'DELETE',\n            }),\n\n            /* Optimistically delete */\n            onQueryStarted: ({ id }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(listApi.util.updateQueryData('getLists', undefined, draft =>\n                    draft.filter(e => e.id !== id)))\n                queryFulfilled.catch(result.undo)\n            }\n        }),\n\n        getItems: build.query({\n            query: ({list}) => `tasks/tasklists/${list}/tasks/`,\n        }),\n\n        createItem: build.mutation({\n            query: ({ list, title, notes }) => ({\n                url: `tasks/tasklists/${list}/tasks/`,\n                method: 'POST',\n                body: { title, notes, tasklist: list }\n            }),\n\n            onQueryStarted: ({ list }, { dispatch, queryFulfilled }) => {\n                /* Optimistically show skeleton */\n                let id = nanoid()\n                let result = dispatch(listApi.util.updateQueryData('getItems', {list}, draft => {\n                    draft.unshift({ isSkeleton: true, id })\n                }))\n\n                /* Update getItems with the newly created item on success, and remove skeleton*/\n                queryFulfilled\n                    .then(({ data }) => {\n                        dispatch(listApi.util.updateQueryData('getItems', {list}, draft => {\n                            draft.unshift(data);\n                            let idx = draft.findIndex(e => e.id === id)\n                            if (idx !== -1)\n                                draft.splice(idx, 1)\n                        }));\n                    })\n                    .catch(result.undo)\n            }\n        }),\n\n        updateItem: build.mutation({\n            query: ({ list, id, title, notes }) => ({\n                url: `tasks/tasklists/${list}/tasks/${id}/`,\n                method: 'PUT',\n                body: { title, notes, tasklist: list }\n            }),\n\n            /* Optimistically update the item (it will exist in cache IF createItem was successful,\n                due to onQueryStarted in createItem) */\n            onQueryStarted: ({ list, id, ...data }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(listApi.util.updateQueryData('getItems', {list}, draft => {\n                    let obj = draft.find(e => e.id === id)\n                    Object.assign(obj, data)\n                }))\n                queryFulfilled.catch(result.undo)\n            }\n        }),\n\n        deleteItem: build.mutation({\n            query: ({ list, id }) => ({\n                url: `tasks/tasklists/${list}/tasks/${id}/`,\n                method: 'DELETE',\n            }),\n\n            /* Optimistically delete item */\n            onQueryStarted: ({ list, id }, { dispatch, queryFulfilled }) => {\n                let result = dispatch(listApi.util.updateQueryData('getItems', {list}, draft => draft.filter(e => e.id !== id)))\n                queryFulfilled.catch(result.undo)\n            }\n        })\n    })\n})\n\n\n\nexport const {\n    useGetListsQuery,\n    useCreateListMutation,\n    useUpdateListMutation,\n    useDeleteListMutation,\n\n    useGetItemsQuery,\n    useCreateItemMutation,\n    useUpdateItemMutation,\n    useDeleteItemMutation,\n} = listApi","import { IconButton, ListItemText, Menu, MenuItem } from \"@material-ui/core\";\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport { useState } from 'react';\nimport { StyledListItem } from '../../shared/components/GenericList/StyledListItem'\nimport {StyledListItemSecondaryAction } from '../../shared/components/GenericList/StyledListItemSecondaryAction'\nimport { useDeleteListMutation, useUpdateListMutation } from \"./listApi\";\n \n/* An individual list shown in the drawer. */\nexport const List = ({ onClick, list: { title, id } }) => {\n\n    const [deleteList] = useDeleteListMutation()\n    const [updateList] = useUpdateListMutation()\n\n    const [anchorEl, setAnchorEl] = useState()\n\n    const stopPropagation = func => e => {\n        e.stopPropagation()\n        func(e)\n    }\n\n    const editTitle = () => {\n        setAnchorEl(undefined)\n        let newTitle = prompt('Enter new title:', title)\n        if (newTitle) {\n            updateList({ title: newTitle, id })\n        }\n    }\n\n    return (\n        <StyledListItem\n            button\n            onClick={onClick}\n            $hideBackground\n            $reserveSpace={false}>\n            <Menu\n                anchorEl={anchorEl}\n                open={!!anchorEl}\n                onClose={stopPropagation(() => setAnchorEl(undefined))}>\n                <MenuItem onClick={stopPropagation(editTitle)}>Edit</MenuItem>\n                <MenuItem onClick={stopPropagation(() => deleteList({ id }))}>Delete</MenuItem>\n            </Menu>\n            <ListItemText\n                primary={title}\n                primaryTypographyProps={{ noWrap: true }}\n            />\n            <StyledListItemSecondaryAction>\n                <IconButton\n                    edge={'end'}\n                    onClick={stopPropagation(e => setAnchorEl(e.currentTarget))}>\n                    <MoreVertIcon />\n                </IconButton>\n            </StyledListItemSecondaryAction>\n\n        </StyledListItem>\n    )\n};\n","import CodeMirror from \"codemirror/lib/codemirror\";\n\nconst updateBottomMargin = cm => {\n\n    // Fixed 300px of virtual height if lineCount > 1\n    let padding = '';\n\n    if (cm.lineCount() > 1) {\n        // const totalH = cm.display.scroller.clientHeight - 30,\n        //     lastLineH = cm.getLineHandle(cm.lastLine()).height;\n        // padding = (totalH - lastLineH) + \"px\";\n        padding = '300px';\n    }\n\n    if (cm.state.scrollPastEndPadding !== padding) {\n        cm.state.scrollPastEndPadding = padding;\n        cm.display.lineSpace.parentNode.style.paddingBottom = padding;\n        cm.off(\"refresh\", updateBottomMargin);\n        cm.setSize();\n        cm.on(\"refresh\", updateBottomMargin);\n    }\n};\n\nconst onChange = (cm, change) => {\n    if (CodeMirror.changeEnd(change).line === cm.lastLine())\n        updateBottomMargin(cm);\n};\n\n\nCodeMirror.defineOption(\"scrollPastEnd\", false, (cm, val, old) => {\n\n    // I think this turns off the mode\n    if (old && old !== CodeMirror.Init) {\n        cm.off(\"change\", onChange);\n        cm.off(\"refresh\", updateBottomMargin);\n        cm.display.lineSpace.parentNode.style.paddingBottom = \"\";\n        cm.state.scrollPastEndPadding = null;\n    }\n\n    if (val) {\n        cm.on(\"change\", onChange);\n        cm.on(\"refresh\", updateBottomMargin);\n        updateBottomMargin(cm);\n    }\n});","import {UnControlled as CodeMirror} from 'react-codemirror2';\nimport 'codemirror/lib/codemirror.css'\nimport './codemirror.css'\nimport 'codemirror/mode/gfm/gfm'\nimport 'codemirror/addon/edit/closebrackets'\nimport 'codemirror/addon/edit/matchbrackets'\nimport 'codemirror/addon/selection/mark-selection'\nimport 'codemirror/addon/selection/active-line'\nimport 'codemirror/addon/display/autorefresh'\nimport './scrollPastEnd'\nimport {useEffect, useState} from \"react\";\n\n/*\n * Uncontrolled component. Modifying defaultValue after first mount will not trigger re-renders.\n */\nexport const MarkdownEditor = ({defaultValue, onChange}) => {\n\n    const [instance, setInstance] = useState(null);\n    const [initialValue, setInitialValue] = useState();\n    const [loaded, setLoaded] = useState(false);\n\n    /*Necessary to fix wrong Codemirror-sizer instance when mounted within\n    an OverlayScrollbars component with lineWrapping: true*/\n    useEffect(() => instance?.refresh(), [instance]);\n\n    // Set default value on first mount, and ignore all further updates\n\n    useEffect(() => {\n        setInitialValue(defaultValue);\n        setLoaded(true)\n        // eslint-disable-next-line\n    }, []);\n\n    return loaded\n        ? <CodeMirror\n            value={initialValue}\n            options={{\n                theme: 'codemirror',\n                mode: {\n                    name: 'gfm',\n                    highlightFormatting: true,\n                },\n                lineNumbers: true,\n                lineWrapping: true,\n                indentWithTabs: true,\n                viewportMargin: Infinity,\n                autoCloseBrackets: true,\n                matchBrackets: true,\n                styleSelectedText: true,\n                styleActiveLine: true,\n                autoRefresh: true,\n                scrollPastEnd: true\n\n            }}\n            editorDidMount={editor => setInstance(editor)}\n            onChange={(editor, data, newValue) => {\n\n                onChange(newValue);\n            }}\n        />\n        : null\n};\n","import { Button, TextField, Tooltip, Typography, useMediaQuery } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/core/styles\";\nimport { parseJSON } from \"date-fns\";\nimport { useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport styled from \"styled-components\";\nimport { DialogBlurResponsive } from \"../../shared/components/DialogBlurResponsive\";\nimport { MarkdownEditor } from \"../../shared/components/MarkdownEditor/MarkdownEditor\";\nimport { useAutosave } from \"../../shared/useAutosave\";\nimport { formatDistanceToNowPretty } from \"../../shared/util\";\n\nconst FooterRight = styled.div`\n  display: flex; \n  justify-content: flex-end;\n  align-items: center;\n`;\n\nconst Footer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-left: 10px;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 5px 0;\n`;\n\nexport const ListItemEdit = ({\n    editingItem,\n    closeEdit,\n    context,\n    isItemEmpty,\n    itemIdField,\n    createItemMutation,\n    updateItemMutation,\n    deleteItemMutation,\n}) => {\n\n    const theme = useTheme();\n    const fullScreen = useMediaQuery(theme.breakpoints.down('sm'));\n\n    const [createItem, { startedTimeStamp: createItemStarted }] = createItemMutation()\n    const [updateItem, { startedTimeStamp: updateItemStarted }] = updateItemMutation()\n    const [deleteItem] = deleteItemMutation()\n\n    const useAutosaveOptions = useMemo(() => ({\n        id: editingItem[itemIdField],\n        updateItem: (id, data) => updateItem({ ...context, [itemIdField]: id, ...data }),\n        createItem: data => createItem({ ...context, ...data }).unwrap().then(res => res.id),\n        deleteItem: id => deleteItem({ ...context, [itemIdField]: id }),\n        itemIsEmpty: isItemEmpty,\n    }), [context, createItem, deleteItem, editingItem, isItemEmpty, itemIdField, updateItem])\n\n\n    const { onChange, flush } = useAutosave(useAutosaveOptions)\n\n    const initialTitle = editingItem.title || '';\n    const initialNotes = editingItem.notes || '';\n\n    const { register, getValues, setValue } = useForm({\n        defaultValues: {\n            'title': initialTitle,\n            'notes': initialNotes,\n        }\n    });\n\n    register('title');\n    register('notes');\n\n    const onClose = () => {\n        flush()\n        closeEdit()\n    }\n\n    /* If there is any update, it must be after a create.\n    startedTimeStamp are used because fulfilledTimeStamp is reset when a \n    new mutation is requested, causing the UI to default to editingItem.updated\n    momentarily.*/\n    const lastSavedTimeString =\n        updateItemStarted ?\n            formatDistanceToNowPretty(updateItemStarted) :\n            createItemStarted ?\n                formatDistanceToNowPretty(createItemStarted) :\n                editingItem.updated ?\n                    formatDistanceToNowPretty(parseJSON(editingItem.updated)) :\n                    ''\n\n    /* Prefer operations with the latest possible time */\n    const lastCreatedTimeString =\n        createItemStarted ?\n            formatDistanceToNowPretty(createItemStarted) :\n            editingItem.created ?\n                formatDistanceToNowPretty(parseJSON(editingItem.created)) :\n                ''\n\n    return <DialogBlurResponsive\n        open\n        onClose={onClose}\n        footer={<Footer>\n            <Tooltip\n                arrow\n                enterTouchDelay={100}\n                interactive\n                title={lastCreatedTimeString ?\n                    `Created ${lastCreatedTimeString}` :\n                    'Not yet created'}>\n                <Typography variant={'body2'} color={'textSecondary'}>\n                    {lastSavedTimeString ?\n                        `Last saved ${lastSavedTimeString}` :\n                        'New item'}\n                </Typography>\n            </Tooltip>\n            <FooterRight>\n                <Button\n                    variant={'text'}\n                    color={'primary'}\n                    onClick={onClose}>\n                    Close\n                </Button>\n            </FooterRight>\n        </Footer>}>\n\n        <StyledTextField\n            label='Title'\n            multiline\n            fullWidth\n            name={'title'}\n            autoFocus={!initialTitle && !initialNotes}\n            defaultValue={initialTitle}\n            variant={'outlined'}\n            onChange={e => {\n                setValue('title', e.target.value);\n                onChange(getValues())\n            }}\n        />\n        {fullScreen\n            ? <StyledTextField\n                label='Notes'\n                multiline\n                fullWidth\n                defaultValue={getValues('notes')}\n                variant={'outlined'}\n                onChange={e => {\n                    setValue('notes', e.target.value);\n                    onChange(getValues())\n                }}\n            />\n            : <MarkdownEditor\n                defaultValue={getValues('notes')}\n                onChange={newVal => {\n                    setValue('notes', newVal);\n                    onChange(getValues())\n                }} />\n        }\n    </DialogBlurResponsive>\n};\n","import {createSlice} from \"@reduxjs/toolkit\";\n\nexport const listsPath = 'lists'\n\nconst initialState = {\n    currentList: null\n}\n\nexport const listsSlice = createSlice({\n    name: listsPath,\n    initialState,\n    reducers: {\n        setCurrentList: (state, {payload}) => void (state.currentList = payload)\n    }\n})\n\nexport const {\n    setCurrentList\n} = listsSlice.actions\n\nexport const selectCurrentList = state => state[listsPath].currentList","import { useSelector } from \"react-redux\";\nimport { BaseList } from \"../../shared/components/GenericList/BaseList\";\nimport { BaseListItem } from \"../../shared/components/GenericList/BaseListItem\";\nimport { GenericList } from \"../../shared/components/GenericList/GenericList\";\nimport { ListItemEdit } from \"./ListItemEdit\";\nimport { useCreateItemMutation, useDeleteItemMutation, useGetItemsQuery, useUpdateItemMutation } from \"./listApi\";\nimport { selectCurrentList } from \"./listsSlice\";\n\nconst List = BaseList({Item: BaseListItem({\n    primaryTextKey: 'title',\n    secondaryTextKey: 'notes',\n})})\n\n/* List of items, for a particular List. */\nexport const ListItems = () => {\n\n    const currentList = useSelector(selectCurrentList)\n\n\n    // useEffect(() => {\n    //     if (!currentList) return;\n\n    //     // Prevent virtuoso from remembering the scroll position of the previously viewed list\n    //     if (virtuosoRef.current) {\n    //         virtuosoRef.current.scrollToIndex({ align: 'top', behavior: 'smooth' })\n    //     }\n    //     // eslint-disable-next-line\n    // }, [currentList]);\n\n    return (\n        <GenericList\n            getItemsQuery={useGetItemsQuery}\n            createItemMutation={useCreateItemMutation}\n            updateItemMutation={useUpdateItemMutation}\n            deleteItemMutation={useDeleteItemMutation}\n            defaultItemValues={{ title: '', notes: '' }}\n            context={{ list: currentList.id }}\n            itemIdField={'id'}\n\n            List={List}\n            ItemEdit={ListItemEdit}\n            isItemEmpty={e => !e.title && !e.notes} />\n    )\n};","import { Button, CircularProgress, IconButton, List as MuiList, Typography } from \"@material-ui/core\";\nimport SyncIcon from '@material-ui/icons/Sync';\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { Loading } from \"../../shared/components/Loading\";\nimport { List } from \"./List\";\nimport { useCreateListMutation, useGetItemsQuery, useGetListsQuery } from \"./listApi\";\nimport { ListItems } from \"./ListItems\";\nimport { selectCurrentList, setCurrentList } from \"./listsSlice\";\n\nconst StyledButton = styled(Button)({\n    margin: '10px',\n});\n\nexport const Lists = ({ setDrawerContent, setTitleContent }) => {\n\n    const dispatch = useDispatch()\n\n    // There is a chance the listId stored is invalid - useEffect below checks for this\n    const currentList = useSelector(selectCurrentList)\n\n    const { data: lists, isFetching: isLoadingLists, refetch: refetchLists } = useGetListsQuery()\n    const { isFetching: isFetchingGetItems, refetch: refetchItems } = useGetItemsQuery({list: currentList?.id}, { skip: !currentList })\n    const [createList] = useCreateListMutation()\n\n    /*Show Lists in app-bar drawer*/\n\n    useEffect(() => void setDrawerContent(<MuiList disablePadding dense>\n        {isLoadingLists ?\n            <div style={{ display: 'flex', 'justifyContent': 'center' }}>\n                <CircularProgress size={20} />\n            </div> :\n            [\n                <StyledButton\n                    key={'CREATE_LIST'}\n                    variant={'contained'}\n                    color={'secondary'}\n                    onClick={() => {\n                        let title = prompt('Enter title:');\n                        if (title) {\n                            createList({ title })\n                        }\n                    }}>\n                    Create new Tasklist\n                </StyledButton>,\n\n                lists?.map(list => <List\n                    key={list.id}\n                    list={list}\n                    onClick={() => dispatch(setCurrentList(list))} />)\n            ]}\n    </MuiList>),\n        [createList, dispatch, isLoadingLists, lists, setDrawerContent])\n\n    useEffect(() => void setTitleContent(<>\n        <Typography variant={\"h6\"} noWrap>\n            {currentList?.title}\n        </Typography>\n        <IconButton\n            onClick={() => {\n                refetchLists()\n                refetchItems()\n            }}\n            disabled={isFetchingGetItems}>\n            <SyncIcon />\n        </IconButton>\n    </>), [currentList, isFetchingGetItems, refetchItems, refetchLists, setTitleContent])\n\n    if (!currentList) return <Loading\n        fullscreen={false}\n        showSpinner={false}\n        message={'Select a list'} />\n\n\n    return <ListItems />\n}\n    ;\n","// /*Add new modules here*/\nimport {Literature} from \"../../modules/Literature/Literature\";\nimport { Account } from \"../../modules/Account/Account\";\nimport { Dvr } from \"../../modules/Dvr/Dvr\"; \nimport {Testing} from \"../../modules/Testing/Testing\";\nimport {PasswordTools} from \"../../modules/PasswordTools/PasswordTools\";\nimport {HomeAutomation} from \"../../modules/HomeAutomation/HomeAutomation\";\nimport {OptionHedgeCalculator} from \"../../modules/OptionHedgeCalculator/OptionHedgeCalculator\";\nimport {Lists} from \"../../modules/Lists/Lists\";\n\nexport const MODULES = {\n    LISTS: {\n        menuName: 'Lists',\n        onlySuperUser: false,\n        element: Lists\n    },\n    LITERATURE: {\n        menuName: 'Literature',\n        onlySuperUser: false,\n        element: Literature\n    },\n    ACCOUNT: {\n        menuName: 'Account',\n        onlySuperUser: false,\n        element: Account\n    },\n    PASSWORDS: {\n        menuName: 'Password Tools',\n        onlySuperUser: false,\n        element: PasswordTools,\n    },\n    HOME_AUTOMATION: {\n        menuName: 'Home Automation',\n        onlySuperUser: true,\n        element: HomeAutomation\n    },\n    DVR: {\n        menuName: 'Dvr',\n        onlySuperUser: true,\n        element: Dvr\n    },\n    OPTION_HEDGE_CALCULATOR: {\n        menuName: 'Option Hedge Calculator',\n        onlySuperUser: false,\n        element: OptionHedgeCalculator\n    },\n    TEST: {\n        menuName: 'Testing',\n        onlySuperUser: true,\n        element: Testing\n    }\n}","import { IconButton, List, ListItem, ListItemIcon, ListItemText, Typography } from \"@material-ui/core\";\nimport SyncIcon from '@material-ui/icons/Sync';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useGetAuthorsQuery, useGetBooksQuery, useGetGenresQuery, useGetTypesQuery } from \"./literatureApi\";\nimport { selectLiteratureSubmodule, setLiteratureSubmodule } from \"./literatureSlice\";\nimport { submodules } from './submodules';\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\n\nexport const Literature = ({ setDrawerContent, setTitleContent }) => {\n\n    const { refetch: refetchBooks, isFetching: isFetchingBooks } = useGetBooksQuery()\n    const { refetch: refetchAuthors, isFetching: isFetchingAuthors } = useGetAuthorsQuery()\n    const { refetch: refetchGenres, isFetching: isFetchingGenres } = useGetGenresQuery()\n    const { refetch: refetchTypes, isFetching: isFetchingTypes } = useGetTypesQuery()\n\n    const isFetching = isFetchingBooks || isFetchingAuthors || isFetchingGenres || isFetchingTypes\n\n    const dispatch = useDispatch()\n    const literatureSubmodule = useSelector(selectLiteratureSubmodule) || Object.keys(submodules)[0]\n\n    /* Used by Genres to display genre rules */\n    const [titleEndAdornment, setTitleEndAdornment] = useState(null)\n\n    useEffect(() => {\n        setDrawerContent(<List disablePadding>\n            {\n                Object.entries(submodules)\n                    .map(([key, { Icon, name }]) =>\n                        <ListItem\n                            key={key}\n                            button\n                            onClick={() => dispatch(setLiteratureSubmodule(key))}>\n                            <ListItemIcon>\n                                <Icon />\n                            </ListItemIcon>\n                            <ListItemText primary={name} />\n                        </ListItem>)\n            }\n        </List>)\n    }, [dispatch, setDrawerContent])\n\n    useEffect(() => {\n        setTitleContent(<>\n            <Typography variant={\"h6\"}>\n                {submodules[literatureSubmodule].name}\n            </Typography>\n            <IconButton\n                onClick={() => {\n                    refetchBooks()\n                    refetchAuthors()\n                    refetchGenres()\n                    refetchTypes()\n                }}\n                disabled={isFetching}>\n                <SyncIcon />\n            </IconButton>\n            {titleEndAdornment}\n        </>)\n    }, [isFetching, literatureSubmodule, refetchAuthors, refetchBooks, refetchGenres, refetchTypes, setTitleContent, titleEndAdornment])\n\n    const { jsx, props } = submodules[literatureSubmodule]\n\n\n    /* NOTE: Required versions as follows:\n    - \"react-dnd-html5-backend\": \"^11.1.3\",\n    - \"react-dnd\": \"^11.1.3\", \n    Provider should appear above Mui-Datatable component, so that it doesn't try to\n    add another DndProvider and cause the 'Cannot have 2 HTML5 backends...' error*/\n    return <DndProvider backend={HTML5Backend}>\n        {React.createElement(jsx, { setTitleEndAdornment, ...props })}\n    </DndProvider >\n};\n","/**\n * Base and authentication endpoints\n * */\n\n/*Base*/\nexport const API_URL = 'https://api.nicholaslyz.com';\nexport const FILES_URL = 'https://files.nicholaslyz.com';","import { Button } from \"@material-ui/core\";\nimport CallMadeIcon from '@material-ui/icons/CallMade';\nimport React from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { BackgroundScreenRounded } from \"../../shared/components/backgroundScreen\";\nimport { selectLoginStatus, setCurrentModule } from \"../appSlice\";\nimport { MODULES } from \"./modules\";\n\nconst GDOCS_ATTRACTIONS_URL = 'https://docs.google.com/document/d/1MS6oLLnTWWhdS_FEr1vudNfsnGBMT2V1GtrmHzDd6s0/edit#';\n\nconst OuterContainer = styled.div`\n  display: flex;\n  justify-content: center;\n`\n\nconst ModulesContainer = styled(BackgroundScreenRounded)`\n  margin: 48px 0;\n  max-width: 300px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst StyledButton = styled(Button)({\n    margin: '10px',\n});\n\n/*Also handles persisting of CURRENT_MODULE in localstorage and updates redux store accordingly*/\nexport const ModuleSelect = () => {\n\n    const dispatch = useDispatch()\n    const { isSuperUser } = useSelector(selectLoginStatus)\n\n    const modules = Object.entries(MODULES)\n        .filter(([_, { onlySuperUser }]) => isSuperUser || !onlySuperUser)\n        .map(([moduleKey, { menuName }]) =>\n            <StyledButton\n                variant={'outlined'}\n                color={'primary'}\n                key={moduleKey}\n                onClick={() => dispatch(setCurrentModule(moduleKey))}>\n                {menuName}\n            </StyledButton>\n        )\n\n    /*Todo get this URL from the server in future*/\n    modules.push(isSuperUser && <StyledButton\n        variant={'outlined'}\n        color={'primary'}\n        key={'attractions'}\n        onClick={() => window.open(GDOCS_ATTRACTIONS_URL, '_blank', 'noopener,noreferrer')}\n        endIcon={<CallMadeIcon />}>\n        Attractions and Food\n    </StyledButton>)\n\n    return <OuterContainer>\n        <ModulesContainer>\n            {modules}\n        </ModulesContainer>\n    </OuterContainer>\n};","import {Badge, Chip, Divider, IconButton, ListItem, ListItemText, Popover, Typography} from '@material-ui/core'\nimport NotificationsIcon from \"@material-ui/icons/Notifications\";\nimport React, {useState} from \"react\";\nimport styled from \"styled-components\";\nimport {useSelector} from \"react-redux\";\nimport {selectNotificationsSorted} from \"./notificationSlice\";\nimport {formatDistanceToNowPretty} from \"../../shared/util\";\n\nconst StyledChip = styled(Chip)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\n\nconst StyledPopover = styled(Popover)`\n  .MuiPopover-paper {\n    max-width: min(calc(100% - 32px), 600px);\n    max-height: calc(100% - 56px);\n    overscroll-behavior: contain;\n  }\n`;\n\nconst StyledSpan = styled.div`\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n`;\n\nexport const NotificationMenu = () => {\n\n    const notifications = useSelector(selectNotificationsSorted)\n\n    const [anchorEl, setAnchorEl] = useState();\n\n    const handleNotificationClick = e => setAnchorEl(e.currentTarget);\n    const onClose = () => setAnchorEl(null);\n\n    return <>\n        <IconButton\n            onClick={handleNotificationClick}\n        >\n            <Badge badgeContent={notifications.length} color={'error'}>\n                <NotificationsIcon/>\n            </Badge>\n        </IconButton>\n        <StyledPopover\n            anchorEl={anchorEl}\n            open={Boolean(anchorEl)}\n            disableScrollLock\n            transformOrigin={{ vertical: 'top', horizontal: 'left',}}\n            onClose={onClose}\n            anchorOrigin={{\n                vertical: 'bottom',\n                horizontal: 'right',\n            }}>\n            {notifications.length > 0 ?\n                notifications.map(e => <React.Fragment key={e.id}>\n                    <ListItem button>\n                        <ListItemText\n                            disableTypography\n                            primary={<>\n                                <StyledChip\n                                    color={'primary'}\n                                    label={e.source}/>\n                                {e.title}\n                            </>}\n                            secondary={<>\n                                <StyledSpan>{e.content}</StyledSpan>\n                                <Typography variant={'body2'}\n                                            align={'right'}>\n                                    {formatDistanceToNowPretty(new Date(e.timestamp))}\n                                </Typography>\n                            </>}/>\n                    </ListItem>\n                    <Divider/>\n                </React.Fragment>) :\n                <ListItem>\n                    <ListItemText\n                        primary={'No new notifications'}/>\n                </ListItem>}\n        </StyledPopover>\n    </>\n\n};","import {OverlayScrollbarOptions} from \"../theme\";\nimport {CircularProgress, Drawer, List, ListItem, ListItemIcon, ListItemText, useMediaQuery} from \"@material-ui/core\";\nimport {selectCurrentModule, setCurrentModule} from \"../appSlice\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport MeetingRoomIcon from \"@material-ui/icons/MeetingRoom\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport {OverlayScrollbarsComponent} from \"overlayscrollbars-react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {useLogoutMutation} from \"../auth/authApi\";\nimport {useTheme} from \"@material-ui/core/styles\";\nimport {BACKGROUND_COLOR} from \"../../shared/components/backgroundScreen\";\n\n\nconst OverlayScrollbarsWithMaxWidth = styled(OverlayScrollbarsComponent)`\n  width: ${({$width})=>$width}px;\n  max-width: 80vw;\n`\n\nconst AppNameDiv = styled.div`\n  font-family: 'Starcraft', serif;\n  font-size: 20px;\n  margin: 0 auto;\n  text-align: center;\n  cursor: default;\n`;\n\n\nconst TransparentDrawer = styled(Drawer)`\n  .MuiDrawer-paper {\n    ${({$transparent}) => $transparent && BACKGROUND_COLOR};\n  }\n`;\n\nexport const AppBarDrawer = ({drawerOpen, drawerWidth, setDrawerOpen, sidebarName, children}) => {\n\n    const dispatch = useDispatch()\n    const module = useSelector(selectCurrentModule)\n\n    const [logout, {isLoading}] = useLogoutMutation()\n\n    const theme = useTheme();\n    const mobile = useMediaQuery(theme.breakpoints.down('sm'));\n\n    const closeAppBar = () => setDrawerOpen(false)\n\n    const clearModule = () => dispatch(setCurrentModule(null))\n\n    return <TransparentDrawer\n        $transparent={!mobile}\n        onClose={closeAppBar}\n        open={!mobile || drawerOpen}\n        variant={mobile ? 'temporary' : 'permanent'}>\n        <OverlayScrollbarsWithMaxWidth\n            $width={drawerWidth}\n            options={OverlayScrollbarOptions}\n            className={'os-host-flexbox'}>\n            <List onClick={closeAppBar}>\n                <ListItem>\n                    <AppNameDiv>{sidebarName}</AppNameDiv>\n                </ListItem>\n                {module && <ListItem button onClick={clearModule}>\n                    <ListItemIcon>\n                        <ArrowBackIcon/>\n                    </ListItemIcon>\n                    <ListItemText primary={'Back to Apps'}/>\n                </ListItem>}\n                {children}\n                <ListItem\n                    button\n                    onClick={e => {\n                        e.stopPropagation()\n                        logout()\n                    }}>\n                    <ListItemIcon>\n                        <MeetingRoomIcon/>\n                    </ListItemIcon>\n                    <ListItemText primary={'Logout'}/>\n                    {isLoading && <CircularProgress size={20}/>}\n                </ListItem>\n            </List>\n        </OverlayScrollbarsWithMaxWidth>\n    </TransparentDrawer>;\n\n}","import { useSelector } from \"react-redux\"\nimport { selectPendingNetworkActions } from \"../appSlice\"\nimport { CircularProgress } from '@material-ui/core';\n\nexport const AppBarNetworkLoading = () => {\n    const hasPendingNetworkActions = useSelector(selectPendingNetworkActions).length > 0\n\n    return hasPendingNetworkActions ? <CircularProgress size={20}/> : null\n}","import { AppBar as MuiAppBar, IconButton, Toolbar, Typography } from \"@material-ui/core\";\nimport { styled as muiStyled } from \"@material-ui/core/styles\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport React, { useLayoutEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport styled from 'styled-components';\nimport { selectCurrentModule } from \"../appSlice\";\nimport { MODULES } from \"../modules/modules\";\nimport { ModuleSelect } from \"../modules/ModuleSelect\";\nimport { NotificationMenu } from \"../notifications/NotificationMenu\";\nimport { AppBarDrawer } from \"./AppBarDrawer\";\nimport { AppBarNetworkLoading } from \"./AppBarNetworkLoading\";\n\nexport const drawerWidth = 300;\n\nconst FlexContainer = styled.div`\n  display: flex;\n  height: 100vh;\n`;\n\nconst TransparentAppBar = muiStyled(MuiAppBar)(({ theme }) => ({\n    [theme.breakpoints.up('md')]: {\n        width: `calc(100% - ${drawerWidth}px)`,\n        marginLeft: drawerWidth,\n    },\n\n    '@supports (backdrop-filter: blur(10px))': {\n        'backdrop-filter': 'blur(10px)',\n    },\n\n    background: 'rgba(0,0,0,0.6)',\n\n}));\n\nconst DrawerContainer = muiStyled('div')(({ theme }) => ({\n    [theme.breakpoints.up('md')]: {\n        width: drawerWidth,\n        flexShrink: 0,\n    },\n\n}));\n\nconst ContentContainer = styled.div`\n  flex: 1;\n`;\n\nconst ContentDiv = styled.div`\n  height: calc(100% - 48px); //48px is the height of Toolbar (variant=dense)\n`;\n\n\nconst StyledIconButton = muiStyled(IconButton)(({ theme }) => ({\n    [theme.breakpoints.up('md')]: {\n        display: 'none',\n    }\n}));\n\n\n/*A globally shared app bar.\nTo prevent AppBar from automatically closing on ListItem click, use \ne.stopPropagation().*/\nexport const AppBar = () => {\n\n    const module = useSelector(selectCurrentModule)\n\n    /*Hooks are passed to modules*/\n    const [drawerOpen, setDrawerOpen] = useState(false)\n    const [drawerContent, setDrawerContent] = useState(null)\n    const [sidebarName, setSidebarName] = useState('')\n    const [titleContent, setTitleContent] = useState(null)\n\n    const appBarProps = { setDrawerContent, setTitleContent, setSidebarName, setDrawerOpen }\n\n    /*useLayoutEffect is critical here, to ensure that this runs BEFORE any\n    * useEffect(s) in the children that might call setTitleContent etc.*/\n    useLayoutEffect(() => {\n        if (!module) {\n            setSidebarName('Modules')\n            setTitleContent(<Typography variant={\"h6\"}>Modules</Typography>)\n            setDrawerContent(null)\n        } else {\n            setTitleContent(<Typography variant={\"h6\"}>{MODULES[module].menuName}</Typography>)\n            setSidebarName(MODULES[module].menuName)\n        }\n\n    }, [module, setDrawerContent, setSidebarName, setTitleContent])\n\n    return <FlexContainer>\n        <TransparentAppBar\n            position={'fixed'}\n            color={'transparent'}>\n            <Toolbar variant={\"dense\"}>\n                <StyledIconButton\n                    color={\"inherit\"}\n                    edge={'start'}\n                    onClick={() => setDrawerOpen(true)}>\n                    <MenuIcon />\n                </StyledIconButton>\n                {titleContent}\n                <div style={{ flex: 1 }} />\n                <AppBarNetworkLoading />\n                <NotificationMenu />\n            </Toolbar>\n        </TransparentAppBar>\n\n        <DrawerContainer>\n            <AppBarDrawer\n                drawerOpen={drawerOpen}\n                drawerWidth={drawerWidth}\n                setDrawerOpen={setDrawerOpen}\n                sidebarName={sidebarName}>\n                {drawerContent}\n            </AppBarDrawer>\n        </DrawerContainer>\n\n\n        <ContentContainer>\n            {/* Blank toolbar purely for spacing */}\n            <Toolbar variant={\"dense\"} />\n            <ContentDiv>\n                {module ?\n                    React.createElement(MODULES[module].element, appBarProps) :\n                    <ModuleSelect {...appBarProps} />}\n            </ContentDiv>\n        </ContentContainer>\n\n    </FlexContainer>\n};","import { shaderMaterial } from \"@react-three/drei\";\nimport { extend } from '@react-three/fiber'\n\nconst SpriteShaderMaterial = shaderMaterial(\n    { uTime: { value: 0 }, uTexture: null },\n  //Vertex shader\n    `\n  uniform float uTime;\n  attribute vec3 color;\n  attribute float size;\n  attribute float velocity;\n  varying vec4 vColor;\n  void main(){\n    vColor = vec4(color, 1.0);\n    vec3 p = vec3(position);\n    p.z = -150. + mod(position.z + uTime, 300.);\n    vec4 mvPosition = modelViewMatrix * vec4( p, 1.0 );\n    gl_PointSize = size * (-50.0 / mvPosition.z);\n    gl_Position = projectionMatrix * mvPosition;\n  }\n`,\n//Fragment shader\n`\n  uniform sampler2D uTexture;\n  varying vec4 vColor;\n  void main() {\n    gl_FragColor = vColor * texture2D(uTexture, gl_PointCoord);\n  }\n`,\n)\n\nextend({SpriteShaderMaterial})","import { Vector2 } from \"three\";\n\nexport const ZoomShader = {\n\tuniforms: {\n\t\ttDiffuse: { value: null },\n\t\tcenter: { value: new Vector2(0.5, 0.5) },\n\t\tstrength: { value: 0 },\n\t},\n\t//Vertex shader\n\tvertexShader: `\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  `,\n\t//Fragment shader\n\tfragmentShader: `\n    uniform sampler2D tDiffuse;\n    uniform vec2 center;\n    uniform float strength;\n    varying vec2 vUv;\n    float random(vec3 scale, float seed) {\n      /* use the fragment position for a different seed per-pixel */\n      return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n    }\n    \n    void main() {\n      vec4 color = vec4(0.0);\n      float total = 0.0;\n      vec2 toCenter = center - vUv;\n      \n      /* randomize the lookup values to hide the fixed number of samples */\n      float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n      \n      for (float t = 0.0; t <= 40.0; t++) {\n        float percent = (t + offset) / 40.0;\n        float weight = 4.0 * (percent - percent * percent);\n        vec4 texel = texture2D(tDiffuse, vUv + toCenter * percent * strength);\n        /* switch to pre-multiplied alpha to correctly blur transparent images */\n        texel.rgb *= texel.a;\n        color += texel * weight;\n        total += weight;\n      }\n      gl_FragColor = color / total;\n      /* switch back from pre-multiplied alpha */\n      gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n    }\n  `,\n}","import { useTexture } from '@react-three/drei'\nimport { Canvas, extend, useFrame, useThree } from '@react-three/fiber'\nimport React, { useEffect, useMemo, useRef, useState } from 'react'\nimport styled from 'styled-components'\nimport { Color, Vector3 } from 'three'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass'\nimport { UnrealBloomPass } from 'three/examples/jsm/postprocessing/UnrealBloomPass'\nimport { lerp } from 'three/src/math/MathUtils'\nimport { getRandomInt } from '../../shared/util'\nimport './spriteShaderMaterial'\nimport { ZoomShader } from './zoomShader'\n\nextend({ UnrealBloomPass, RenderPass, ShaderPass, EffectComposer })\n\n/* Used to avoid jankiness when showZoom changes */\nexport const showZoom = {val: false}\n\n/* Global parameters */\nconst fov = 50\nconst cameraDistance = 0.1\nconst starfieldSpawnZ = -150 // Has to be -150 because of the shader (not sure why)\nconst starfieldZLength = 300 // Also has to be 300 because of the shader\nconst POINTS_COUNT = Math.floor(50_000 * Math.min(window.innerWidth / 1280, 1))// Maximum number of points to render\nconst COLORS = [\n    0xa70267,\n    0xf10c49,\n    0xfb6b41,\n    0xf6d86b,\n    0x339194\n]\nconst MAX_TIME_FACTOR = 100\nconst TIME_FACTOR_CHANGE = 0.02\nconst ZOOM_RATIO = 0.004 // Factor by which zoom is multiplied by the time factor - 1\n// const fieldY = 2 * totalDistance * tanDegrees(fov / 2)\n// const fieldX = fieldY * width / height\n/* 200 looks better, somehow */\nconst fieldY = 200\nconst fieldX = 200 * window.innerWidth / window.innerHeight\n\nconst FullscreenDiv = styled.div`\n  width: 100%;\n  height: 100%;\n  position: fixed;\n`\n\nconst Main = () => {\n\n    const texture = useTexture('star.png')\n    const points = useRef()\n    const shaderMaterial = useRef()\n    const [cameraVec] = useState(() => new Vector3())\n    const composer = useRef()\n    const { scene, gl, size: {height, width}, camera } = useThree()\n    const zoomShader = useRef()\n    const timeFactor = useRef(1)\n\n    const { positions, sizes, colors } = useMemo(() => {\n        const positionArray = new Float32Array(POINTS_COUNT * 3)\n        const sizesArray = new Float32Array(POINTS_COUNT)\n        const colorsArray = new Float32Array(POINTS_COUNT * 3)\n\n        for (let i = 0; i < POINTS_COUNT; i++) {\n            //Positions\n            let pointPosition = new Float32Array([\n                Math.random() * fieldX - fieldX / 2,\n                Math.random() * fieldY - fieldY / 2,\n                Math.random() * -starfieldZLength\n            ])\n\n            positionArray.set(pointPosition, i * 3)\n\n            //Sizes\n            sizesArray[i] = getRandomInt(5, 20)\n\n            //Colors\n            let color = new Color()\n            color.set(COLORS[getRandomInt(0, COLORS.length)])\n            color.toArray(colorsArray, i * 3)\n        }\n\n        return {\n            positions: positionArray,\n            sizes: sizesArray,\n            colors: colorsArray\n        } \n    }, [])\n\n    useEffect(() => void composer.current.setSize(width, height), [height, width])\n\n    useFrame(({ camera, mouse }, delta) => {\n        composer.current.render()\n        camera.position.lerp(cameraVec.set(-mouse.x * 4, -mouse.y * 4, 0), 0.03)\n\n        /* This is the factor by which zoom strength and particle velocity are multiplied by\n        Using lerp repeatedly results in decreasing change near endpoints, a desirable effect*/\n        timeFactor.current = lerp(timeFactor.current, showZoom.val ? MAX_TIME_FACTOR : 1, TIME_FACTOR_CHANGE)\n\n        shaderMaterial.current.uTime += delta * 4 * timeFactor.current\n        zoomShader.current.uniforms.strength.value = (timeFactor.current - 1) * ZOOM_RATIO\n    }, 1)\n\n\n    return <>\n        <color attach={'background'} args={['black']} />\n        <points ref={points} position={[0, 0, starfieldSpawnZ]}>\n            <bufferGeometry>\n                <bufferAttribute attachObject={['attributes', 'position']} array={positions} itemSize={3} count={POINTS_COUNT} />\n                <bufferAttribute attachObject={['attributes', 'size']} array={sizes} itemSize={1} count={POINTS_COUNT} />\n                <bufferAttribute attachObject={['attributes', 'color']} array={colors} itemSize={3} count={POINTS_COUNT} />\n            </bufferGeometry>\n            <spriteShaderMaterial\n                ref={shaderMaterial}\n                uTime={0}\n                uTexture={texture}\n                blending={2} //Additive blending\n                depthTest={false} //No sprite occlusion\n            />\n        </points>\n        <effectComposer ref={composer} args={[gl]}>\n            <renderPass attachArray=\"passes\" scene={scene} camera={camera} />\n            {/* resolution, strength, radius, threshold */}\n            <unrealBloomPass attachArray=\"passes\" args={[undefined, 2, 0, 0]} />\n            <shaderPass attachArray=\"passes\" args={[ZoomShader]} ref={zoomShader} />\n        </effectComposer>\n    </>\n}\n\nexport const Starfield = () => <FullscreenDiv>\n    <Canvas camera={{ position: [0, 0, cameraDistance], fov }}>\n        <Main/>\n    </Canvas>\n</FullscreenDiv>","import { Button, Checkbox, CircularProgress, FormControlLabel, TextField, Typography } from \"@material-ui/core\";\nimport React, { useCallback, useEffect, useState } from 'react';\nimport ReCAPTCHA from \"react-google-recaptcha\";\nimport { useForm } from \"react-hook-form\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\nimport { BackgroundScreenRounded } from \"../../shared/components/backgroundScreen\";\nimport { Loading } from \"../../shared/components/Loading\";\nimport { selectLoginStatus, setNetworkError } from \"../appSlice\";\nimport { NETWORK_ERROR } from \"../constants\";\nimport { showZoom } from '../starfield/Starfield';\nimport { useCheckLoginQuery, useLoginMutation } from \"./authApi\";\n\nconst StyledForm = styled.form`\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  max-width: 300px;\n  height: 100vh;\n  ${({ $blur }) => $blur && `filter: blur(5px) opacity(25%);`}\n  transition: 0.5s;\n  \n  .grecaptcha-badge {\n      width: 0 !important; //This badge keeps expanding the canvas on submit\n  }\n`;\n\nconst InnerContainer = styled(BackgroundScreenRounded)`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 10px;\n  position: relative;\n`;\n\nconst StyledTextField = styled(TextField)`\n  margin: 5px 0;\n`;\n\nconst Spacer = styled.div`\n  width: 30px\n`;\n\nconst StyledCircularProgress = styled(CircularProgress)`\n  margin-left: 10px;\n`;\n\n/*Will update loggedIn state\nThe lag on error is due to recaptcha resetting*/\nexport const Login = () => {\n\n    const dispatch = useDispatch()\n    const { recaptchaKey } = useSelector(selectLoginStatus)\n\n    /* isLoading is used to determine if starfield zoom animation should be shown */\n    const [login, { isLoading }] = useLoginMutation()\n    const { isFetching, isError, error } = useCheckLoginQuery(undefined, { refetchOnMountOrArgChange: true })\n\n    const { register, getValues, setValue } = useForm({\n        defaultValues: {\n            username: '',\n            password: '',\n            otp: null,\n            save_browser: false,\n        }\n    })\n\n    register('username')\n    register('password')\n    register('otp')\n    register('save_browser')\n\n    const recaptchaRef = React.useRef();\n    const [loginMessage, setLoginMessage] = useState('Sign In');\n    const [otpRequired, setOtpRequired] = useState(false);\n\n    /* Control zoom effect on starfield here */\n    useEffect(() => void (showZoom.val = isLoading), [isLoading])\n\n    const onSubmit = useCallback(event => {\n        event.preventDefault();\n        console.log(getValues())\n\n        setLoginMessage('')\n        recaptchaRef.current\n            .executeAsync()\n            .then(token => login({\n                token: token,\n                ...getValues()\n            }))\n            .then(res => {\n                /* Handle 401/403 errors here (either OTP required or wrong password) */\n                if (res.error &&\n                    res.error.type === NETWORK_ERROR.HTTP_ERROR &&\n                    [401, 403].includes(res.error.status)) {\n                    let data = res.error.data\n\n                    if (data.otp_required)\n                        setOtpRequired(true)\n\n                    setLoginMessage(data.message)\n\n                    /*Reset captcha for retries*/\n                    recaptchaRef.current?.reset();\n                }\n            })\n            .catch(e => {\n                /*Since thunks do not throw if not unwrapped,\n                * only gRecaptcha errors are caught here.\n                * networkErrorMiddleware handles the rest.\n                * This is at the end of the chain so that all\n                * prior 'then's do not execute if recaptcha validation fails.*/\n                dispatch(setNetworkError({\n                    text: `gRecaptcha request failed: ${e?.message}`,\n                    type: NETWORK_ERROR.FETCH_ERROR,\n                }))\n            })\n    }, [dispatch, login, getValues])\n\n    /*Show loading screen also for non-401/403 errors*/\n    if (isFetching || (isError && ![401, 403].includes(error.status)))\n        return <Loading\n            open={true}\n            message={isError ? 'HTTP Error' : 'Checking authentication...'}\n            fullscreen={true} />;\n\n    return <>\n        <StyledForm onSubmit={onSubmit} $blur={isLoading}>\n            <InnerContainer>\n                <Typography variant={'h6'} gutterBottom align={\"center\"} style={{ height: '32px' }}>\n                    {loginMessage}\n                </Typography>\n                {!otpRequired && <>\n                    <StyledTextField\n                        autoComplete={'username'}\n                        autoFocus\n                        fullWidth\n                        label={'Username'}\n                        name={'username'}\n                        onChange={e => setValue('username', e.target.value)}\n\n                        required\n                        type='text'\n                        variant={'outlined'}\n                    />\n\n                    <StyledTextField\n                        autoComplete={'current-password'}\n                        fullWidth\n                        label={'Password'}\n                        name={'password'}\n                        onChange={e => setValue('password', e.target.value)}\n                        required\n                        type={'password'}\n                        variant={'outlined'}\n                    />\n                </>}\n\n                {otpRequired && <>\n                    <StyledTextField\n                        autoComplete={'one-time-code'}\n                        fullWidth\n                        inputMode={\"numeric\"}\n                        label={'OTP'}\n                        name={'otp'}\n                        onChange={e => setValue('otp', e.target.value)}\n                        pattern={\"[0-9]*\"}\n                        required\n                        type={'password'}\n                        variant={'outlined'}\n                    />\n                    <FormControlLabel\n                        control={<Checkbox\n                            name={'save_browser'}\n                            onChange={e => setValue('save_browser', e.target.checked)}\n                        />}\n                        label={'Remember browser'}\n                    />\n                </>}\n                <Button\n                    variant={'contained'}\n                    type={'submit'}\n                    color={'primary'}\n                    disabled={isLoading}\n                    fullWidth>\n                    <Spacer />Login{isLoading ? <StyledCircularProgress color={\"inherit\"} size={20} /> : <Spacer />}\n                </Button>\n                <ReCAPTCHA\n                    ref={recaptchaRef}\n                    size={'invisible'}\n                    sitekey={recaptchaKey}\n                    theme={'dark'}\n                />\n            </InnerContainer>\n        </StyledForm>\n    </>;\n};\n","import {useCheckLoginQuery} from \"../auth/authApi\";\n\nconst SESSION_REFRESH_INTERVAL_MS = 60 * 60 * 1000;\n\nexport const RefreshSession = () => {\n    useCheckLoginQuery(undefined, {\n        pollingInterval: SESSION_REFRESH_INTERVAL_MS,\n        refetchOnReconnect: true,\n    })\n    return null\n}","import { Loader } from '@react-three/drei';\nimport React, { Suspense } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Hmail } from \"../modules/Hmail/Hmail\";\nimport { AppBar } from \"./app-bar/AppBar\";\nimport { selectLoginStatus } from \"./appSlice\";\nimport { Login } from \"./auth/Login\";\nimport { RefreshSession } from \"./refresh-session/RefreshSession\";\nimport { Starfield } from \"./starfield/Starfield\";\n\n/*Checks for login then displays appropriate component*/\nexport const App = () => {\n\n    const { loggedIn, isSuperUser } = useSelector(selectLoginStatus)\n\n    return loggedIn ?\n        <>\n            {isSuperUser && <Hmail />}\n            <RefreshSession />\n            <AppBar />\n        </> :\n        <>\n        <Suspense fallback={null}>\n            <Starfield />\n            <Login />\n        </Suspense>\n        <Loader/>\n        </>;\n};\n","import {isRejected, isRejectedWithValue} from \"@reduxjs/toolkit\";\nimport {setNetworkError} from \"../appSlice\";\n\n/*Show network errors for rejected thunk actions*/\nexport const networkErrorMiddleware = ({dispatch}) => next => action => {\n\n    if (isRejectedWithValue(action)) {\n        /*Payload has been formatted by baseQuery.\n        * Reducer will filter out 401/403s while not logged in*/\n        dispatch(setNetworkError(action.payload));\n\n    } else if (isRejected(action) && !action.meta.condition) {\n        /*Ignore thunks cancelled due to condition being true*/\n        console.warn(`Rejected thunk:`, action)\n    }\n\n    return next(action)\n}","import { isAnyOf, isFulfilled, isPending, isRejected, isRejectedWithValue } from \"@reduxjs/toolkit\"\nimport { addNetworkAction, removeNetworkAction } from \"../appSlice\"\n\n\nexport const networkLoadingMiddleware = ({dispatch}) => next => action => {\n\n    if (isPending(action)) {\n        dispatch(addNetworkAction(action.meta.requestId))\n\n    } else if (isAnyOf(isFulfilled, isRejected, isRejectedWithValue)(action)) {\n        dispatch(removeNetworkAction(action.meta.requestId))\n    }\n\n    return next(action)\n}","import { configureStore } from \"@reduxjs/toolkit\";\nimport { appSlice, appSliceName as appPath } from \"./appSlice\";\nimport { baseApi } from \"./network-core/baseApi\";\nimport { networkErrorMiddleware } from \"./network-error/networkErrorMiddleware\";\nimport { setupListeners } from \"@reduxjs/toolkit/query\";\nimport { notificationSlice, notificationsSliceName as notificationsPath } from \"./notifications/notificationSlice\";\nimport { listsSlice, listsPath } from \"../modules/Lists/listsSlice\";\nimport { networkLoadingMiddleware } from \"./network-loading/networkLoadingMiddleware\";\nimport { literaturePath, literatureSlice } from './../modules/Literature/literatureSlice';\n\nexport const store = configureStore({\n    reducer: {\n        [baseApi.reducerPath]: baseApi.reducer,\n        [appPath]: appSlice.reducer,\n        [notificationsPath]: notificationSlice.reducer,\n        [listsPath]: listsSlice.reducer,\n        [literaturePath]: literatureSlice.reducer,\n    },\n    middleware: getDefaultMiddleware =>\n        getDefaultMiddleware()\n            .concat(baseApi.middleware)\n            .concat(networkErrorMiddleware)\n            .concat(networkLoadingMiddleware)\n})\n\nsetupListeners(store.dispatch)","import {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    IconButton,\n    Snackbar\n} from \"@material-ui/core\";\nimport {Alert} from \"@material-ui/lab\";\nimport React, {useState} from \"react\";\nimport {styled as muiStyled} from \"@material-ui/core/styles\";\nimport CloseIcon from \"@material-ui/icons/Close\";\n\nconst StyledDialog = muiStyled(Dialog)(({theme}) => ({\n    /*As zIndex is set inline in Dialog, style must be overridden with !important*/\n    zIndex: `${theme.zIndex.snackbar + 1} !important`,\n}));\n\n/* Display snackbar with dialog.\n* Omit onClose to prevent user from dismissing alert\n* Omit dialogTitle & dialogText to disable dialog*/\nexport const AlertSnackbarWithDialog = ({\n                                            severity = 'error',\n                                            onClose,\n                                            snackbarText,\n                                            dialogTitle,\n                                            dialogContent,\n                                            actions\n                                        }) => {\n\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const dialogEnabled = Boolean(dialogTitle && dialogContent);\n\n    return <>\n        {dialogEnabled && <StyledDialog\n            open={dialogOpen}\n            onClose={() => setDialogOpen(false)}\n            scroll={'body'}>\n\n            <DialogTitle>{dialogTitle}</DialogTitle>\n\n            <DialogContent>\n                <DialogContentText component={'div'} style={{whiteSpace: 'pre-wrap'}}>\n                    {dialogContent}\n                </DialogContentText>\n            </DialogContent>\n\n\n            <DialogActions>\n                <Button\n                    variant={'text'}\n                    color={'primary'}\n                    onClick={() => setDialogOpen(false)}\n                >Close\n                </Button>\n            </DialogActions>\n\n        </StyledDialog>}\n        <Snackbar open>\n            <Alert\n                severity={severity}\n                action={<>\n                    {dialogEnabled && <Button\n                        variant={'text'}\n                        color={'primary'}\n                        onClick={() => setDialogOpen(true)}>\n                        Details\n                    </Button>}\n                    {actions}\n                    {onClose && <IconButton\n                        size=\"small\"\n                        color=\"inherit\"\n                        onClick={onClose}>\n                        <CloseIcon fontSize=\"small\"/>\n                    </IconButton>}\n                </>}>\n                {snackbarText}\n            </Alert>\n        </Snackbar>\n    </>\n        ;\n};","import {Button} from \"@material-ui/core\";\nimport React from \"react\";\nimport {AlertSnackbarWithDialog} from \"../../shared/components/AlertSnackbarWithDialog\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {clearNetworkError, selectNetworkError} from \"../appSlice\";\nimport {NETWORK_ERROR} from \"../constants\";\nimport {format, formatISO} from 'date-fns'\n\n/*Displays appropriate snackbars informing users of network state/errors,\n* with remediation options.\n*\n* Accepts both Responses and Errors.*/\nexport const NetworkError = () => {\n\n    const dispatch = useDispatch()\n    const networkError = useSelector(selectNetworkError)\n    if (!networkError) return null\n\n    const {method, url, text, status, type, timestamp} = networkError\n\n    const message = <>\n        <p>{formatISO(timestamp)} {method}: {url}</p>\n        <p>{text}</p>\n    </>\n\n    const formattedTimestamp = format(timestamp, 'HH:mm')\n\n    switch (type) {\n        case NETWORK_ERROR.FETCH_ERROR:\n            /*Fetch error. Allow user to close snackbar*/\n            return <AlertSnackbarWithDialog\n                dialogTitle={'Fetch Error'}\n                actions={<Button color={'primary'} onClick={() => window.location.reload()}>\n                    Reload\n                </Button>}\n                dialogContent={message}\n                severity={'error'}\n                snackbarText={`[${formattedTimestamp}] A network error has occurred.`}\n                onClose={() => dispatch(clearNetworkError())}/>\n\n        case NETWORK_ERROR.HTTP_ERROR:\n            if ([401, 403].includes(status)) {\n                /*Authentication errors. Don't allow user to close snackbar*/\n                return <AlertSnackbarWithDialog\n                    dialogTitle={'Authentication Error'}\n                    actions={<Button color={'primary'}\n                                     onClick={() => window.location.reload()}>\n                        Login </Button>}\n                    dialogContent={message}\n                    severity={'warning'}\n                    snackbarText={'You are logged out.'}/>;\n\n            } else {\n                /*Other HTTP errors (4xx/5xx). Allow user to close snackbar*/\n                return <AlertSnackbarWithDialog\n                    dialogTitle={`Error ${status}`}\n                    actions={<Button color={'primary'} onClick={() => window.location.reload()}>\n                        Reload\n                    </Button>}\n                    dialogContent={message}\n                    severity={'error'}\n                    snackbarText={`[${formattedTimestamp}] An HTTP error has occurred.`}\n                    onClose={() => dispatch(clearNetworkError())}/>;\n            }\n        default:\n            /*Catch non NetworkError rejectedWithValue thunks*/\n            return <AlertSnackbarWithDialog\n                dialogTitle={`Non NetworkError rejectWithValue thunk`}\n                dialogContent={message}\n                severity={'error'}\n                snackbarText={`[${formattedTimestamp}] A network error has occurred.`}\n                onClose={() => dispatch(clearNetworkError())}/>;\n    }\n};","import styled from \"styled-components\";\nimport {getDaysSinceEpoch, getRandomInt} from \"../util\";\nimport {useCallback, useEffect, useState} from \"react\";\n\n/*Largest index of background images, inclusive*/\nconst NUM_IMAGES = 90;\n\nconst RandomBackgroundImage = styled.div`\n  background: url(${({$picIndex}) => `/bg/${$picIndex}.jpg`}) top/cover;\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  z-index: -1;\n`;\n\n/*Get the latest pic index on window focus (setTimeout is unreliable*/\nconst getPicIndex = () => getRandomInt(1, NUM_IMAGES + 1, getDaysSinceEpoch());\n\nexport const RandomBackground = () => {\n\n    const [picIndex, setPicIndex] = useState(getPicIndex());\n    const listener = useCallback(() => setPicIndex(getPicIndex()), [])\n\n\n    useEffect(() => {\n        window.addEventListener('focus', listener)\n        return () => window.removeEventListener('focus', listener)\n    }, [listener]);\n\n    return <RandomBackgroundImage $picIndex={picIndex}/>\n};","import ReactDOM from 'react-dom';\nimport React, { StrictMode } from \"react\";\nimport '@fontsource/roboto/300.css'\nimport '@fontsource/roboto/400.css'\nimport '@fontsource/roboto/500.css'\nimport '@fontsource/roboto/700.css'\nimport '@fontsource/source-sans-pro' //For codemirror in MarkdownEditor.js\nimport './shared/static/fonts/starcraft/starcraft.css' //Stylized font for menu\nimport { MuiThemeProvider } from \"@material-ui/core\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { LoadServiceWorker } from \"./app/load-service-worker/LoadServiceWorker\";\nimport { ErrorBoundary } from \"./app/error-boundary/ErrorBoundary\";\nimport 'overlayscrollbars/css/OverlayScrollbars.css'\nimport { theme } from \"./app/theme\";\nimport { App } from \"./app/App\";\nimport { Provider } from 'react-redux'\nimport { store } from './app/store'\nimport { NetworkError } from \"./app/network-error/NetworkError\";\nimport { RandomBackground } from './shared/components/randomBackground';\n\n/*Decide whether to run mock service worker for debugging*/\nconst USE_MOCK_SERVICE_WORKER = true;\nconst prepare = () => {\n    if (process.env.NODE_ENV === 'development' && USE_MOCK_SERVICE_WORKER) {\n        const { worker } = require('./test/mocks/browser');\n        return worker.start()\n    }\n    return Promise.resolve()\n}\n\nprepare().then(() => {\n    ReactDOM.render(\n        <StrictMode>\n            <MuiThemeProvider theme={theme}>\n                <CssBaseline />\n                <RandomBackground />\n                <ErrorBoundary>\n                    <Provider store={store}>\n                        <LoadServiceWorker />\n                        <NetworkError />\n                        <App />\n                    </Provider>\n                </ErrorBoundary>\n            </MuiThemeProvider>\n        </StrictMode>\n        , document.getElementById('root'))\n});\n\n\n\n"],"sourceRoot":""}